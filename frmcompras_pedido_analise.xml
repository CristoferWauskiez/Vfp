<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Screen</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>880246518</timestamp>
		<class>dataenvironment</class>
		<classloc/>
		<baseclass>dataenvironment</baseclass>
		<objname>Dataenvironment</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4>2</reserved4>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>formpadrao</class>
		<classloc>..\classes\formularios.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>FRMCOMPRAS_PEDIDO_ANALISE</objname>
		<parent/>
		<properties>DataSession = 2
Height = 622
Width = 836
DoCreate = .T.
Caption = "Análise para pedido de compra"
WindowState = 2
HelpContextID = 1580
ForeColor = 192,192,192
BindControls = .F.
camposprod = .F.
oldsessionid = .F.
cretorno = .F.
lgerarpedido = .F.
nidloja = 0
cselcodigoinicial = .F.
cselcodigofinal = .F.
lofornecedor = .F.
ult_atualizacao = ''
cordenadopor = .F.
lvisualizarhistoricoscompravenda = .F.
lcrianovohistorico = .T.
config41007 = .F.
oestoque = .F.
omovimento = .F.
utilizapedidoduaslojas = .F.
Name = "FRMCOMPRAS_PEDIDO_ANALISE"
App.Name = "App"
Dbc.Name = "Dbc"
Resizable1.Top = -12
Resizable1.Left = 343
Resizable1.Name = "Resizable1"
imgCantoneira.Height = 10
imgCantoneira.Left = 770
imgCantoneira.Top = 310
imgCantoneira.Width = 10
imgCantoneira.ZOrderSet = 51
imgCantoneira.Name = "imgCantoneira"
imgToolInfo.Height = 16
imgToolInfo.Left = 360
imgToolInfo.Top = -13
imgToolInfo.Width = 16
imgToolInfo.ZOrderSet = 42
imgToolInfo.Name = "imgToolInfo"
</properties>
		<protected/>
		<methods>PROCEDURE abrircadastro
executarform('frmcadprodutos',.t.,curListaProd.id )
*thisform.pageFrame.page2.gridorder1.colEF.ColumnOrder = 2
ENDPROC
PROCEDURE Activate
*!*	If Empty(Thisform.Tag)
*!*	   Thisform.gridorder1.SetFocus
*!*	Endif
*!*	Thisform.Tag = ''
DoDefault()

ENDPROC
PROCEDURE alterarordemprodutos
Local lcArquivo, llRetorno, lnOldArea

lnOldArea = Select()

*-- Seleciona todos os IDs dos produtos da grid
Select ID From curListaProd Into Cursor curTmpOrdemProd

*-- Determina o nome do arquivo temporário de produtos
lcArquivo = Addbs(oSistema.HOME_TMP) + Alltrim(Sys(2015)) + "_Produtos.dbf"
Copy To (lcArquivo)

If Used('curTmpOrdemProd')
Use In curTmpOrdemProd
EndIf

llRetorno = ExecutarForm('frmAlterarOrdemEstocagem', 3, lcArquivo)

Select (lnOldArea)

If llRetorno And MessageBox('As ordens foram alteradas. Deseja atualizar a listagem dos produtos selecionados?', 4 + 32, 'Atualizar a listagem') = 6
ThisForm.PageFrame.Page1.CommandButton_1.Click()
EndIf


ENDPROC
PROCEDURE atualizarestoqueremoto

DIMENSION aUlt_atualizacao(2) as Boolean

Select Max(ult_atuali),Max(hr_atualiz) From est_remoto Where ult_atuali = (Select Max(ult_atuali) From est_remoto where cnpj =  thisform.loFornecedor.cnpj) and cnpj = thisform.loFornecedor.cnpj Into Array aUlt_atualizacao

lddtultatual = Iif(Vartype(aUlt_atualizacao(1))='L',{01/01/1900},aUlt_atualizacao(1))
lchrultatual = Iif(Vartype(aUlt_atualizacao(2))='L','00:00:01',aUlt_atualizacao(2))
thisform.ult_atualizacao = Alltrim(Dtoc(lddtultatual))+' '+Alltrim(lchrultatual)

thisform.pageFrame.page2.Textbox_3.Value = thisform.ult_atualizacao

oest_remoto = Createobject([ESTOQUE_REMOTO])
oest_remoto.cnpj =  thisform.loFornecedor.cnpj
oest_remoto.StrConexao = 'Driver={MySQL ODBC 5.1 Driver};server=dbmy0050.whservidor.com;Port=3306;Database=boreo_1;Uid=boreo_1;Pwd=redemac10;'
oest_remoto.dtultatual = Transform(Year(lddtultatual))+'-'+padl(Transform(Month(lddtultatual)),2,'0')+'-'+padl(Transform(Day(lddtultatual)),2,'0')
oest_remoto.hr_atual = lchrultatual

oest_remoto.Atualizar_est_remoto()







ENDPROC
PROCEDURE buscarprodutos
Lparameters tlPrimeiraBusca

Private All Like l*

*Set Step On

If Thisform.utilizapedidoduaslojas
	Thisform.buscarprodutos_duaslojas()
	Return
Endif

*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
	If !Empty(Thisform.PageFrame.page1.cboLojasMultiSelecao.Value)
		lcWhereLoja = ' (InList(p.id_loja, ' + Thisform.PageFrame.page1.cboLojasMultiSelecao.Value + ') or p.id_loja == 0) '
	Else
		lcWhereLoja = ' .T. '
	Endif
Else
	*!* Matheus #69964  05/08/19: Define a loja que irá pesquisar a promoção.
	If Thisform.PageFrame.page1.cbolojas1.Value &gt; 0
		lcWhereLoja = ' (p.id_loja = ' + Alltrim(Str(Thisform.PageFrame.page1.cbolojas1.Value)) + ' or p.id_loja == 0) '
	Else
		lcWhereLoja = ' .T. '
	Endif
Endif

oMsgForm = Createobject("frmstatusbarmsg",'Fazendo busca dos produtos, aguarde...')

If Used('curTmpAnalise')
	Use In curTmpAnalise
Endif

With Thisform.PageFrame.page1
	If Used('bkp_itens')
		Use In bkp_itens
	Endif


	*!* Se esta marcado para manter os itens atuais, faz uma copia do produtos
	*!* que ja foram incluidos no pedido
	If .chkManter.Value
		Select *  From curListaProd Where pedido &gt; 0 Into Cursor bkp_itens Readwrite
		If _Tally = 0
			Use In bkp_itens
		Endif
	Endif

	lcWhere = 'id &gt; 0 and '
	lcWhereEstoque = ''

	If tlPrimeiraBusca
		If Used('cur_itens')
			lcWhere = ' id in (select id_produto from cur_itens where id_produto &gt; 0) and '
		Else
			Return
		Endif
	Else
		lcExprGrupo = .cntseekgrupos1.gerarexpressao('id_grupo')
		If !Isblank(lcExprGrupo)
			lcWhere = lcWhere + lcExprGrupo+' and '
		Endif

		*!* Tiago   #11842  06/06/13: Adicionado filtro por marca.
		If Thisform.PageFrame.page1.cntseekmarcas1.getvalue() &gt; 0
			lcWhere = lcWhere + 'id in (select id_produto from produto_marcas where id_marca = ' + Transform(Thisform.PageFrame.page1.cntseekmarcas1.getvalue()) + ') and '
		Endif

		*!* Carlos	#43143	19/12/16: Adicionado filtro Deposito.
		If Thisform.PageFrame.page1.cntseekdeposito1.getvalue() &gt; 0
			lcWhere = lcWhere + 'id_deposito = ' + Transform(Thisform.PageFrame.page1.cntseekdeposito1.getvalue()) + ' and '
		Endif


		*!* Raul    #19426  02/04/14: Adicionado filtro por local de estocagem
		If .cntSeekLocais2.getvalue() &gt; 0
			lcWhere = lcWhere + "Id In (Select Id_Produto As Id From Est_Estoque Where Id_LocalEst = " + Transform(.cntSeekLocais2.getvalue()) + ") And "
			lcWhereEstoque = lcWhereEstoque + 'id_localest = '+sqlval(Thisform.PageFrame.page1.cntSeekLocais2.getvalue())+' AND '
		Endif


		If .chkVip.Value
			lcWhere = lcWhere + ' vip = 1 and '
		Endif

		If .chkRotatividade.Value
			lcWhere = lcWhere + ' rotatividade = 1 and '
		Endif

		If .chkForaLinha.Value
			lcWhere = lcWhere + ' substr(p.flags, 5, 1) != "1" And substr(p.flags, 6, 1) != "1" and '
		Endif

		*!* Carlos  #49591  08/09/17:       Adicionado filtro para não trazer produtos marcados como ponta de estoque
		If .chkPontaEstoque.Value
			lcWhere = lcWhere + ' p.peca_unica &lt;&gt; 1 and '
		Endif
		*!* Matheus #58787  14/06/18: Customização para, caso a Flag "Pesquisar fornecedores vinculados" estiver marcada, busca os fornecedores vinculados (Matriz e Filial).
		If .opgTodos.Value = 1 And .selfornec.getvalue() &gt; 0
			If .chkfiliais.Value
				If .selfornec.oRegistro.Id_pai &gt; 0
					lnIdForn = .selfornec.oRegistro.Id_pai
				Else
					lnIdForn = .selfornec.getvalue()
				Endif
				Select Id From fornecedores Where Id = lnIdForn Or Id_pai = lnIdForn Into Cursor tmpFornec
				lcIdsFornec = ''
				Scan
					lcIdsFornec = lcIdsFornec + Alltrim(Str(tmpFornec.Id))+','
				Endscan
				lcIdsFornec = cLeft(lcIdsFornec ,1)
				lcWhere = lcWhere + ' ( InList(Id_Forn1, ' + lcIdsFornec + ' ) or InList(Id_forn2, ' + lcIdsFornec + ' ) or InList(Id_forn3, ' + lcIdsFornec + ' ) ) and '
			Else
				lcForn = Alltrim(Str(.selfornec.getvalue()))
				lcWhere = lcWhere + '(id_forn1 = '+ lcForn +' or id_forn2 = '+lcForn+' or id_forn3 = '+lcForn+') and '
			Endif
		Endif
		*!* Caroline #55076  06/02/18: retirando o filtro fixo de produtos ativos
		*!* lcWhere = lcWhere + ' inativo &lt;&gt; .t. and '
		*!* Caroline #55076  06/02/18:    Filtro somente por produtos Ativos e\ou inativos
		*!* O tratamento para o caso de ambos desmarcados está em Commandbutton_1.click
		*!* Caso ambos estejam marcados, não se faz necessário filtro
		*Set Step On
		If .chkProdutosAtivos.Value And !.chkProdutosInativos.Value
			lcWhere = lcWhere +[ inativo = .F. And ]
		Endif

		If .chkProdutosInativos.Value And !.chkProdutosAtivos.Value
			lcWhere = lcWhere +[ inativo = .T. And ]
		Endif
		*!* FIM -- Caroline #55076

	Endif
	*Set Step On
	*!* Eber    #34712  22/08/16: Filtras Produtos [Sob Encomenda]
	If .ChkEncomenda.Value
		lcWhere = lcWhere +[ encomenda = 1 And ]
	Endif

	*!* Matheus #58415  04/06/18: Filtro de produtos [Apenas os que não são sob encomenda]
	If .ChkNaoTrazEncomenda.Value
		lcWhere = lcWhere + [ encomenda = 0 And ]
	Endif

	*!* Gabriel #80681  24/09/20: Movido o códiogo pra cá
	If Used('cur_itens')
		lcWhere = Left(lcWhere,Len(lcWhere)-4)
		lcWhere = [(]+lcWhere + ') or id in (select id_produto from cur_itens where id_produto &gt; 0) and '
	Endif

	If !Empty(lcWhere)
		lcWhere = Left(lcWhere,Len(lcWhere)-4)
	Endif
	lbBaseadoNaVendaMedia = .F.
	lcCampos = Thisform.CamposProd

	*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
	If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
		If !Empty(Thisform.PageFrame.page1.cboLojasMultiSelecao.Value) And Thisform.config41007 == 'Sim'
			lcWhereEstoque = lcWhereEstoque + 'Inlist(id_loja,' + Thisform.PageFrame.page1.cboLojasMultiSelecao.Value + ') AND '
		Endif
	Else
		If Thisform.PageFrame.page1.cbolojas1.Value &gt; 0 And Thisform.config41007 == 'Sim'
			lcWhereEstoque = lcWhereEstoque + 'id_loja = '+sqlval(Thisform.PageFrame.page1.cbolojas1.Value)+' AND '
		Endif
	Endif

	*!* Tiago   #24417  16/12/14: Abrindo tabela de estoque no banco de dados
	If Thisform.config41007 == 'Sim'
		If !Empty(lcWhereEstoque)
			lcWhereEstoque = cLeft(lcWhereEstoque,4)
			Thisform.oestoque.loadbyexpr((lcWhereEstoque))
		Else
			Thisform.oestoque.CursorFill()
		Endif
	Endif


	*!* Busca todos os produtos que atendam o filtro pesquisa
	*!* Raul    #19426  03/04/14: A primeira coluna passa a ser a ordem de estocagem
Set Step On
	If Thisform.cOrdenadoPor = "ORDEM_ESTOCAGEM"
		Select &amp;lcCampos. From Produtos Where &amp;lcWhere. Into Cursor tmp_produtos_lista Readwrite Order By Ordem_Estocagem
	Else
		Select &amp;lcCampos From Produtos p Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome
	Endif

	*!* Matheus #94384  29/03/22: Adicionado o nome do grupo do produto
	Select tmp_produtos_lista
	Replace All grupo_produto With Nvl(SeekReg([est_grupos],[id],tmp_produtos_lista.id_grupo,[Alltrim(codigo)+ ' - ' + descricao]),[                       ])



	*!* Gabriel #82923  31/03/21: Chama a função de carregar os emprestimos
	If Thisform.PageFrame.page1.ChkEmprestimos.Value
		Thisform.CarregarEmprestimos()
	Endif

	*!* Raul    #19798  17/07/14: Retira do cursor os produtos que possuem Id_Vinculo_Est maior que zero
	Select tmp_produtos_lista
	Go Top
	Delete All For Id_Vinculo_Est &gt; 0
	Go Top

	*!*	busca unidade de medida
	Scan


		lounidade= seekregobj('mac_unidades','id',tmp_produtos_lista.id_unidade)
		Replace unidMedi With lounidade.codigo

		*!* Cristof #69129  05/06/19: Adicionado o volume da unidade para calcular a litragem
		Replace Volume With Nvl(lounidade.Volume,0)

		*!* Matheus #69964  25/07/19: Cursor de promoções.
		Select Pi.id_produto, p.Id, p.inicio, p.fim From ven_promocoes_itens Pi;
			LEFT Join ven_promocoes p On p.Id = Pi.id_promocao;
			WHERE Between(Date(), p.inicio, p.fim) And Pi.id_produto = tmp_produtos_lista.Id And p.inativo = .F. And &amp;lcWhereLoja Into Cursor curTmpPromo

		*!* Matheus #69964  25/07/19: Adiciona o id da promo do produto no cursor.
		Select curTmpPromo
		If !Eof()
			Replace tmp_produtos_lista.promo With curTmpPromo.Id
		Endif

		*!* Gabriel #82923  31/03/21: trata para preencher o valor de empréstimo no campo correto.
		If Thisform.PageFrame.page1.ChkEmprestimos.Value
			Select curEmprestimos
			Locate For id_produto = tmp_produtos_lista.Id
			If Found()
				Select tmp_produtos_lista
				Replace saldo_emprestimo With curEmprestimos.saldo
			Endif
		Endif

	Endscan
	If Used('curTmpPromo')
		Use In curTmpPromo
	Endif
	*!* 29/05/2009 19:59:04   TERTEROLA # Juliano
	*!* Chama metodo que ira preencher os campos de est_venda, est_pedido, etc. buscando da EST_ESTOQUE.
	This.CarregarEstoques()
	This.buscarqtdestoquesremotos()

	*!* Raul    #23717  20/10/14: Incluído o filtro para CV (cancelamento de vendas)
	If Thisform.PageFrame.page1.chktransf.Value
		lcTipoMovSaidas   = 'PV-VE-CV-TR-TC'
		lcTipoMovEntradas = 'NF-CV-DV-TR'
	Else
		lcTipoMovSaidas   = 'PV-VE-CV-TC'
		lcTipoMovEntradas = 'NF-CV-DV'
	Endif

	Do Case
	Case .opganalise.Value = 4
		*!* SEM ANALISES

	Case .opganalise.Value = 1 &amp;&amp; ESTOQUE MINIMO
		Select tmp_produtos_lista
		*!* Lucas   #19032  25/04/14: Ajustado para não fazer replace &gt; 0 no pedido quando o produto estar fora de linha da loja ou fornecedor.
		Scan
			*!* Charles #65380  31/01/19: Alterado para zerar o campo de Pedido somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.
			*!* Charles #66365  26/04/19: Alterado para zerar o campos de Pedido somente se os flags "Fora de linha (Fornec)" ou "Fora de linha (Loja)" estiverem marcado no cadastro de produto.
			If Substr(tmp_produtos_lista.Flags, 6, 1)='1' Or Substr(tmp_produtos_lista.Flags, 5, 1) = '1'
				Replace pedido With 0
			Else
				*!* Cristof #93139  19/01/22: Adicionado o campo "est_reservado" para calcular o quanto tem de estoque diponivel (est_venda - est_vendido - est_reservado)
				Replace pedido With Iif(est_minimo &gt; est_venda + est_pedido - est_vendido - est_reservado , est_minimo - ((est_venda - est_vendido - est_reservado)+ est_pedido) ,00000.000)
			Endif
		Endscan

	Case .opganalise.Value = 2 &amp;&amp; VENDA MEDIA
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)
		lnMeses  = Iif(lnMeses&lt;=0,1,lnMeses)
		lnIndice = .spnIndice.Value

		lcAuxWhere = .cntVendaMedia.gerarexpressao('m.data')
		*!* Eber    #44801  16/02/17: Os campos utilizado no filtro [lcAuxWhereSQL] não devem receber Alias(m.) porque essa variável é utilizada na função LoadByExpr, que não admite alias.
		*!* Ocasioando erro ao carregar os dados do Est_movimento do POST. O erro fecha o cursorAdapter do POST e a consulta posterior reabre o EST_MOVIEMNTO DBF, invalidando a consulta
		*!* Para quem usa estoque no post CFG 41007 = Sim
		*!* Gerar expressão de filtro de datas no formato SQL do POST
		lcAuxWhereSQL = .cntVendaMedia.gerarexpressao('data', [SQL])


		If Empty(lcAuxWhere) Or Empty(lcAuxWhereSQL)
			lcAuxWhere = "between(m.data,"+vfpval(primeirodiadomes(Gomonth(Date(),-12)))+','+vfpval(primeirodiadomes(Date())-1)+')'
			lcAuxWhereSQL = "TRUE"
		Endif

		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and m.id_loja = '+vfpval(Thisform.nidloja)
				*!* Eber    #44081  13/02/17: Variável correta para o POST é lcAuxWhereSQL
				*lcAuxWhereSQL = lcAuxWhere + ' and m.id_loja = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja = '+vfpval(Thisform.nidloja)
			Else
				lcAuxWhere = lcAuxWhere + ' and m.id_loja_s = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja_s = '+vfpval(Thisform.nidloja)
			Endif
		Endif

		*!* 21/02/13 - Juliano: Adicionado teste do campo TIPO_NULO = 0. Se for 1 indica que o movimento nao deve ser considerado como venda
		*!*	         Select id_produto, ;
		*!*	            Sum(Iif(tipo $ lcTipoMovSaidas And tipo_nulo=0,qtd,Iif(tipo$lcTipoMovEntradas And Tipo_ES = 'E',-qtd,0000000.00))) As qtd_vendida, ;
		*!*	            0000000000.00 As qtd_media ;
		*!*	            From est_movimento ;
		*!*	            into Cursor curTmpAnalise Readwrite ;
		*!*	            Group By id_produto ;
		*!*	            Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

		*!* Raul    #23717  24/10/14: Até a versão 20 existem transferências processadas como NF

		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr(lcAuxWhereSQL)
		Endif
		Select *;
			FROM est_movimento As m;
			WHERE &amp;lcAuxWhere. And id_produto In (Select Id From tmp_produtos_lista Group By Id);
			ORDER By id_produto, Data;
			INTO Cursor curTmpEst_Movimentos;
			READWRITE

		Update curTmpEst_Movimentos Set Tipo = "TR";
			WHERE Id_Venda In (Select Id From Vendas Where Id = curTmpEst_Movimentos.Id_Venda And NaturezaOper = "TRANSF")

		*!* Raul    #31138  11/08/15: Corrigido o select para apurar os cancelamentos e transferências
		If Thisform.PageFrame.page1.chktransf.Value
			lcTipoMovSaidas   = 'PV-VE-CV-TC-TR-CN'
			lcTipoMovEntradas = 'NF-CV-DV-TR'
			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0,-m.Qtd,Iif(m.Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, 0000000000.00 As qtd_media, m.id_loja;
				FROM est_movimento As m;
				WHERE &amp;lcAuxWhere.;
				GROUP By m.id_produto;
				INTO Cursor curTmpAnalise Readwrite

		Else
			lcTipoMovSaidas   = 'PV-VE-CV-TC'
			lcTipoMovEntradas = 'NF-CV-DV'
			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0 And (Isnull(v.Cfop) Or (! '5.152' $ v.Cfop And ! '5.409' $ v.Cfop)),-m.Qtd,;
				IIF(Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, 0000000000.00 As qtd_media, m.id_loja;
				FROM est_movimento As m;
				LEFT Join Vendas As v On v.Id = m.Id_Venda;
				WHERE &amp;lcAuxWhere.;
				GROUP By m.id_produto;
				INTO Cursor curTmpAnalise Readwrite

		Endif

		*!*	         Select id_produto, ;
		*!*	            Sum(Iif(Tipo_ES = 'S' And Tipo_Nulo = 0 And Tipo $ lcTipoMovSaidas, Qtd, Iif(Tipo_ES = 'E' And Tipo $ lcTipoMovEntradas, -Qtd, 0000000.00))) As Qtd_Vendida,;
		*!*	            0000000000.00 As qtd_media;
		*!*	            From curTmpEst_Movimentos;
		*!*	            Where ! Id_Venda In (Select Id From Vendas Where Id = curTmpEst_Movimentos.Id_Venda And NaturezaOper = "TRANSF");
		*!*	            Into Cursor curTmpAnalise Readwrite;
		*!*	            Group By id_produto

		*!*				*!* Raul    #31354  07/08/15: Para o cálculo passa a abater o estoque vendido (EF)
		*!*				Replace pedido With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_venda - est_vendido + tmp_produtos_lista.est_pedido), ;
		*!*					Ceiling(curTmpAnalise.qtd_media -(tmp_produtos_lista.est_venda - est_vendido + tmp_produtos_lista.est_pedido)),0), ;
		*!*					venda_media With curTmpAnalise.qtd_media ;
		*!*					For !Empty(curTmpAnalise.id_produto)
		Replace qtd_media With (curTmpAnalise.Qtd_Vendida / lnMeses) * lnIndice All
		Index On id_produto Tag id_produto

		Select tmp_produtos_lista
		Set Relation To Id Into curTmpAnalise

		*!* Raul    #31354  07/08/15: Para o cálculo passa a abater o estoque vendido (EF)
		*!* Cristof #93139  19/01/22: Adicionado o campo "est_reservado" para calcular o quanto tem de estoque diponivel (est_venda - est_vendido - est_reservado)
		Replace pedido With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_venda - est_vendido - est_reservado + tmp_produtos_lista.est_pedido), ;
			CEILING(curTmpAnalise.qtd_media -(tmp_produtos_lista.est_venda - est_vendido - est_reservado + tmp_produtos_lista.est_pedido)),0), ;
			venda_media With curTmpAnalise.qtd_media ;
			FOR !Empty(curTmpAnalise.id_produto)

	Case .opganalise.Value = 3 &amp;&amp; VENDA NO PERIODO
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)
		lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
		lnIndice = .spnIndice.Value

		lcAuxWhere = .cntVendaMedia.gerarexpressao('data')
		lcAuxWhereSQL = .cntVendaMedia.gerarexpressao('data', [SQL])
		If Empty(lcAuxWhere) Or Empty(lcAuxWhereSQL)
			lcAuxWhere = ".T."
			lcAuxWhereSQL = "TRUE"
		Endif
		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and id_loja = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja = '+vfpval(Thisform.nidloja)
			Else
				lcAuxWhere = lcAuxWhere + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja_s = '+vfpval(Thisform.nidloja)
			Endif
		Endif

		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr((lcAuxWhereSQL))
		Endif

		*!* Lucas   #26442  27/02/15: Substituido Sum(Iif(Tipo $ lcTipoMovSaidas,Qtd,Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,0000000.00))) por;
		Sum(Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,Iif(Tipo $ lcTipoMovSaidas,Qtd,0000000.00))).
		*!*	         Select id_produto, ;
		*!*	            Sum(Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E ', -Qtd ,Iif(Tipo $ lcTipoMovSaidas,Qtd,0000000.00))) As Qtd_Vendida ;
		*!*	            From est_movimento ;
		*!*	            Into Cursor curTmpAnalise ;
		*!*	            Group By id_produto ;
		*!*	            Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

		*!* Raul    #31138  11/08/15: Corrigido o select para apurar os cancelamentos e transferências
		lcAuxWhere = Strtran(lcAuxWhere,'data','m.data')
		lcAuxWhere = Strtran(lcAuxWhere,'id_loja','m.id_loja')
		*lcAuxWhereSQL = Strtran(lcAuxWhereSQL,'data','m.data')
		*lcAuxWhereSQL = Strtran(lcAuxWhereSQL,'id_loja','m.id_loja')


		If Thisform.PageFrame.page1.chktransf.Value
			lcTipoMovSaidas   = 'PV-VE-CV-TR-TC'
			lcTipoMovEntradas = 'NF-CV-DV-TR'
			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0, -m.Qtd, ;
				IIF(m.Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, 0000000000.00 As qtd_media, m.id_loja;
				FROM est_movimento As m;
				INTO Cursor curTmpAnalise ;
				WHERE &amp;lcAuxWhere. And id_produto In (Select Id From tmp_produtos_lista) ;
				GROUP By m.id_produto;
				READWRITE

		Else
			lcTipoMovSaidas   = 'PV-VE-CV-TC'
			lcTipoMovEntradas = 'NF-CV-DV'
			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0 And (Isnull(v.Cfop) Or (! '5.152' $ v.Cfop And ! '5.409' $ v.Cfop)),-m.Qtd,;
				IIF(Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, 0000000000.00 As qtd_media, m.id_loja;
				FROM est_movimento As m;
				LEFT Join Vendas As v On v.Id = m.Id_Venda;
				INTO Cursor curTmpAnalise ;
				WHERE &amp;lcAuxWhere. And id_produto In (Select Id From tmp_produtos_lista) ;
				GROUP By m.id_produto;
				READWRITE

		Endif

		Index On id_produto Tag id_produto
		Select tmp_produtos_lista
		Set Relation To Id Into curTmpAnalise
		*!* Charles #66365  24/04/19: Alterado para recalcular a coluna pedido subtraindo a coluna a receber (est_pedido)
		*Replace pedido With (curTmpAnalise.Qtd_Vendida*lnIndice ) For !Empty(curTmpAnalise.id_produto) And curTmpAnalise.Qtd_Vendida &gt; 0
		Replace pedido With ((curTmpAnalise.Qtd_Vendida - est_pedido) * lnIndice) For !Empty(curTmpAnalise.id_produto) And curTmpAnalise.Qtd_Vendida &gt; 0

		*!* Matheus #72517  22/01/20: Nova base de cálculo via ESTOQUE IDEAL.
	Case .opganalise.Value = 5 &amp;&amp; ESTOQUE IDEAL
		Select tmp_produtos_lista
		Scan
			Select tmp_produtos_lista
			If Substr(tmp_produtos_lista.Flags, 6, 1)='1' Or Substr(tmp_produtos_lista.Flags, 5, 1) = '1'
				Replace pedido With 0
			Else
				*!* Cristof #93139  19/01/22: Adicionado o campo "est_reservado" para calcular o quanto tem de estoque diponivel (est_venda - est_vendido - est_reservado)
				Replace pedido With Iif(Est_Ideal &gt; est_venda + est_pedido - est_vendido - est_reservado, Est_Ideal - ((est_venda - est_vendido - est_reservado)+ est_pedido) ,00000.000)
			Endif
		Endscan
	Endcase
	Replace tmp_produtos_lista.totalPedido With tmp_produtos_lista.pedido + tmp_produtos_lista.pedido2 + tmp_produtos_lista.pedido3
	If .chkAnalMedia.Value And .opganalise.Value &lt;&gt; 2
		*MensagemDebug([Vai calcular venda media...])
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)
		lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
		lcAuxWhere = .cntVendaMedia.gerarexpressao('m.data')
		lcAuxWhereSQL = .cntVendaMedia.gerarexpressao('data', [SQL])

		*lcAuxWhereSQL = .cntVendaMedia.gerarexpressao('m.data')


		If Empty(lcAuxWhere) Or Empty(lcAuxWhereSQL)
			*!* Mschoen #51766  06/11/17: Correção do intervalo de datas, para ser 11 meses para trás com relação ao 'hoje'
			*!*	 Quando não há datas informadas, deve pegar o primeiro dia do 11º mês anterior e comparar com o 'hoje'
			*!*	 lnMeses deve ser setado para 12, ou a média nõa se altera, pois ele é obtido acima e setado para 1 se não há datas
			*!*		 &gt;&gt;&gt; lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
			*!*	 Código abaixo comentado para se adequar a esta regra
			*!* lcAuxWhere = "between(m.data,"+vfpval(primeirodiadomes(Gomonth(Date(),-12)))+','+vfpval(primeirodiadomes(Date())-1)+')'
			lcAuxWhere = ' Between( m.data, ' + vfpval(primeirodiadomes(Gomonth(Date(),-11))) + ', '+ vfpval(Date()) +')'
			*!* Charles #66365  24/04/19: Alteração para usar a quantidade fracionada de meses quando não for informado um período.
			lnMeses  = RetornaQuantidadeFracionadaMeses(primeirodiadomes(Gomonth(Date(),-11)), Date())
			lnMeses  = Iif(lnMeses&lt;=0,1,lnMeses)
			lcAuxWhereSQL = ExprData( [data], primeirodiadomes( Gomonth( Date(),-11 ) ), Date(), [SQL] )
		Endif

		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and m.id_loja = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja = '+vfpval(Thisform.nidloja)
			Else
				lcAuxWhere = lcAuxWhere + ' and m.id_loja_s = '+vfpval(Thisform.nidloja)
				lcAuxWhereSQL = lcAuxWhereSQL + ' and id_loja_s = '+vfpval(Thisform.nidloja)
			Endif
		Endif

		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr((lcAuxWhereSQL))
		Endif

		*!*			Select id_produto, ;
		*!*				Sum(Iif(Tipo $ lcTipoMovSaidas And Tipo_Nulo=0,Qtd,Iif(Tipo$lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,0000000.00))) As Qtd_Vendida, ;
		*!*				0000000000.00 As qtd_media ;
		*!*				From est_movimento ;
		*!*				into Cursor curTmpAnalise Readwrite ;
		*!*				Group By id_produto ;
		*!*				Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

		*!*	      Select id_produto, ;
		*!*	         Sum(Iif(Tipo $ lcTipoMovSaidas And Tipo_Nulo=0,Qtd,Iif(Tipo$lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,0000000.00))) As Qtd_Vendida, ;
		*!*	         0000000000.00 As qtd_media ;
		*!*	         From est_movimento ;
		*!*	         into Cursor curTmpAnalise Readwrite ;
		*!*	         Group By id_produto ;
		*!*	         Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

		*!* Raul    #31138  11/08/15: Corrigido o select para apurar os cancelamentos e transferências
		If Thisform.PageFrame.page1.chktransf.Value
			lcTipoMovSaidas   = 'PV-VE-CV-TR-TC'
			lcTipoMovEntradas = 'NF-CV-DV-TR'
			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0,-m.Qtd,Iif(m.Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, 0000000000.00 As qtd_media, m.id_loja;
				FROM est_movimento As m;
				WHERE &amp;lcAuxWhere.;
				GROUP By m.id_produto;
				INTO Cursor curTmpAnalise Readwrite

		Else
			lcTipoMovSaidas   = 'PV-VE-CV-TC'
			lcTipoMovEntradas = 'NF-CV-DV'


			Select Sum(Iif(m.Tipo $ lcTipoMovEntradas And m.Tipo_ES = 'E' And m.id_Fornec = 0 And (Isnull(v.Cfop) Or (! '5.152' $ v.Cfop And ! '5.409' $ v.Cfop)), -m.Qtd,;
				IIF(Tipo $ lcTipoMovSaidas And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As Qtd_Vendida,;
				m.*, ;
				0000000000.00 As qtd_media, ;
				m.id_loja;
				FROM est_movimento As m;
				LEFT Join Vendas As v On v.Id = m.Id_Venda;
				WHERE &amp;lcAuxWhere.;
				GROUP By m.id_produto;
				INTO Cursor curTmpAnalise Readwrite
		Endif
		Replace qtd_media With curTmpAnalise.Qtd_Vendida / lnMeses All
		Index On id_produto Tag id_produto

		Select tmp_produtos_lista
		Set Relation To Id Into curTmpAnalise
		Replace venda_media With curTmpAnalise.qtd_media ;
			FOR !Empty(curTmpAnalise.id_produto)

	Endif

	Select curListaProd
	Set Filter To
	Delete All
	Append From Dbf('tmp_produtos_lista')
	Use In tmp_produtos_lista

	If .txtQtdmin.Value &gt; 0
		Replace pedido With 0 For pedido &lt; .txtQtdmin.Value
	Endif

	If Used('cur_itens')
		Select cur_itens
		Scan For id_produto &gt; 0
			Select curListaProd
			Locate For Id = cur_itens.id_produto
			If Found()
				Replace curListaProd.pedido With cur_itens.qtd_pedido, ;
					id_itempedido With cur_itens.Id
			Endif
		Endscan
	Endif

	*!* Charles #66365  18/04/19: Abater quantidade "A Transferir" do campo "Pedido"
	If Thisform.PageFrame.page1.chkAbaterTrasnfReceb.Value
		Select curListaProd
		Replace pedido With pedido - est_transferir All
	Endif

	If .chkEmbalagem.Value
		Select curListaProd
		Replace pedido With Ceiling(pedido / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
	Endif

	If Used('bkp_itens')
		Select bkp_itens
		Scan
			Scatter Memo Name oregbkp
			Select curListaProd
			Locate For Id = bkp_itens.Id
			If !Found()
				Append Blank
			Endif
			Gather Name oregbkp Memo
		Endscan
		Select curListaProd
		*     Zap
		*      Insert Into curListaProd Select * From bkp_itens Order By Nome
		Use In bkp_itens

		*!*	      Select curListaProd
		*!*	      Scan
		*!*	         Select bkp_itens
		*!*	         Locate For Id = curListaProd.Id
		*!*	         If !Found()
		*!*	            lnAuxId = curListaProd.Id
		*!*	            Insert Into bkp_itens Select * From curListaProd Where Id = lnAuxId
		*!*	         Endif
		*!*	      Endscan
		*!*	      Select curListaProd
		*!*	 *     Zap
		*!*	*      Insert Into curListaProd Select * From bkp_itens Order By Nome
		*!*	      Use In bkp_itens
	Endif
	*!*	   If .spnindice.Value &gt; 0
	*!*	      Select curListaProd
	*!*	      Replace pedido With pedido * .spnindice.Value All
	*!*	   Endif

	*!* Eber    #34712  22/08/16: Não deve gerar sugestão na coluna PEDIDO quando o produto da análise estiver marcado como FORA DE LINHA (na loja ou no fornecedor).
	*!* Charles #65380  31/01/19: Alterado para zerar o campo de Pedido somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.
	Select curListaProd
	*Replace pedido With 0 For Substr(Flags, 6, 1) = [1]
	*!* Charles #66365  26/04/19: Novamente não deve gerar sugestão na coluna PEDIDO quando o produto da análise estiver marcado como FORA DE LINHA (na loja ou no fornecedor).
	Replace pedido With 0 For Substr(Flags, 5, 1) = [1] Or Substr(Flags, 6, 1) = [1]
Endwith


*!*	atualiza quantidades de produtos do kit

Select cod_distri,pedido,qtd_embalagem From curListaProd Where pedido &gt; 0 And !Empty(cod_distri) Into Cursor curQntDistri Readwrite

Select curQntDistri
Scan
	If qtd_embalagem &gt; 0
		lnqntdDistri = (pedido / qtd_embalagem)
	Else
		lnqntdDistri = pedido
	Endif
	Select curListaProd
	Scan For cod_distri = curQntDistri.cod_distri
		If qtd_embalagem &gt; 0
			Replace pedido With (lnqntdDistri * qtd_embalagem)
		Else
			Replace pedido With lnqntdDistri
		Endif

	Endscan
Endscan

*!* Charles #66365  03/05/19: Zera a coluna pedido quando for &lt; 0
Select curListaProd
Replace pedido With 0 For pedido &lt; 0
Replace All totalPedido With pedido + pedido2 + pedido3
Select curListaProd
Go Top

*!*   .pageframe_1.Page1.gridorder1.Refresh
*!*   .pageframe_1.Page1.gridorder1.AfterRowColChange
Release oMsgForm
If Eof('curListaProd') And !tlPrimeiraBusca
	Messagebox("Nenhum produto encontrado.",64,"Informação")
Endif


Dimension vetSomas(3)
vetSomas(1) = 0
vetSomas(2) = 0
vetSomas(3) = 0
Select ;
	SUM(est_venda * preco_compra), ;
	SUM(est_venda * preco_venda), ;
	SUM(est_minimo * preco_custo) ;
	FROM curListaProd ;
	INTO Array vetSomas

With Thisform.PageFrame.page2
	.txtEstCompra.Value = vetSomas(1)
	.txtEstVenda.Value = vetSomas(2)
	.txtEstminCusto.Value = vetSomas(3)
Endwith

*!* Tiago   #00000  16/08/13: Comentado porque no final não era isso que era pra ser exibido e então comentei pq um dia poder ser usado.
*!*	Select curListaProd
*!*	brow
*!*	Scan
*!*		Select fornecedores
*!*		Locate For Id = curListaProd.id_forn1
*!*		If Found()
*!*			Select curListaProd
*!*			Replace fornecedor With Alltrim(fornecedores.razsoc)
*!*		Endif
*!*	Endscan

Thisform.Calcularfretes()

*!* Raul    #19426  03/04/14: Seta flag para a criação de novo histórico de compra e venda dos produtos
*!*                           Seta flag para visualização dos dados complementares dos produtos
*!*                           Mostra os dados complementares dos produtos
Thisform.lCriaNovoHistorico = .T.
Thisform.lVisualizarHistoricosCompraVenda = .F.
Thisform.DiplayDadosComplementares_HistoricCompraVenda()
Thisform.calcularqtdvendasultimos4meses() &amp;&amp; Carlos #32205 31/10/2016: VISUALIZAR VENDA POR MÊS NA ANÁLISE DE COMPRAS

Select curListaProd
Go Top

*!*	oDb = Createobject([db_fornecedores])
*!*	oDb.AtualizarCampo(Thisform.selFornec.getvalue(),'dt_ult_analise',oSistema.hoje)
*!*	Release oDb



*!*	Lparameters tlPrimeiraBusca
*!*	Private All Like l*
*!*	oMsgForm = Createobject("frmstatusbarmsg",'Fazendo busca dos produtos, aguarde...')

*!*	If Used('curTmpAnalise')
*!*	   Use In curTmpAnalise
*!*	Endif

*!*	With Thisform.PageFrame.pAGE1
*!*	   If Used('bkp_itens')
*!*	      Use In bkp_itens
*!*	   Endif

*!*	   *!* Se esta marcado para manter os itens atuais, faz uma copia do produtos
*!*	   *!* que ja foram incluidos no pedido
*!*	   If .chkManter.Value
*!*	      Select *  From curListaProd Where pedido &gt; 0 Into Cursor bkp_itens Readwrite
*!*	      If _Tally = 0
*!*	         Use In bkp_itens
*!*	      Endif
*!*	   Endif

*!*	   lcWhere = 'id &gt; 0 and '
*!*	   If tlPrimeiraBusca
*!*	      If Used('cur_itens')
*!*	         lcWhere = ' id in (select id_produto from cur_itens where id_produto &gt; 0) and '
*!*	      Else
*!*	         Return
*!*	      Endif
*!*	   Else
*!*	      lcExprGrupo = .cntseekgrupos1.gerarexpressao('id_grupo')
*!*	      If !Isblank(lcExprGrupo)
*!*	         lcWhere = lcWhere + lcExprGrupo+' and '
*!*	      Endif

*!*	      If .chkVip.Value
*!*	         lcWhere = lcWhere + ' vip = 1 and '
*!*	      Endif

*!*	      If .opgTodos.Value = 1 And .selFornec.getvalue() &gt; 0
*!*	         lcForn = Alltrim(Str(.selFornec.getvalue()))
*!*	         lcWhere = lcWhere + '(id_forn1 = '+lcForn+' or id_forn2 = '+lcForn+' or id_forn3 = '+lcForn+') and '
*!*	      Endif
*!*	      lcWhere = lcWhere + ' inativo &lt;&gt; .t. and '
*!*	      If Used('cur_itens')
*!*	         lcWhere = Left(lcWhere,Len(lcWhere)-4)
*!*	         lcWhere = [(]+lcWhere + ') or id in (select id_produto from cur_itens where id_produto &gt; 0) and '
*!*	      Endif
*!*	   Endif
*!*	   If !Empty(lcWhere)
*!*	      lcWhere = Left(lcWhere,Len(lcWhere)-4)
*!*	   Endif
*!*	   lbBaseadoNaVendaMedia = .F.
*!*	   lcCampos = Thisform.CamposProd

*!*	   Do Case
*!*	      Case .opganalise.Value = 4 &amp;&amp; SEM ANALISES
*!*	         Select &amp;lcCampos From produtos p Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome

*!*	      Case .opganalise.Value = 1 &amp;&amp; ESTOQUE MINIMO
*!*	         lcCampos = Strtran(Lower(lcCampos),'0000000.00 as pedido','iif(p.est_minimo &gt; p.est_venda + p.est_pedido,p.est_minimo-p.est_venda - p.est_pedido,00000.000) as pedido')
*!*	         Select &amp;lcCampos From produtos p Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome

*!*	      Case .opganalise.Value = 2 &amp;&amp; VENDA MEDIA
*!*	         lnMeses = .cntVendaMedia.diferenca('MESES')
*!*	         lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
*!*	         lnIndice = .spnIndice.Value
*!*	         Select &amp;lcCampos From produtos p ;
*!*	            Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome
*!*	         lcAuxWhere = .cntVendaMedia.gerarexpressao('data')

*!*	         Select id_produto, ;
*!*	            Sum(Iif(Inlist(tipo,'VE','PV'),qtd,;
*!*	            Iif(Inlist(tipo,'NE','CV','DV'),-qtd,0000000.00))) As qtd_vendida, ;
*!*	            0000000000.00 As qtd_media ;
*!*	            From est_movimento ;
*!*	            into Cursor curTmpAnalise Readwrite ;
*!*	            Group By id_produto ;
*!*	            Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

*!*	         Replace qtd_media With (qtd_vendida / lnMeses) * lnIndice  All
*!*	         Index On id_produto Tag id_produto

*!*	         Select tmp_produtos_lista
*!*	         Set Relation To Id Into curTmpAnalise
*!*	         Replace pedido With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido), ;
*!*	            Ceiling(curTmpAnalise.qtd_media -(tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido)),0), ;
*!*	            venda_media With curTmpAnalise.qtd_media ;
*!*	            For !Empty(curTmpAnalise.id_produto)

*!*	      Case .opganalise.Value = 3 &amp;&amp; VENDA NO PERIODO
*!*	         lnMeses = .cntVendaMedia.diferenca('MESES')
*!*	         lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
*!*	         lnIndice = .spnIndice.Value

*!*	         Select &amp;lcCampos From produtos p Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome
*!*	         lcAuxWhere = .cntVendaMedia.gerarexpressao('data')
*!*	         Select id_produto, ;
*!*	            Sum(Iif(Inlist(tipo,'VE','PV'),qtd,Iif(Inlist(tipo,'NE','CV','DV'),-qtd,0000000.00))) As qtd_vendida ;
*!*	            From est_movimento ;
*!*	            into Cursor curTmpAnalise ;
*!*	            Group By id_produto ;
*!*	            Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

*!*	         Index On id_produto Tag id_produto

*!*	         Select tmp_produtos_lista
*!*	         Set Relation To Id Into curTmpAnalise
*!*	         Replace pedido With (curTmpAnalise.qtd_vendida*lnIndice ) For !Empty(curTmpAnalise.id_produto)

*!*	   Endcase
*!*	   If .chkAnalMedia.Value And .opganalise.Value &lt;&gt; 2
*!*	      lnMeses = .cntVendaMedia.diferenca('MESES')
*!*	      lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
*!*	      lcAuxWhere = .cntVendaMedia.gerarexpressao('data')
*!*	      Select id_produto, ;
*!*	         Sum(Iif(Inlist(tipo,'VE','PV'),qtd,Iif(Inlist(tipo,'NE','CV','DV'),-qtd,0000000.00))) As qtd_vendida, ;
*!*	         0000000000.00 As qtd_media ;
*!*	         From est_movimento ;
*!*	         into Cursor curTmpAnalise Readwrite ;
*!*	         Group By id_produto ;
*!*	         Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id)

*!*	      Replace qtd_media With qtd_vendida / lnMeses All
*!*	      Index On id_produto Tag id_produto

*!*	      Select tmp_produtos_lista
*!*	      Set Relation To Id Into curTmpAnalise
*!*	      Replace venda_media With curTmpAnalise.qtd_media ;
*!*	         For !Empty(curTmpAnalise.id_produto)

*!*	   Endif

*!*	   Select curListaProd
*!*	   Set Filter To
*!*	   Delete All
*!*	   Append From Dbf('tmp_produtos_lista')
*!*	   Use In tmp_produtos_lista

*!*	   If .txtQtdmin.Value &gt; 0
*!*	      Replace pedido With 0 For pedido &lt; .txtQtdmin.Value
*!*	   Endif

*!*	   If Used('cur_itens')
*!*	      Select cur_itens
*!*	      Scan For id_produto &gt; 0
*!*	         Select curListaProd
*!*	         Locate For Id = cur_itens.id_produto
*!*	         If Found()
*!*	            Replace curListaProd.pedido With cur_itens.qtd_pedido, ;
*!*	               id_itempedido With cur_itens.Id
*!*	         Endif
*!*	      Endscan
*!*	   Endif

*!*	   If Used('bkp_itens')
*!*	      Select curListaProd
*!*	      Scan
*!*	         Select bkp_itens
*!*	         Locate For Id = curListaProd.Id
*!*	         If !Found()
*!*	            lnAuxId = curListaProd.Id
*!*	            Insert Into bkp_itens Select * From curListaProd Where Id = lnAuxId
*!*	         Endif
*!*	      Endscan
*!*	      Select curListaProd
*!*	      Zap
*!*	      Insert Into curListaProd Select * From bkp_itens Order By Nome
*!*	      Use In bkp_itens
*!*	   Endif
*!*	   *!*	   If .spnindice.Value &gt; 0
*!*	   *!*	      Select curListaProd
*!*	   *!*	      Replace pedido With pedido * .spnindice.Value All
*!*	   *!*	   Endif
*!*	   If .chkEmbalagem.Value
*!*	      Select curListaProd
*!*	      Replace pedido With Ceiling(pedido / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
*!*	   Endif
*!*	Endwith

*!*	Select curListaProd
*!*	Go Top



*!*	*!*   .pageframe_1.Page1.gridorder1.Refresh
*!*	*!*   .pageframe_1.Page1.gridorder1.AfterRowColChange
*!*	Release oMsgForm
*!*	If Eof('curListaProd') And !tlPrimeiraBusca
*!*	   Messagebox("Nenhum produto encontrado.",64,"Informação")
*!*	Endif

*!*	Dimension vetSomas(3)
*!*	vetSomas(1) = 0
*!*	vetSomas(2) = 0
*!*	vetSomas(3) = 0
*!*	Select ;
*!*	   Sum(est_venda * preco_compra), ;
*!*	   Sum(est_venda * preco_venda), ;
*!*	   Sum(est_minimo * preco_custo) ;
*!*	   from curListaProd ;
*!*	   into Array vetSomas

*!*	With Thisform.PageFrame.page2
*!*	   .txtEstCompra.Value = vetSomas(1)
*!*	   .txtEstVenda.Value = vetSomas(2)
*!*	   .txtEstminCusto.Value = vetSomas(3)
*!*	Endwith

*!*	Thisform.Calcularfretes()

*!*	*!*	oDb = Createobject([db_fornecedores])
*!*	*!*	oDb.AtualizarCampo(Thisform.selFornec.getvalue(),'dt_ult_analise',oSistema.hoje)
*!*	*!*	Release oDb

ENDPROC
PROCEDURE buscarprodutos_duaslojas
Lparameters tlPrimeiraBusca
Private All Like l*
oMsgForm = Createobject("frmstatusbarmsg",'Fazendo busca dos produtos, aguarde...')

*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
*!* Matheus #69964  05/08/19: Define a loja que irá pesquisar a promoção.
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
	If !Empty(Thisform.PageFrame.page1.cboLojasMultiSelecao.Value)
		lcWhereLoja = ' (InList(p.id_loja, ' + Alltrim(Str(Thisform.PageFrame.page1.cbolojas1.Value)) + ') or p.id_loja == 0) '
	Else
		lcWhereLoja = ' .T. '
	Endif
Else
	If Thisform.PageFrame.page1.cbolojas1.Value &gt; 0
		lcWhereLoja = ' (p.id_loja = ' + Alltrim(Str(Thisform.PageFrame.page1.cbolojas1.Value)) + ' or p.id_loja == 0) '
	Else
		lcWhereLoja = ' .T. '
	Endif
Endif

If Used('curTmpAnalise')
	Use In curTmpAnalise
Endif

With Thisform.PageFrame.page1
	If Used('bkp_itens')
		Use In bkp_itens
	Endif

	*!* Se esta marcado para manter os itens atuais, faz uma copia do produtos
	*!* que ja foram incluidos no pedido
	If .chkManter.Value
		Select *  From curListaProd Where pedido &gt; 0 Into Cursor bkp_itens Readwrite
		If _Tally = 0
			Use In bkp_itens
		Endif
	Endif

	lcWhere = 'id &gt; 0 and '
	lcWhereEstoque = ''
	If tlPrimeiraBusca
		If Used('cur_itens')
			lcWhere = ' id in (select id_produto from cur_itens where id_produto &gt; 0) and '
		Else
			Return
		Endif
	Else
		lcExprGrupo = .cntseekgrupos1.gerarexpressao('id_grupo')
		If !Isblank(lcExprGrupo)
			lcWhere = lcWhere + lcExprGrupo+' and '
		Endif

		*!* Tiago   #11842  06/06/13: Adicionado filtro por marca.
		If .cntseekmarcas1.getvalue() &gt; 0
			lcWhere = lcWhere + 'id in (select id_produto from produto_marcas where id_marca = ' + Transform(Thisform.PageFrame.page1.cntseekmarcas1.getvalue()) + ') and '
		Endif

		*!* Raul    #19426  02/04/14: Adicionado filtro por local de estocagem
		If .cntSeekLocais2.getvalue() &gt; 0
			lcWhere = lcWhere + "Id In (Select Id_Produto As Id From Est_Estoque Where Id_LocalEst = " + Transform(.cntSeekLocais2.getvalue()) + ") And "
			lcWhereEstoque = lcWhereEstoque + 'id_localest = '+sqlval(Thisform.PageFrame.page1.cntSeekLocais2.getvalue())+' AND '
		Endif


		If .chkVip.Value
			lcWhere = lcWhere + ' vip = 1 and '
		Endif

		If .chkRotatividade.Value
			lcWhere = lcWhere + ' rotatividade = 1 and '
		Endif

		If .chkForaLinha.Value
			lcWhere = lcWhere + ' substr(p.flags, 5, 1) != "1" And substr(p.flags, 6, 1) != "1" and '
		Endif

		*!* Carlos  #49591  08/09/17:       Adicionado filtro para não trazer produtos marcados como ponta de estoque
		If .chkPontaEstoque.Value
			lcWhere = lcWhere + ' p.peca_unica &lt;&gt; 1 and '
		Endif

		*!* Matheus #58787  14/06/18: Customização para, caso a Flag "Pesquisar fornecedores vinculados" estiver marcada, busca os fornecedores vinculados (Matriz e Filial).
		If .opgTodos.Value = 1 And .selfornec.getvalue() &gt; 0
			If .chkfiliais.Value
				If .selfornec.oRegistro.Id_pai &gt; 0
					lnIdForn = .selfornec.oRegistro.Id_pai
				Else
					lnIdForn = .selfornec.getvalue()
				Endif
				Select Id From fornecedores Where Id = lnIdForn Or Id_pai = lnIdForn Into Cursor tmpFornec
				lcIdsFornec = ''
				Scan
					lcIdsFornec = lcIdsFornec + Alltrim(Str(tmpFornec.Id))+','
				Endscan
				lcIdsFornec = cLeft(lcIdsFornec ,1)
				lcWhere = lcWhere + ' ( InList(Id_Forn1, ' + lcIdsFornec + ' ) or InList(Id_forn2, ' + lcIdsFornec + ' ) or InList(Id_forn3, ' + lcIdsFornec + ' ) ) and '
			Else
				lcForn = Alltrim(Str(.selfornec.getvalue()))
				lcWhere = lcWhere + '(id_forn1 = '+ lcForn +' or id_forn2 = '+lcForn+' or id_forn3 = '+lcForn+') and '
			Endif
		Endif


		*!* Caroline #55076  06/02/18: retirando o filtro fixo de produtos ativos
		*!* lcWhere = lcWhere + ' inativo &lt;&gt; .t. and '

		*!* Caroline #55076  06/02/18:    Filtro somente por produtos Ativos e\ou inativos
		*!* O tratamento para o caso de ambos desmarcados está em Commandbutton_1.click
		*!* Caso ambos estejam marcados, não se faz necessário filtro
		If .chkProdutosAtivos.Value And !.chkProdutosInativos.Value
			lcWhere = lcWhere +[ inativo = .F. And ]
		Endif

		If .chkProdutosInativos.Value And !.chkProdutosAtivos.Value
			lcWhere = lcWhere +[ inativo = .T. And ]
		Endif
		*!* FIM -- Caroline #55076

		If Used('cur_itens')
			lcWhere = Left(lcWhere,Len(lcWhere)-4)
			lcWhere = [(]+lcWhere + ') or id in (select id_produto from cur_itens where id_produto &gt; 0) and '
		Endif
	Endif

	*!* Eber    #34712  22/08/16: Filtras Produtos [Sob Encomenda]
	If .ChkEncomenda.Value
		lcWhere = lcWhere +[ encomenda = 1 And ]
	Endif

	*!* Matheus #58415  04/06/18: Filtro de produtos [Apenas os que não são sob encomenda]
	If .ChkNaoTrazEncomenda.Value
		lcWhere = lcWhere +[ encomenda = 0 And ]
	Endif

	If !Empty(lcWhere)
		lcWhere = Left(lcWhere,Len(lcWhere)-4)
	Endif
	lbBaseadoNaVendaMedia = .F.
	lcCampos = Thisform.CamposProd

	*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
	If .cboLojasMultiSelecao.Visible
		If !Empty(.cboLojasMultiSelecao.Value) And Thisform.config41007 == 'Sim'
			lcWhereEstoque = lcWhereEstoque + 'id_loja IN (' + .cboLojasMultiSelecao.Value + ') AND '
		Endif
	Else
		If .cbolojas1.Value &gt; 0 And Thisform.config41007 == 'Sim'
			lcWhereEstoque = lcWhereEstoque + 'id_loja = '+sqlval(.cbolojas1.Value)+' AND '
		Endif
	Endif

	*!* Tiago   #24417  16/12/14: Abrindo tabela de estoque no banco de dados
	If Thisform.config41007 == 'Sim'
		If !Empty(lcWhereEstoque)
			lcWhereEstoque = cLeft(lcWhereEstoque,4)
			Thisform.oestoque.loadbyexpr((lcWhereEstoque))
		Else
			Thisform.oestoque.CursorFill()
		Endif
	Endif


	*!* Busca todos os produtos que atendam o filtro pesquisa
	*!* Raul    #19426  03/04/14: A primeira coluna passa a ser a ordem de estocagem
	If Thisform.cOrdenadoPor = "ORDEM_ESTOCAGEM"
		Select &amp;lcCampos. From Produtos Where &amp;lcWhere. Into Cursor tmp_produtos_lista Readwrite Order By Ordem_Estocagem
	Else
		Select &amp;lcCampos. From Produtos p Where &amp;lcWhere Into Cursor tmp_produtos_lista Readwrite Order By Nome
	Endif

	*!* Matheus #94384  29/03/22: Adicionado o nome do grupo do produto
	Select tmp_produtos_lista
	Replace All grupo_produto With Nvl(SeekReg([est_grupos],[id],tmp_produtos_lista.id_grupo,[Alltrim(codigo)+ ' - ' + descricao]),[                       ])

	*!* Gabriel #82923  31/03/21: Chama a função de carregar os emprestimos
	If Thisform.PageFrame.page1.ChkEmprestimos.Value
		Thisform.CarregarEmprestimos()
	Endif


	*!* Raul    #19798  17/07/14: Retira do cursor os produtos que possuem Id_Vinculo_Est maior que zero
	Select tmp_produtos_lista
	Go Top
	Delete All For Id_Vinculo_Est &gt; 0
	Go Top

	*!*	busca unidade de medida
	Scan
		lounidade= seekregobj('mac_unidades','id',tmp_produtos_lista.id_unidade)
		Replace unidMedi With  lounidade.codigo

		*!* Matheus #69964  25/07/19: Cursor de promoções.
		Select Pi.id_produto, p.Id, p.inicio, p.fim From ven_promocoes_itens Pi;
			LEFT Join ven_promocoes p On p.Id = Pi.id_promocao;
			WHERE Between(Date(), p.inicio, p.fim) And Pi.id_produto = tmp_produtos_lista.Id And p.inativo = .F. And &amp;lcWhereLoja Into Cursor curTmpPromo

		*!* Matheus #69964  25/07/19: Adiciona id da promoção no cursor dos itens.
		Select curTmpPromo
		If !Eof()
			Replace tmp_produtos_lista.promo With curTmpPromo.Id
		Endif


		*!* Gabriel #82923  31/03/21: trata para preencher o valor de empréstimo no campo correto.
		If Thisform.PageFrame.page1.ChkEmprestimos.Value
			Select curEmprestimos
			Locate For id_produto = tmp_produtos_lista.Id
			If Found()
				Select tmp_produtos_lista
				Replace saldo_emprestimo With curEmprestimos.saldo
			Endif
		Endif
	Endscan


	*!* 29/05/2009 19:59:04   TERTEROLA # Juliano
	*!* Chama metodo que ira preencher os campos de est_venda, est_pedido, etc. buscando da EST_ESTOQUE.
	This.CarregarEstoques()
	This.buscarqtdestoquesremotos()

	*!* Raul    #23717  20/10/14: Incluído o filtro para CV (cancelamento de vendas)
	If .chktransf.Value
		lcTipoMovSaidas   = 'PV-VE-CV-TR-TC'
		lcTipoMovEntradas = 'NF-CV-DV-TR'
	Else
		lcTipoMovSaidas   = 'PV-VE-CV-TC'
		lcTipoMovEntradas = 'NF-CV-DV'
	Endif


	Do Case
	Case .opganalise.Value = 4
		*!* SEM ANALISES

	Case .opganalise.Value = 1 &amp;&amp; ESTOQUE MINIMO
		Select tmp_produtos_lista
		*!* Lucas   #19032  25/04/14: Ajustado para não fazer replace &gt; 0 no pedido quando o produto estar fora de linha da loja ou fornecedor.
		Scan
			*!* Charles #65380  31/01/19: Alterado para zerar o campos de Pedido somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.
			*!* Charles #66365  26/04/19: Alterado para zerar o campos de Pedido somente se os flags "Fora de linha (Fornec)" ou "Fora de linha (Loja)" estiverem marcado no cadastro de produto.
			If Substr(tmp_produtos_lista.Flags, 6, 1) = '1' Or Substr(tmp_produtos_lista.Flags, 5, 1) = '1'
				Replace pedido With 0
				Replace pedido2 With 0
				Replace pedido3 With 0
			Else
				*!* Cristof #93139  19/01/22: Adicionado o campo "est_reservado" para calcular o quanto tem de estoque diponivel (est_venda - est_vendido - est_reservado)
				Replace pedido With Iif(est_minimo &gt; est_venda + est_pedido - est_vendido - est_reservado, est_minimo - ((est_venda - est_vendido - est_reservado) + est_pedido) ,00000.000)
				*!* Tiago   #27723  27/04/15: texto
				Do Case
				Case Thisform.nidloja = 1
					Replace pedido2 With 0
					Replace pedido3 With 0
				Case Thisform.nidloja = 2
					Replace pedido2 With pedido
					Replace pedido3 With 0
					Replace pedido With 0
				Case Thisform.nidloja = 3
					Replace pedido3 With pedido
					Replace pedido2 With 0
					Replace pedido With 0
				Otherwise

					Replace pedido3 With ;
						IIF(est_min_3 &gt; est_ven_3 + est_pedido3 - est_vendido3 , est_min_3 - ((est_ven_3 - est_vendido3)+ est_pedido3) ,00000.000)

					Replace pedido2 With ;
						IIF(est_min_2 &gt; est_ven_2 + est_pedido2 - est_vendido2 , est_min_2 - ((est_ven_2 - est_vendido2)+ est_pedido2) ,00000.000)

					Replace pedido With ;
						IIF(est_min_1 &gt; est_ven_1 + est_pedido1 - est_vendido1 , est_min_1 - ((est_ven_1 - est_vendido1)+ est_pedido1) ,00000.000)
					*!*							brow
					*!*						If pedido &gt; 0
					*!*							Replace pedido With pedido - pedido2
					*!*	*!*							brow
					*!*						Endif
				Endcase
			Endif
		Endscan
		Select tmp_produtos_lista
		*!*			brow
	Case .opganalise.Value = 2 &amp;&amp; VENDA MEDIA
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)

		lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
		lnIndice = .spnIndice.Value

		If Thisform.config41007 == 'Sim'
			lcAuxWhereEstoque = .cntVendaMedia.gerarexpressao('data','sql')
		Endif

		lcAuxWhere = .cntVendaMedia.gerarexpressao('data')

		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and id_loja = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja = '+vfpval(Thisform.nidloja)
				Endif
			Else
				lcAuxWhere = lcAuxWhere + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				Endif
			Endif
		Endif

		If Empty(lcAuxWhere)
			If This.config41007 = "Não"
				lcAuxWhere = ".T."
			Else
				lcAuxWhere = "TRUE"
			Endif
		Endif


		*!* Raul    #23717  24/10/14: Até a versão 20 existem transferências processadas como NF

		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr((lcAuxWhereEstoque))
		Endif

		Select *;
			FROM est_movimento;
			WHERE &amp;lcAuxWhere. And id_produto In (Select Id From tmp_produtos_lista Group By Id);
			ORDER By id_produto, Data;
			INTO Cursor curTmpEst_Movimentos;
			READWRITE

		Update curTmpEst_Movimentos Set Tipo = "TR";
			WHERE Id_Venda In (Select Id From Vendas Where Id = curTmpEst_Movimentos.Id_Venda And NaturezaOper = "TRANSF")


		*!* Tiago   #27723  24/04/15: Se utiliza pedido para duas lojas, agrupa por id_loja também.

		Select id_produto, ;
			SUM(Iif(Tipo_ES = 'S' And Tipo_Nulo = 0 And Tipo $ lcTipoMovSaidas, Qtd, Iif(Tipo_ES = 'E' And Tipo $ lcTipoMovEntradas, -Qtd, 0000000.00))) As Qtd_Vendida,;
			0000000000.00 As qtd_media,;
			id_loja;
			FROM curTmpEst_Movimentos;
			INTO Cursor curTmpAnalise Readwrite;
			GROUP By id_produto,id_loja

		Replace qtd_media With (Qtd_Vendida / lnMeses) * lnIndice All

		Select Sum(qtd_media) As TotQtdMedia,id_produto From curTmpAnalise Group By id_produto Into Cursor curTotQtdMedia Readwrite
		Select curTmpAnalise
		Scan
			Select tmp_produtos_lista
			Locate For Id = curTmpAnalise.id_produto
			If Found()
				Select curTotQtdMedia
				Locate For id_produto = tmp_produtos_lista.Id

				*!* Tiago   #27723  24/04/15: Atualizando os valores de pedido 2 venda média para cada loja.
				Select tmp_produtos_lista
				Do Case
				Case Thisform.nidloja = 1
					Replace pedido With Iif(curTotQtdMedia.TotQtdMedia &gt; (tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido), ;
						CEILING(curTotQtdMedia.TotQtdMedia-(tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido)),0)
					Replace pedido2 With 0
					Replace pedido3 With 0
				Case Thisform.nidloja = 2
					Replace pedido2 With Iif(curTotQtdMedia.TotQtdMedia &gt; (tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido), ;
						CEILING(curTotQtdMedia.TotQtdMedia-(tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido)),0)
					Replace pedido With 0
					Replace pedido3 With 0
				Case Thisform.nidloja = 3
					Replace pedido3 With Iif(curTotQtdMedia.TotQtdMedia &gt; (tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido), ;
						CEILING(curTotQtdMedia.TotQtdMedia-(tmp_produtos_lista.est_venda + tmp_produtos_lista.est_pedido)),0)
					Replace pedido With 0
					Replace pedido2 With 0
				Otherwise
					If curTmpAnalise.id_loja = 1
						Replace pedido With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_ven_1 + tmp_produtos_lista.est_pedido1), ;
							CEILING(curTmpAnalise.qtd_media-(tmp_produtos_lista.est_ven_1 + tmp_produtos_lista.est_pedido1)),0)
					Endif

					If curTmpAnalise.id_loja = 2
						Replace pedido2 With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_ven_2 + tmp_produtos_lista.est_pedido2), ;
							CEILING(curTmpAnalise.qtd_media-(tmp_produtos_lista.est_ven_2 + tmp_produtos_lista.est_pedido2)),0)
					Endif

					If curTmpAnalise.id_loja = 3
						Replace pedido3 With Iif(curTmpAnalise.qtd_media &gt; (tmp_produtos_lista.est_ven_3 + tmp_produtos_lista.est_pedido3), ;
							CEILING(curTmpAnalise.qtd_media-(tmp_produtos_lista.est_ven_3 + tmp_produtos_lista.est_pedido3)),0)
					Endif

				Endcase

				Select tmp_produtos_lista
				If !Empty(curTmpAnalise.id_produto) And curTmpAnalise.id_loja = 1
					Replace venda_media With curTmpAnalise.qtd_media
				Endif
				If !Empty(curTmpAnalise.id_produto) And curTmpAnalise.id_loja = 2
					Replace venda_media2 With curTmpAnalise.qtd_media
				Endif
				If !Empty(curTmpAnalise.id_produto) And curTmpAnalise.id_loja = 3
					Replace venda_media3 With curTmpAnalise.qtd_media
				Endif
			Endif
		Endscan
		*!*			Select pedido,pedido2 From tmp_produtos_lista

	Case .opganalise.Value = 3 &amp;&amp; VENDA NO PERIODO
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)
		lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
		lnIndice = .spnIndice.Value

		If Thisform.config41007 == 'Sim'
			lcAuxWhereEstoque = .cntVendaMedia.gerarexpressao('data','sql')
		Endif

		lcAuxWhere = .cntVendaMedia.gerarexpressao('data')

		If Empty(lcAuxWhere)
			If This.config41007 = "Não"
				lcAuxWhere = ".T."
			Else
				lcAuxWhere = "TRUE"
			Endif
		Endif

		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and id_loja = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja = '+vfpval(Thisform.nidloja)
				Endif
			Else
				lcAuxWhere = lcAuxWhere + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				Endif
			Endif
		Endif


		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr((lcAuxWhereEstoque))
		Endif

		*!* Lucas   #26442  27/02/15: Substituido Sum(Iif(Tipo $ lcTipoMovSaidas,Qtd,Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,0000000.00))) por;
		Sum(Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,Iif(Tipo $ lcTipoMovSaidas,Qtd,0000000.00))).

		*!* Tiago   #27723  27/04/15: Atualizando os valores de pedido 2 venda média para cada loja.

		Select id_produto, ;
			SUM(Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,Iif(Tipo $ lcTipoMovSaidas,Qtd,0000000.00))) As Qtd_Vendida, ;
			id_loja;
			FROM est_movimento ;
			INTO Cursor curTmpAnalise ;
			GROUP By id_produto,id_loja ;
			WHERE &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id) Readwrite

		Index On id_produto Tag id_produto

		*!*			Select tmp_produtos_lista
		*!*			Set Relation To Id Into curTmpAnalise

		*Select Sum(qtd_media) As TotQtdMedia,id_produto From curTmpAnalise Group By id_produto Into Cursor curTotQtdMedia Readwrite

		Select curTmpAnalise
		Scan
			Select tmp_produtos_lista
			Locate For Id = curTmpAnalise.id_produto
			If Found()
				*Select curTotQtdMedia
				*Locate For id_produto = tmp_produtos_lista.Id

				Select tmp_produtos_lista
				*!* Tiago   #27723  27/04/15: Atualizando valor do pedido conforme a loja
				Do Case
				Case Thisform.nidloja = 1
					Replace pedido With (curTmpAnalise.Qtd_Vendida*lnIndice)&amp;&amp; For !Empty(curTmpAnalise.id_produto)
					Replace pedido2 With 0
					Replace pedido3 With 0
				Case Thisform.nidloja = 2
					Replace pedido2 With (curTmpAnalise.Qtd_Vendida*lnIndice)&amp;&amp; For !Empty(curTmpAnalise.id_produto)
					Replace pedido With 0
					Replace pedido3 With 0
				Case Thisform.nidloja = 3
					Replace pedido3 With (curTmpAnalise.Qtd_Vendida*lnIndice)&amp;&amp; For !Empty(curTmpAnalise.id_produto)
					Replace pedido With 0
					Replace pedido2 With 0
				Otherwise
					If curTmpAnalise.id_loja  = 1
						Replace pedido With (curTmpAnalise.Qtd_Vendida*lnIndice )
					Endif
					If curTmpAnalise.id_loja  = 2
						Replace pedido2 With (curTmpAnalise.Qtd_Vendida*lnIndice )
					Endif
					If curTmpAnalise.id_loja  = 3
						Replace pedido3 With (curTmpAnalise.Qtd_Vendida*lnIndice )
					Endif
				Endcase
			Endif
		Endscan
		*!* Matheus #72517  22/01/20: Nova base de cálculo via ESTOQUE IDEAL.

	Case .opganalise.Value = 5 &amp;&amp; ESTOQUE IDEAL
		Select tmp_produtos_lista
		Scan

			*!* Cristof #93139  19/01/22: Adicionado o campo "est_reservado" para calcular o quanto tem de estoque diponivel (est_venda - est_vendido - est_reservado)
			Select est_estoque
			Locate For id_produto = tmp_produtos_lista.Id And id_loja = Thisform.nidloja

			Do Case
			Case Substr(tmp_produtos_lista.Flags, 6, 1)='1' Or Substr(tmp_produtos_lista.Flags, 5, 1) = '1'
				Select tmp_produtos_lista
				Replace pedido  With 0
				Replace pedido2 With 0
				Replace pedido3 With 0

			Case Thisform.nidloja = 1
				Select tmp_produtos_lista
				Replace pedido  With Iif(est_estoque.ponto_reposicao &gt; est_venda + est_pedido - est_vendido - est_reservado, est_estoque.ponto_reposicao - ((est_venda - est_vendido - est_reservado)+ est_pedido) ,00000.000)
				Replace pedido2 With 0
				Replace pedido3 With 0

			Case Thisform.nidloja = 2
				Select tmp_produtos_lista
				Replace pedido  With 0
				Replace pedido2 With Iif(est_estoque.ponto_reposicao &gt; est_venda + est_pedido - est_vendido - est_reservado, est_estoque.ponto_reposicao - ((est_venda - est_vendido - est_reservado)+ est_pedido) ,00000.000)
				Replace pedido3 With 0

			Case Thisform.nidloja = 3
				Select tmp_produtos_lista
				Replace pedido  With 0
				Replace pedido2 With 0
				Replace pedido3 With Iif(est_estoque.ponto_reposicao &gt; est_venda + est_pedido - est_vendido - est_reservado, est_estoque.ponto_reposicao - ((est_venda - est_vendido - est_reservado)+ est_pedido) ,00000.000)

			Otherwise
				*Loja 1
				Select est_estoque
				Locate For id_produto = tmp_produtos_lista.Id And id_loja = 1
				Select tmp_produtos_lista
				Replace pedido With Iif(est_estoque.ponto_reposicao &gt; est_estoque.est_venda + est_estoque.est_pedido - est_estoque.est_vendido - est_estoque.est_reservado, est_estoque.ponto_reposicao - ((est_estoque.est_venda - est_estoque.est_vendido - est_estoque.est_reservado)+ est_estoque.est_pedido) ,00000.000)
				*Loja 2
				Select est_estoque
				Locate For id_produto = tmp_produtos_lista.Id And id_loja = 2
				Select tmp_produtos_lista
				Replace pedido2 With Iif(est_estoque.ponto_reposicao &gt; est_estoque.est_venda + est_estoque.est_pedido - est_estoque.est_vendido - est_estoque.est_reservado, est_estoque.ponto_reposicao - ((est_estoque.est_venda - est_estoque.est_vendido - est_estoque.est_reservado)+ est_estoque.est_pedido) ,00000.000)
				*Loja 3
				Select est_estoque
				Locate For id_produto = tmp_produtos_lista.Id And id_loja = 3
				Select tmp_produtos_lista
				Replace pedido3 With Iif(est_estoque.ponto_reposicao &gt; est_estoque.est_venda + est_estoque.est_pedido - est_estoque.est_vendido - est_estoque.est_reservado, est_estoque.ponto_reposicao - ((est_estoque.est_venda - est_estoque.est_vendido - est_estoque.est_reservado)+ est_estoque.est_pedido) ,00000.000)
			Endcase
		Endscan
	Endcase

	Replace tmp_produtos_lista.totalPedido With tmp_produtos_lista.pedido + tmp_produtos_lista.pedido2 + tmp_produtos_lista.pedido3

	If .chkAnalMedia.Value And .opganalise.Value &lt;&gt; 2
		*!* Charles #66365  02/04/19: Calcula por meses fracionado
		*lnMeses = .cntVendaMedia.diferenca('MESES')
		lnMeses  = RetornaQuantidadeFracionadaMeses(.cntVendaMedia.cntData1.txtData.Value, .cntVendaMedia.cntData2.txtData.Value)
		lnMeses = Iif(lnMeses&lt;=0,1,lnMeses)
		lnIndice = .spnIndice.Value

		If Thisform.config41007 == 'Sim'
			lcAuxWhereEstoque = .cntVendaMedia.gerarexpressao('data','sql')
			If Empty(lcAuxWhereEstoque)
				*!* Carlos  #56344  20/04/18: Alterado código da condição Where para pesquisar pela data de um ano no Postgre
				*lcAuxWhereEstoque = "id = -1"
				lcAuxWhereEstoque = ExprData( [data], PrimeiroDiaDoMes( Gomonth( Date(), -11 ) ), Date(), [SQL] )
			Endif
		Endif

		lcAuxWhere = .cntVendaMedia.gerarexpressao('data')

		If Empty(lcAuxWhere)
			*!* Mschoen #51766  07/11/17: Cálculo da venda média sobre 11 meses, divisão por 12, quando não há datas
			*!* Isto só ocorre quando o form está sem nenhuma alteração (nenhuma data, nenhum componente alterado depois da tela ser aberta)
			*!* Comando abaixo comentado para se adequar a regra
			*!* If This.config41007 = "Não"
			*!* 	lcAuxWhere = ".T."
			*!* Else
			*!* 	lcAuxWhere = "TRUE"
			*!* Endif

			*!* Carlos  #56344  20/04/18: Comentado código a baixo pois esta clausula é executada sempre no DBF ou no cursor do ;
			Postgre e não precisa de tratamento para SQL.

			*!*    If This.config41007 == [Não]
			*!*       lcAuxWhere = 'Between(data, ' + vfpval(PrimeiroDiaDoMes( Gomonth( Date(), -11 ) )) + ', ' + vfpval(Date() ) + ')'
			*!*    Else
			*!*       lcAuxWhere = ExprData( [data], PrimeiroDiaDoMes( Gomonth( Date(), -11 ) ), Date(), [SQL] )
			*!*    EndIf

			lcAuxWhere = 'Between(data, ' + vfpval(PrimeiroDiaDoMes( Gomonth( Date(), -11 ) )) + ', ' + vfpval(Date() ) + ')'

			*!* Charles #66365  24/04/19: Alteração para usar a quantidade fracionada de meses quando não for informado um período.
			lnMeses  = RetornaQuantidadeFracionadaMeses(PrimeiroDiaDoMes(Gomonth(Date(),-11)), Date())
			lnMeses  = Iif(lnMeses&lt;=0,1,lnMeses)
		Endif

		If Thisform.nidloja &gt; 0
			If Thisform.PageFrame.page1.opgLoja.Value = 1
				lcAuxWhere = lcAuxWhere + ' and id_loja = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja = '+vfpval(Thisform.nidloja)
				Endif
			Else
				lcAuxWhere = lcAuxWhere + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				If Thisform.config41007 == 'Sim'
					lcAuxWhereEstoque = lcAuxWhereEstoque + ' and id_loja_s = '+vfpval(Thisform.nidloja)
				Endif
			Endif
		Endif


		*!* Tiago   #24417  17/12/14: Abrindo tabela de movimento no banco de dados
		If Thisform.config41007 == 'Sim'
			Thisform.omovimento.loadbyexpr((lcAuxWhereEstoque))
		Endif

		*!*			Select id_produto, ;
		*!*				Sum(Iif(Tipo $ lcTipoMovSaidas And Tipo_Nulo=0,Qtd,Iif(Tipo$lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,0000000.00))) As Qtd_Vendida, ;
		*!*				0000000000.00 As qtd_media,id_loja ;
		*!*				From est_movimento ;
		*!*				Group By id_produto, id_loja;
		*!*				Where &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id) Into Cursor curTmpAnalise Readwrite

		Select id_produto, ;
			SUM(Iif(Tipo $ lcTipoMovEntradas And Tipo_ES = 'E',-Qtd,Iif(Tipo $ lcTipoMovSaidas,Qtd,0000000.00))) As Qtd_Vendida, ;
			0000000000.00 As qtd_media,id_loja;
			FROM est_movimento ;
			INTO Cursor curTmpAnalise ;
			GROUP By id_produto,id_loja ;
			WHERE &amp;lcAuxWhere And id_produto In (Select Id From tmp_produtos_lista Group By Id) Readwrite

		Select curTmpAnalise
		Replace qtd_media With Qtd_Vendida / lnMeses All

		Index On id_produto Tag id_produto

		Select curTmpAnalise
		Scan
			Select tmp_produtos_lista
			Locate For Id = curTmpAnalise.id_produto
			If Found()
				Do Case
					Select curTmpAnalise
				Case curTmpAnalise.id_loja = 1
					Select tmp_produtos_lista
					Replace venda_media With curTmpAnalise.qtd_media
				Case curTmpAnalise.id_loja = 2
					Select tmp_produtos_lista
					Replace venda_media2 With curTmpAnalise.qtd_media
				Case curTmpAnalise.id_loja = 3
					Select tmp_produtos_lista
					Replace venda_media3 With curTmpAnalise.qtd_media
				Endcase
			Endif
		Endscan
	Endif

	Select curListaProd
	Set Filter To
	Delete All
	Append From Dbf('tmp_produtos_lista')
	Use In tmp_produtos_lista

	If .txtQtdmin.Value &gt; 0
		Replace pedido With 0 For pedido &lt; .txtQtdmin.Value
		Replace pedido2 With 0 For pedido2 &lt; .txtQtdmin.Value
		Replace pedido3 With 0 For pedido3 &lt; .txtQtdmin.Value
	Endif

	If Used('cur_itens')
		Select cur_itens
		Scan For id_produto &gt; 0
			Select curListaProd
			Locate For Id = cur_itens.id_produto
			If Found()
				Replace curListaProd.pedido With cur_itens.qtd_pedido, ;
					id_itempedido With cur_itens.Id
			Endif
		Endscan
	Endif

	*!* Charles #66365  18/04/19: Abater quantidade "A Transferir" do campo "Pedido"
	If Thisform.PageFrame.page1.chkAbaterTrasnfReceb.Value
		Select curListaProd
		Replace pedido With pedido - est_transferir All
	Endif

	If .chkEmbalagem.Value
		Select curListaProd
		Replace pedido With Ceiling(pedido / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
		Replace pedido2 With Ceiling(pedido2 / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
		Replace pedido3 With Ceiling(pedido3 / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
	Endif

	If Used('bkp_itens')
		Select bkp_itens
		Scan
			Scatter Memo Name oregbkp
			Select curListaProd
			Locate For Id = bkp_itens.Id
			If !Found()
				Append Blank
			Endif
			Gather Name oregbkp Memo
		Endscan
		Select curListaProd
		*     Zap
		*      Insert Into curListaProd Select * From bkp_itens Order By Nome
		Use In bkp_itens

		*!*	      Select curListaProd
		*!*	      Scan
		*!*	         Select bkp_itens
		*!*	         Locate For Id = curListaProd.Id
		*!*	         If !Found()
		*!*	            lnAuxId = curListaProd.Id
		*!*	            Insert Into bkp_itens Select * From curListaProd Where Id = lnAuxId
		*!*	         Endif
		*!*	      Endscan
		*!*	      Select curListaProd
		*!*	 *     Zap
		*!*	*      Insert Into curListaProd Select * From bkp_itens Order By Nome
		*!*	      Use In bkp_itens
	Endif
	*!*	   If .spnindice.Value &gt; 0
	*!*	      Select curListaProd
	*!*	      Replace pedido With pedido * .spnindice.Value All
	*!*	   Endif
	*!* Eber    #34712  22/08/16: Não deve gerar sugestão na coluna PEDIDO quando o produto da análise estiver marcado como FORA DE LINHA (na loja ou no fornecedor).
	Select curListaProd
	*!* Charles #65380  31/01/19: Alterado para zerar o campo de Pedido somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.
	*Replace pedido With 0 For Substr(Flags, 6, 1) = [1]
	*!* Charles #66365  26/04/19: Novamente não deve gerar sugestão na coluna PEDIDO quando o produto da análise estiver marcado como FORA DE LINHA (na loja ou no fornecedor).
	Replace pedido With 0 For Substr(Flags, 5, 1) = [1] Or Substr(Flags, 6, 1) = [1]

Endwith

*!*	atualiza quantidades de produtos do kit

Select cod_distri,pedido,pedido2,pedido3,qtd_embalagem From curListaProd Where (pedido &gt; 0 Or pedido2 &gt; 0 Or pedido3 &gt; 0) And !Empty(cod_distri) Into Cursor curQntDistri Readwrite

Select curQntDistri
Scan
	If qtd_embalagem &gt; 0
		lnqntdDistri  = (pedido / qtd_embalagem)
		lnqntdDistri2 = (pedido2 / qtd_embalagem)
		lnqntdDistri3 = (pedido3 / qtd_embalagem)
	Else
		lnqntdDistri = pedido
		lnqntdDistri2 = pedido2
		lnqntdDistri3 = pedido3
	Endif
	Select curListaProd
	Scan For cod_distri = curQntDistri.cod_distri
		If qtd_embalagem &gt; 0
			Replace pedido With (lnqntdDistri * qtd_embalagem)
			Replace pedido2 With (lnqntdDistri2 * qtd_embalagem)
			Replace pedido3 With (lnqntdDistri3 * qtd_embalagem)
		Else
			Replace pedido With lnqntdDistri
			Replace pedido2 With lnqntdDistri2
			Replace pedido3 With lnqntdDistri3
		Endif
	Endscan
Endscan


*!* Charles #66365  03/05/19: Zera a coluna pedido quando for &lt; 0
Select curListaProd
Replace pedido With 0 For pedido &lt; 0
Replace All totalPedido With pedido + pedido2 + pedido3

Select curListaProd
Go Top

*!*   .pageframe_1.Page1.gridorder1.Refresh
*!*   .pageframe_1.Page1.gridorder1.AfterRowColChange
Release oMsgForm
If Eof('curListaProd') And !tlPrimeiraBusca
	Messagebox("Nenhum produto encontrado.",64,"Informação")
Endif


Dimension vetSomas(3)
vetSomas(1) = 0
vetSomas(2) = 0
vetSomas(3) = 0
Select ;
	SUM(est_venda * preco_compra), ;
	SUM(est_venda * preco_venda), ;
	SUM(est_minimo * preco_custo) ;
	FROM curListaProd ;
	INTO Array vetSomas

With Thisform.PageFrame.page2
	.txtEstCompra.Value = vetSomas(1)
	.txtEstVenda.Value = vetSomas(2)
	.txtEstminCusto.Value = vetSomas(3)
Endwith

*!* Tiago   #00000  16/08/13: Comentado porque no final não era isso que era pra ser exibido e então comentei pq um dia poder ser usado.
*!*	Select curListaProd
*!*	brow
*!*	Scan
*!*		Select fornecedores
*!*		Locate For Id = curListaProd.id_forn1
*!*		If Found()
*!*			Select curListaProd
*!*			Replace fornecedor With Alltrim(fornecedores.razsoc)
*!*		Endif
*!*	Endscan

Select curListaProd
Go Top


Thisform.Calcularfretes()

*!* Raul    #19426  03/04/14: Seta flag para a criação de novo histórico de compra e venda dos produtos
*!*                           Seta flag para visualização dos dados complementares dos produtos
*!*                           Mostra os dados complementares dos produtos
Thisform.lCriaNovoHistorico = .T.
Thisform.lVisualizarHistoricosCompraVenda = .F.
Thisform.DiplayDadosComplementares_HistoricCompraVenda()

ENDPROC
PROCEDURE buscarqtdestoquesremotos
Select tmp_produtos_lista
Scan
Select est_remoto
Locate For codigo = tmp_produtos_lista.cod_distri
If Found()
Replace tmp_produtos_lista.est_distribuidor 		With 	(est_remoto.est_venda -  est_remoto.est_reserv) - est_remoto.est_vendid
Replace tmp_produtos_lista.vl_distribuidor		With	est_remoto.valor
Replace tmp_produtos_lista.nome_distri			With	est_remoto.Nome
Replace tmp_produtos_lista.unidade				With	est_remoto.unidade
Replace tmp_produtos_lista.est_pedi_distr			With	est_remoto.est_pedido
Endif
Endscan

ENDPROC
PROCEDURE calcularfretes
If This.PageFrame.PAGE1.selfornec.getvalue() &gt; 0
lnIdFor = This.PageFrame.PAGE1.selfornec.getvalue()
Select Top 3 valor_total, frete_conh From com_notasfiscais ;
Where id_fornecedor = lnIdFor and frete_conh &gt; 0 Order By dt_emissao Desc ;
into Cursor curFretes

Sum valor_total, frete_conh To lnAux1, lnAux2

This.PageFrame.PAGE2.txtfretes.Value = Round(lnAux2 * 100 / lnAux1,2)
Else
This.PageFrame.PAGE2.txtfretes.Value = 0.00
Endif

ENDPROC
PROCEDURE calcularqtdvendasultimos4meses
Local lcFiltroLojaMov, lcFiltroTipos, lcTiposCancalado, lnMes1, lnMes2, lnMes3, lnMes4
Local lcTiposVenda, ldFinal, ldInicial, ldHoje, lnMes, lnOldArea, lcMes, lcAno, lnAno1, lnAno2, lnAno3, lnAno4, lcCampo, lcNomeMes, lcNomeMes1, lcNomeMes2, lcNomeMes3, lcNomeMes4
Local lcHeaderTotalVendasMes1, lcHeaderTotalVendasMes2, lcHeaderTotalVendasMes3, lcHeaderTotalVendasMes4

lnOldArea = Select()

ldFinal = oSistema.Hoje


For nVar=1 To 4
	lcMes='lnMes' + Alltrim(Str(nVar))
	lcAno='lnAno' + Alltrim(Str(nVar))
	lcNomeMes='lcNomeMes' + Alltrim(Str(nVar))
	&amp;lcMes = Month(ldFinal) - (nVar)
	&amp;lcAno = Year(ldFinal)
	If &amp;lcMes &lt;= 0
		&amp;lcMes = &amp;lcMes + 12
		&amp;lcAno = &amp;lcAno - 1
	Endif
	Do Case
	Case &amp;lcMes = 1
		&amp;lcNomeMes='JAN'
	Case &amp;lcMes = 2
		&amp;lcNomeMes='FEV'
	Case &amp;lcMes = 3
		&amp;lcNomeMes='MAR'
	Case &amp;lcMes = 4
		&amp;lcNomeMes='ABR'
	Case &amp;lcMes = 5
		&amp;lcNomeMes='MAI'
	Case &amp;lcMes = 6
		&amp;lcNomeMes='JUN'
	Case &amp;lcMes = 7
		&amp;lcNomeMes='JUL'
	Case &amp;lcMes = 8
		&amp;lcNomeMes='AGO'
	Case &amp;lcMes = 9
		&amp;lcNomeMes='SET'
	Case &amp;lcMes = 10
		&amp;lcNomeMes='OUT'
	Case &amp;lcMes = 11
		&amp;lcNomeMes='NOV'
	Case &amp;lcMes = 12
		&amp;lcNomeMes='DEZ'
	Endcase

Endfor

ldInicial = Date(lnAno4,lnMes4,1)
ldFinal   = UltimoDiaDoMes(Date(lnAno1,lnMes1,1))


If Thisform.PageFrame.Page1.opgLoja.Value = 1
	lcFiltroLojaMov = " Id_Loja " + Iif(Thisform.nIdLoja = 0, '&gt; 0', '= ' + Transform(Thisform.nIdLoja))
Else
	lcFiltroLojaMov = " Id_Loja_S " + Iif(Thisform.nIdLoja = 0, '&gt; 0', '= ' + Transform(Thisform.nIdLoja))
Endif

If Thisform.PageFrame.pAGE1.chktransf.Value
lcTiposVenda  = "VE-PV-TC-CV-CN-TR"
lcTipoCancelado = 'NF-CV-DV-TR'
Else
lcTiposVenda  = "VE-PV-TC-CV"
lcTipoCancelado = 'NF-CV-DV'
EndIf

If Thisform.config41007 == 'Sim'
	lcFiltroMov = ''
	lcFiltroTipos   = " Tipo in('" + lcTiposVenda + "-" + lcTipoCancelado + "-NF-CN')"
	lcFiltroMov = lcFiltroMov + [Data Between '] + Transform(ldInicial) + [' AND '] + Transform(ldFinal) + [' AND ] + lcFiltroLojaMov + ' AND ' + lcFiltroTipos + [ AND (Estoque = 'DISPONIVEL' OR Estoque = 'DEFEITO')]

	Thisform.omovimento.loadbyexpr((lcFiltroMov))

	Select * From est_movimento Where id_produto In (Select Id From curListaProd) Into Cursor tmpMovimento Readwrite
Else
	lcFiltroTipos   = " Tipo $ '" + lcTiposVenda + "-" + lcTipoCancelado + "-NF-CN'"
	Select * From est_movimento;
		Where id_produto In (Select Id From curListaProd) And Between(Data, ldInicial, ldFinal) And &amp;lcFiltroLojaMov. And &amp;lcFiltroTipos. And (Estoque = "DISPONIVEL" or Estoque = "DEFEITO");
		Into Cursor tmpMovimento;
		Readwrite
Endif

Index On id_produto Tag PRO
Index On Data       Tag DAT Additive
Index On Deleted()  Tag DEL Additive
Set Order To 1


Select curListaProd

Scan
	For nVar=1 To 4
		lcMes='lnMes' + Alltrim(Str(nVar))
		lcAno='lnAno' + Alltrim(Str(nVar))
		lcCampo = 'qtd_vendas_m' + Alltrim(Str(nVar))
		*Select Sum(Iif(tipo $ lcTiposVenda Or (tipo = 'CN' And tipo_es = 'S'), qtd, Iif(tipo $ lcTipoCancelado Or (tipo = 'NF' And tipo_es = 'E' And id_cliente &gt; 0) ,-qtd,0000000000.00))) As QtdVendida ;
		From tmpMovimento mov Where Month(Data)=&amp;lcMes And Year(Data)=&amp;lcAno And mov.id_produto=curListaProd.Id Into Cursor curQtdVendido
		Select Sum(Iif(m.Tipo $ lcTipoCancelado And m.Tipo_ES = 'E' And m.id_Fornec = 0 And (Isnull(v.Cfop) Or (! '5.152' $ v.Cfop And ! '5.409' $ v.Cfop)), -m.Qtd,;
			Iif(Tipo $ lcTiposVenda And m.Tipo_ES = 'S' And m.id_Fornec = 0,m.Qtd,0000000.00))) As QtdVendida ;
			From tmpMovimento m;
			Left Join Vendas As v On v.Id = m.Id_Venda;
			Where Month(Data)=&amp;lcMes And Year(Data)=&amp;lcAno And m.id_produto=curListaProd.Id Into Cursor curQtdVendido
		Replace curListaProd.&amp;lcCampo With curQtdVendido.QtdVendida
	Endfor
Endscan

lcHeaderTotalVendasMes1 = [Qtd Vendas ] + lcNomeMes1 + [/] + Alltrim(Str(lnAno1))
lcHeaderTotalVendasMes2 = [Qtd Vendas ] + lcNomeMes2 + [/] + Alltrim(Str(lnAno2))
lcHeaderTotalVendasMes3 = [Qtd Vendas ] + lcNomeMes3 + [/] + Alltrim(Str(lnAno3))
lcHeaderTotalVendasMes4 = [Qtd Vendas ] + lcNomeMes4 + [/] + Alltrim(Str(lnAno4))

Thisform.PageFrame.page2.gridorder1.intelicolumn48.inteliheader1.Caption = lcHeaderTotalVendasMes1
Thisform.PageFrame.page2.gridorder1.intelicolumn49.inteliheader1.Caption = lcHeaderTotalVendasMes2
Thisform.PageFrame.page2.gridorder1.intelicolumn50.inteliheader1.Caption = lcHeaderTotalVendasMes3
Thisform.PageFrame.page2.gridorder1.intelicolumn51.inteliheader1.Caption = lcHeaderTotalVendasMes4



ENDPROC
PROCEDURE calculartotal
*Dimension vet(1)
*vet(1) = 0
*Select Sum(curListaProd.pedido*curListaProd.preco_compra) From curListaProd Into Array vet
*Thisform.txttotal.Value = vet(1)

Dimension vetSoma(6)
vetSoma(1) = 0
vetSoma(2) = 0
vetSoma(3) = 0
vetSoma(4) = 0
vetSoma(5) = 0
vetSoma(6) = 0

Select Sum((preco_compra * pedido) + (preco_compra * pedido2) + (preco_compra * pedido3)), ;
sum(Iif(pedido&gt;0,1,0)) As cnt_sel, ;
count(*) As Total, ;
Sum((preco_custo * pedido) + (preco_custo * pedido2) + (preco_custo * pedido3)), ;
Sum((peso * pedido) + (peso * pedido2) + (peso * pedido3)), ;
Sum((volume * pedido) + (volume * pedido2) + (volume * pedido3)) ;
from curListaProd ;
into Array vetSoma

With Thisform.PageFrame.Page2
.txttotal.Value = vetSoma(1)
.lblresumo.Caption = Alltrim(transform(vetSoma(2)))+" de "+Alltrim(transform(vetSoma(3)))+' produtos selecionados.'
.txtTotalPreCusto.Value = vetSoma(4)
.txtPesoTotal.value = vetSoma(5)

*!* Cristof #69129  28/06/19: Adicionado valor total de litragem
.txtLitragem.value = vetSoma(6)
Endwith


ENDPROC
PROCEDURE carregaremprestimos
Private All Like l*

*If Thisform.PageFrame.page1.cbolojas1.Value &gt; 0
*	lcWhereLoja = ' e.id_loja = ' + vfpval(Thisform.PageFrame.page1.cbolojas1.Value)
*Else
	lcWhereLoja = ' .T. '
*Endif

SELECT e.id_produto,;
	SUM(IIF(e.tipo = [E], e.quantidade - e.qtd_retornada, 00000000000.0000)) saldo_entradas,;
	SUM(IIF(e.tipo = [S], e.quantidade - e.qtd_retornada, 00000000000.0000)) saldo_saidas,;
	SUM(IIF(e.tipo = [S], (e.quantidade - e.qtd_retornada), -(e.quantidade - e.qtd_retornada))) AS saldo;
	FROM emprestimos e;
	inner JOIN tmp_produtos_lista l ON l.ID = e.id_produto;
	WHERE e.situacao = 0;
	AND INLIST(e.tipo,[E],[S]);
	AND e.trocado = 0 ;
	AND &amp;lcWhereLoja ;
	GROUP BY e.id_produto;
	INTO CURSOR curEmprestimos READWRITE

INDEX ON id_produto TAG "id_produto" ADDITIVE

ENDPROC
PROCEDURE carregarestoques
Private All Like l*

*thisform.CorrigeEstoqueComprado()

*!* Tiago   #24417  16/12/14: Criando indice temporário na tabela est_estoque que veio do banco de dados.
*!*	If Thisform.config41007 == 'Sim'
*!*		Select est_estoque
*!*		lcArqTmp = Addbs(oSistema.HOME_TMP) + Alltrim(Sys(2015)) + "_est"
*!*		Index On id_produto To (lcArqTmp) Collate "GENERAL"
*!*	Endif

*!* Tiago   #24417  30/12/14: Só faz se não estiver configurado para trabalhar no banco de dados
If This.config41007 == 'Não'
	Select est_estoque
	Set Order To id_produto   &amp;&amp; ID_PRODUTO
Endif

*Set Step On

*!* Tiago   #19979  28/04/14: Inserido as colunas est_min_5,est_ven_5,est_dis_5
*!* Percorre os produtos do pedido
*!* Eber    #73705  12/12/19: Inclusão dos campos de Estoque Físico e Disponível para Lojas 06 e 07
*!* Cristof #80704  10/09/20: Adicionado 15 colunas para os campos (minimo,ideal,fisico,diponivel)
Select tmp_produtos_lista
Replace est_minimo 		With 0, ;
	est_min_1 			With 0, ;
	est_min_2 			With 0, ;
	est_min_3 			With 0, ;
	est_min_4 			With 0, ;
	est_min_5 			With 0, ;
	est_min_6 			With 0, ;
	est_min_7 			With 0, ;
	est_min_8 			With 0, ;
	est_min_9 			With 0, ;
	est_min_10 			With 0, ;
	est_min_11			With 0, ;
	est_min_12 			With 0, ;
	est_min_13			With 0, ;
	est_min_14			With 0, ;	
	est_min_15			With 0, ;		
	Est_Ideal 			With 0, ;
	Est_Ideal_1 		With 0, ;
	Est_Ideal_2 		With 0, ;
	Est_Ideal_3 		With 0, ;
	Est_Ideal_4 		With 0, ;
	Est_Ideal_5 		With 0, ;
	Est_Ideal_6 		With 0, ;
	Est_Ideal_7 		With 0, ;
	Est_Ideal_8 		With 0, ;
	Est_Ideal_9 		With 0, ;	
	Est_Ideal_10 		With 0, ;
	Est_Ideal_11		With 0, ;
	Est_Ideal_12		With 0, ;
	Est_Ideal_13		With 0, ;
	Est_Ideal_14		With 0, ;	
	Est_Ideal_15		With 0, ;		
	est_venda 			With 0, ;
	est_ven_1 			With 0, ;
	est_ven_2 			With 0, ;
	est_ven_3 			With 0, ;
	est_ven_4 			With 0, ;
	est_ven_5 			With 0, ;
	est_ven_6 			With 0, ;
	est_ven_7 			With 0, ;
	est_ven_8 			With 0, ;
	est_ven_9 			With 0, ;
	est_ven_10 			With 0, ;
	est_ven_11 			With 0, ;
	est_ven_12 			With 0, ;
	est_ven_13			With 0, ;
	est_ven_14 			With 0, ;	
	est_ven_15 			With 0, ;		
	est_disponivel		With 0, ;
	est_dis_1 			With 0, ;
	est_dis_2 			With 0, ;
	est_dis_3 			With 0, ;
	est_dis_4 			With 0, ;
	est_dis_5 			With 0, ;
	est_dis_6 			With 0, ;
	est_dis_7 			With 0, ;
	est_dis_8 			With 0, ;
	est_dis_9 			With 0, ;
	est_dis_10 			With 0, ;
	est_dis_11			With 0, ;
	est_dis_12 			With 0, ;
	est_dis_13			With 0, ;
	est_dis_14 			With 0, ;	
	est_dis_15 			With 0, ;		
	est_pedido 			With 0, ;
	est_pedido1 		With 0, ;
	est_pedido2 		With 0, ;
	est_pedido3			With 0, ;
	est_mostruario 		With 0, ;
	est_terceiros 		With 0, ;
	est_defeito 		With 0, ;
	est_reservado 		With 0, ;
	est_transferir 		With 0, ;
	est_distribuidor 	With 0, ;
	vl_distribuidor		With 0, ;
	est_vendido3		With 0, ;
	est_vendido2		with 0, ;
	est_vendido1		with 0, ;
	est_vendido 		With 0 All
Scan

*!* Para cada produto, varre seus estoques...
*!* Tiago   #24417  30/12/14: Buscando o registro de estoque do produto no banco de dados
	If This.config41007 == 'Sim'
		This.oestoque.loadbyexpr('id_produto = '+sqlval(tmp_produtos_lista.Id))
		Select est_estoque
	Else
		Select est_estoque
		Set Key To tmp_produtos_lista.Id
	EndIf
	
					
	Scan				
		If Thisform.nIdloja = 0 Or (est_estoque.id_loja = Thisform.nIdloja)
			
*!* Cristof #93139  19/01/22: Ao calcular o estoque disponivel adicionado o campo "est_reservado" para diminuir do estoque fisico "est_venda"
			Select tmp_produtos_lista
			Replace est_minimo 		With est_minimo     + est_estoque.est_minimo, ;
				est_venda 			With est_venda      + est_estoque.est_venda, ;
				est_pedido 			With est_pedido     + est_estoque.est_pedido, ;
				est_mostruario 		With est_mostruario + est_estoque.est_mostruario, ;
				est_terceiros 		With est_terceiros  + est_estoque.est_terceiros, ;
				est_defeito 		With est_defeito    + est_estoque.est_defeito, ;
				est_reservado 		With est_reservado  + est_estoque.est_reservado, ;
				est_transferir 		With est_transferir + est_estoque.est_transferir , ;
				est_vendido 		With est_vendido    + est_estoque.est_vendido , ;
				est_disponivel 		With est_disponivel + est_estoque.est_venda - est_estoque.est_vendido - est_estoque.est_reservado, ;
				Est_Ideal			with Est_Ideal      + est_estoque.ponto_reposicao

		Endif

*!* Cristof #80704  14/09/20: Ao gravar o estoque (ideal,minimo,fisico,disponivel) no cursor "tmp_produtos_lista", é necessário buscar a coluna correspondente no cursor "curLojasAtivas"
lnIdColuna = 0
		If Seek(est_estoque.id_loja,"curLojasAtivas","id") and curLojasAtivas.id_coluna &lt;= 15
		   lnIdColuna = curLojasAtivas.id_coluna
		Else
		   Loop
		EndIf

		Select tmp_produtos_lista
		lcField = 'est_min_'		
	    lcField = lcField + Alltrim(Str(lnIdColuna))
		
		Try
			Replace &amp;lcField With est_estoque.est_minimo
		Catch To loErro
			loErro.Message = ""
		EndTry
		
		lcField = 'est_ven_'
		lcField = lcField + Alltrim(Str(lnIdColuna))
		Try
			Replace &amp;lcField With est_estoque.est_venda
		Catch To loErro
			loErro.Message = ""
		Endtry

*!* Cristof #93139  19/01/22: Ao calcular o estoque disponivel adicionado o campo "est_reservado" para diminuir do estoque fisico "est_venda"
		lcField = 'est_dis_'
		lcField = lcField + Alltrim(Str(lnIdColuna))
		Try
			Replace &amp;lcField With est_estoque.est_venda - est_estoque.est_vendido - est_estoque.est_reservado
		Catch To loErro
			loErro.Message = ""
		EndTry
		
		lcField = 'est_pedido'
		lcField = lcField + Alltrim(Str(est_estoque.id_loja))
		Try
			Replace &amp;lcField With est_estoque.est_pedido
		Catch To loErro
			loErro.Message = ""
		EndTry
		
		lcField = 'est_vendido'
		lcField = lcField + Alltrim(Str(est_estoque.id_loja))
		Try
			Replace &amp;lcField With est_estoque.est_vendido
		Catch To loErro
			loErro.Message = ""
		EndTry
		
		lcField = 'Est_Ideal_'
		lcField = lcField + Alltrim(Str(lnIdColuna))
		Try
			Replace &amp;lcField With est_estoque.ponto_reposicao
		Catch To loErro
			loErro.Message = ""
		Endtry


	Endscan
Endscan

*!*	Select est_tipos
*!*	Set Order To
*!* Tiago   #24417  30/12/14: Só faz se não estiver configurado para trabalhar no banco de dados
If This.config41007 == 'Não'
	Select est_estoque
	Set Order To
	Set Relation To
Endif

Select tmp_produtos_lista


*!* 10/07/2009 22:22:55   TERTEROLA # Juliano
*!*	Select est_tipos
*!*	Set Order To Id   &amp;&amp; ID

*!*	Select est_estoque
*!*	Set Order To ID_PRODUTO   &amp;&amp; ID_PRODUTO
*!*	Set Relation To id_tipo_estoque Into est_tipos

*!*	*!*	Thisform.CamposProd = [id, codigo,Nome, preco_compra, preco_venda, preco_custo, ]+;
*!*	*!*	   [ 0000000.00 as est_venda, ]+;
*!*	*!*	   [ 0000000.00 as est_pedido, ]+;
*!*	*!*	   [ 0000000.00 as est_minimo, ]+;
*!*	*!*	   [ -0000000001 as id_itempedido, ]+;
*!*	*!*	   [ 0000000.00 as est_mostruario, ]+;
*!*	*!*	   [ 0000000.00 as est_terceiros, ]+;
*!*	*!*	   [ 0000000.00 as est_defeito, ]+;
*!*	*!*	   [ 0000000.00 as est_reservado, ]+;
*!*	*!*	   [ 0000000.00 as est_vendido, ]+;
*!*	*!*	   [ 0000000.00 as pedido, ]+;
*!*	*!*	   [ 0000000.00 as estoque_medio, ]+;
*!*	*!*	   [ 000000.00 as venda_media, ]+;
*!*	*!*	   [ ultima_compra, ultima_venda,id_forn1,qtd_embalagem, peso ]


*!*	*!* Percorre os produtos do pedido
*!*	Select tmp_produtos_lista
*!*	Scan
*!*	   *!* Para cada produto, varre seus estoques...
*!*	   Select est_estoque
*!*	   Set Key To tmp_produtos_lista.Id
*!*	   Scan
*!*	      If Thisform.nIdloja = 0 Or (est_estoque.id_loja = Thisform.nIdloja)
*!*	         lcField = Upper(Alltrim(est_tipos.campo_old))
*!*	         Select tmp_produtos_lista
*!*	         Replace &amp;lcField With &amp;lcField + est_estoque.quantidade
*!*	         Do Case
*!*	            Case lcField = 'EST_MINIMO'
*!*	               lcField = 'est_min_'
*!*	            Case lcField = 'EST_VENDA'
*!*	               lcField = 'est_ven_'
*!*	            Otherwise
*!*	               lcField = ''
*!*	         Endcase
*!*	         If !Isblank(lcField )
*!*	            lcField = lcField + Alltrim(Str(est_estoque.id_tipo_estoque))
*!*	            Try
*!*	               Replace &amp;lcField With est_estoque.quantidade
*!*	            Catch To loErro
*!*	               loErro.Message = ""
*!*	            Endtry
*!*	         Endif
*!*	      Endif
*!*	   Endscan

*!*	Endscan

*!*	Select est_tipos
*!*	Set Order To

*!*	Select est_estoque
*!*	Set Order To
*!*	Set Relation To

*!*	Select tmp_produtos_lista
*!*	*Browse


ENDPROC
PROCEDURE carregarlojasativas
Private All Like l*

*!* Cristof #80704  11/09/20: Responsavel por criar o cursor "curLojasAtivas", que vai armazenar a lojas ativas com as colunas correspodentes no grid (ideal,minimo,disponivel,fisico), pelo campo "id_coluna"
Use osistema.Home+"empresas" In 0 Alias empresas_lojas Again
Select *, 0000 as id_coluna from empresas_lojas where ativo = 1 order by id asc into cursor curLojasAtivas READWRITE
Use in empresas_lojas

lcContador = 0
Select curLojasAtivas
Scan
lcContador = lcContador + 1
replace id_coluna with lcContador
EndScan


Select curLojasAtivas
Index on id tag "id" ADDITIVE
Index on id_coluna tag "id_coluna" ADDITIVE


ENDPROC
PROCEDURE corrigeestoquecomprado
Set Message To 'Processando análise...'

If !Used('est_estoque')
	Use est_estoque In 0
Endif
If !Used('pedidos')
	Use pedidos In 0
Endif
If !Used('pedidos_itens')
	Use pedidos_itens In 0
Endif

*!*	Select tmp_produtos_lista
*!*	Scan
*!*	   Select est_estoque
*!*	   Replace est_transferir With 0, est_pedido With 0 For id_produto = tmp_produtos_lista.Id
*!*	Endscan
*!* Matheus #62384  30/01/19: Novo where para caso a config esteja "Sim" (Completo).
If buscarconfig('40059')  = 'Não'
lcWherePedido = 'p.situacao = [Pendente]'
Else
lcWherePedido = 'inlist(p.situacao,[Confirmado],[Pago].[NF Emitida],[Em Trânsito])'
Endif

Select Pi.id_produto, p.id_loja, Sum(Iif(p.id_transf=0,Pi.qtd_pedido,0000000000.0000)) As qtd_pedido, ;
	Sum(Iif(p.id_transf&gt;0,Pi.qtd_pedido,0000000000.0000)) As qtd_transf ;
	from pedidos_itens Pi ;
	left Join pedidos p On Pi.id_pedido = p.Id ;
	where &amp;LcWherePedido Group By Pi.id_produto,p.id_loja ;
	into Cursor tmpEstoquesPendentes Readwrite

lcIdx = Sys(2015)
Select est_estoque
Index On Str(id_produto)+Str(id_loja) To &amp;lcIdx

Set Message To 'Processando análise... ...'
lcComandoEstoque = ''
Select tmpEstoquesPendentes
Scan
*!* Tiago   #24417  17/12/14: Atualizando estoque no banco de dados.
	If Thisform.config41007 == 'Sim'
		If !Thisform.oestoque.executeSQL([SELECT criaestoque(]+sqlval(tmpEstoquesPendentes.id_produto)+;
				[,]+sqlval(tmpEstoquesPendentes.id_loja)+[,'est_venda',0]+[)])
			Return .F.
		Else
			If !Thisform.oestoque.executeSQL('UPDATE est_transferir SET est_transferir = '+sqlval(tmpEstoquesPendentes.qtd_transf)+;
					', est_pedido = '+sqlval(tmpEstoquesPendentes.qtd_pedido))
				Return .F.
			Endif
		Endif
	Else
		Select est_estoque
		Seek Str(tmpEstoquesPendentes.id_produto)+Str(tmpEstoquesPendentes.id_loja)
*   Locate For id_produto = tmpEstoquesPendentes.id_produto And id_loja = tmpEstoquesPendentes.id_loja
		If !Found()
			Append Blank
			Replace id_produto With tmpEstoquesPendentes.id_produto
			Replace id_loja With tmpEstoquesPendentes.id_loja
		Endif
		Replace est_transferir With tmpEstoquesPendentes.qtd_transf
		Replace est_pedido     With tmpEstoquesPendentes.qtd_pedido
	Endif
Endscan

Select est_estoque
Set Order To
Flush
*!*	lcIdx = lcIdx + '.idx'
*!*	If File(lcIdx)
*!*	   Use Dbf()
*!*	   Delete File &amp;lcIdx
*!*	Endif

Wait Clear
Set Message To

Return

ENDPROC
PROCEDURE criarcursorhistoricocompravenda
Local lcFiltroLojaMov, lcReplace, lcSalva, lcFiltroTipos, lcTiposCancalado, lcTiposCompra
Local lcTiposVenda, ldFinal, ldInicial, ldHoje, lnMes, lnOldArea

lnOldArea = Select()

Mensagem('Processando históricos de compra e venda...')

ldHoje    = oSistema.Hoje
ldInicial = PrimeiroDiaDoMes(Gomonth(ldHoje, -11))
ldFinal   = UltimoDiaDoMes(ldHoje)

If Thisform.PageFrame.Page1.opgLoja.Value = 1
lcFiltroLojaMov = " Id_Loja " + Iif(Thisform.nIdLoja = 0, '&gt; 0', '= ' + Transform(Thisform.nIdLoja))
Else
lcFiltroLojaMov = " Id_Loja_S " + Iif(Thisform.nIdLoja = 0, '&gt; 0', '= ' + Transform(Thisform.nIdLoja))
Endif

If Thisform.config41007 == 'Sim'
	*!* Matheus #93632  10/02/22: Reajustado filtro de tipo para POST...
	If oSistema.alternativo
		lcTiposCompra = ['CO','PC']
		lcTiposVenda  = ['VE','PV','TC']
		lcTipoCancelado = ['CV','DV']
	Else
		lcTiposCompra = ['CO']
		lcTiposVenda  = ['VE']
		lcTipoCancelado = ['CV']
	EndIf
	
	lcFiltroMov = ''
	lcFiltroTipos   = " Tipo in(" + lcTiposCompra + "," + lcTiposVenda + "," + lcTipoCancelado + [,'NF','CN')]
	lcFiltroMov = lcFiltroMov +[Data Between ']+Transform(ldInicial)+[' AND ']+Transform(ldFinal)+[' AND ]+lcFiltroLojaMov +' AND '+lcFiltroTipos
	Thisform.omovimento.loadbyexpr((lcFiltroMov))

	Select * From est_movimento Where id_produto In (Select Id From curListaProd) Into Cursor tmpMovimento Readwrite
Else
	*!* Matheus #93632  10/02/22: Transferido tipos para depois do else, para ser usado dessa maneira apenas qnd a pesquisa nao for no post.
	If oSistema.Alternativo
		lcTiposCompra = "CO-PC"
		lcTiposVenda  = "VE-PV-TC"
		lcTipoCancelado = 'CV-DV'
	Else
		lcTiposCompra = "CO"
		lcTiposVenda  = "VE"
		lcTipoCancelado = 'CV'
	Endif


	lcFiltroTipos   = " Tipo $ '" + lcTiposCompra + "-" + lcTiposVenda + "-" + lcTipoCancelado + "-NF-CN'"

	Select * From est_movimento;
		Where id_produto In (Select Id From curListaProd) And Between(Data, ldInicial, ldFinal) And &amp;lcFiltroLojaMov. And &amp;lcFiltroTipos.;
		Into Cursor tmpMovimento;
		Readwrite
Endif


Index On id_produto Tag PRO
Index On Data       Tag DAT Additive
Index On Deleted()  Tag DEL Additive
Set Order To 1

Zap In curHistoCompraVenda
*!* Carlos  #56513  26/03/18: Limpado filtro para carregar novamente o cursor caso já tenha sido feita uma pesquisa inicial.
Set Filter To in curHistoCompraVenda

Select Id From curListaProd Into Cursor curTmpProdutos
Select curTmpProdutos
Scan
For lnMes = 0 To -11 Step -1

ldInicial = PrimeiroDiaDoMes(Gomonth(ldHoje, lnMes))
ldFinal   = UltimoDiaDoMes(ldInicial)

If lnMes = 0
Select curHistoCompraVenda
Append Blank
Replace Id        With curTmpProdutos.Id,;
Movimento With 'Compras'
Append Blank
Replace Id        With curTmpProdutos.Id,;
Movimento With 'Vendas'
Endif
	
	  lnIdProd = curTmpProdutos.Id

Select Sum(Iif(Tipo $ lcTiposCompra, Qtd, 0000000.00)) As QtdComprada,;
Sum(Iif(Tipo $ lcTiposVenda Or (Tipo = 'CN' And tipo_es = 'S'), Qtd, Iif(Tipo $ lcTipoCancelado Or (Tipo = 'NF' And tipo_es = 'E' And id_cliente &gt; 0),-Qtd,0000000000.00))) As QtdVendida ;
From tmpMovimento;
Where id_produto = curTmpProdutos.Id And Between(Data, ldInicial, ldFinal) And Estoque = "DISPONIVEL";
Into Cursor curTmpQuantidades

If Reccount() &gt; 0
lcSalva = "Replace Mes" + Padl(Transform(Abs(lnMes) + 1), 2, '0') + " With "
=Seek(Padl(curTmpProdutos.Id, 10) + "Compras", 'curHistoCompraVenda', 'ID')
lcReplace = lcSalva + Strtran(Transform(curTmpQuantidades.QtdComprada), ',', '.') + " In curHistoCompraVenda"
&amp;lcReplace.
=Seek(Padl(curTmpProdutos.Id, 10) + "Vendas", 'curHistoCompraVenda', 'ID')
lcReplace = lcSalva + Strtran(Transform(curTmpQuantidades.QtdVendida), ',', '.') + " In curHistoCompraVenda"
&amp;lcReplace.
Endif

Next
Endscan

If Used('curTmpProdutos')
Use In curTmpProdutos
Endif
If Used('curTmpQuantidades')
Use In curTmpQuantidades
Endif

LimparMensagem()
Select (lnOldArea)

ENDPROC
PROCEDURE criarxmlcompra
Lparameters lcCampoPedido

Local lnOldArea
lnOldArea = Select()

*!* Raul    #30307  12/06/15: Não existindo itens para o pedido, não retorna nada
Select curListaProd
Locate For &amp;lcCampoPedido. &gt; 0
If ! Found()
Select (lnOldArea)
Return ""
EndIf

If !Used('Cur_itens')
Select * From pedidos_itens Where Id = 0 Into Cursor cur_itens Readwrite
Endif
Select cur_itens
Go Top
If Eof()
Append Blank
Endif

*!* Gabriel #46282  18/04/17: Adicionado campo PESO para ser levado junto com o pedido.
Select curListaProd
Index On Nome Tag Nome
Scan For &amp;lcCampoPedido &gt; 0
Select cur_itens
Replace Id With curListaProd.id_itempedido, ;
id_produto With curListaProd.Id, ;
codigo With curListaProd.codigo, ;
descricao With curListaProd.Nome, ;
qtd_pedido With curListaProd.&amp;lcCampoPedido, ;
qtd_recebida With 0, ;
pr_custo With curListaProd.preco_compra, ;
peso With curListaProd.peso, ;
pr_negociado With curListaProd.preco_compra
Skip
If Eof()
Append Blank
Endif
Endscan
Select cur_itens
Do While!Eof()
Scatter Blank To vetReg
Gather From vetReg
Skip
Enddo
Go Top
lcXMLTemp = ''

Cursortoxml('cur_itens','lcXMLTemp',1,0,0,"1")

Return lcXMLTemp
ENDPROC
PROCEDURE diplaydadoscomplementares_historiccompravenda
ThisForm.LockScreen = .T.

With ThisForm.PageFrame.Page2

If ThisForm.lVisualizarHistoricosCompraVenda
.cmdHistoricoCompraVenda.Caption = "I\&lt;nf. Complementares"
ThisForm.GerarCaptionGridHistoricoCompraVenda()
Else
.cmdHistoricoCompraVenda.Caption = "\&lt;Histórico Compra/Venda"
EndIf

.shpHistoCompraVenda.Visible     = ThisForm.lVisualizarHistoricosCompraVenda
.lblHistoCompraVenda.Visible     = ThisForm.lVisualizarHistoricosCompraVenda
.grdHistoricoCompraVenda.Visible = ThisForm.lVisualizarHistoricosCompraVenda

.shape_1.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.shape_2.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.shape_3.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.shape_4.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.shape_5.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)

.Label_Shape1.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_Shape2.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_Shape3.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_Shape4.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_Shape5.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)

.Label_1.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_2.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_3.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_4.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_5.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_6.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_7.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_8.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_9.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_10.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_11.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_12.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_13.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_14.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.Label_15.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)

*!* Cristof #69129  28/06/19: Adicionado label "Litragem Total"
.Label_21.VIsible = (! ThisForm.lVisualizarHistoricosCompraVenda)

.spnIndice.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)

.cmdAplicar.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.cmdDesfaz.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)

*!* Matheus #60039  17/08/18: Acrescentado o "txtQtdEmbalagem02 e label_20.
.txtCompraFor.Visible     = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtVendaFor.Visible      = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtPedMinimo.Visible     = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtFretes.Visible        = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtUltCompra.Visible     = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtUltVenda.Visible      = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtEstMedio.Visible      = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtQtdEmbalagem.Visible  = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtQtdEmbalagem02.Visible= ( ThisForm.lVisualizarHistoricosCompraVenda)
.label_20.visible 		 = ( ThisForm.lVisualizarHistoricosCompraVenda)
.txtEstCompra.Visible     = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtEstVenda.Visible      = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtEstMinCusto.Visible   = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtTotal.Visible         = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtTotalPreCusto.Visible = (! ThisForm.lVisualizarHistoricosCompraVenda)
.txtPesoTotal.Visible     = (! ThisForm.lVisualizarHistoricosCompraVenda)

*!* Cristof #69129  28/06/19: Adicionado label para receber o total de Litragem
.txtLitragem.Visible      = (! ThisForm.lVisualizarHistoricosCompraVenda)

EndWith

ThisForm.LockScreen = .F.
ENDPROC
PROCEDURE gerarcaptiongridhistoricocompravenda
Local lcColuna, lcMeses, ldData, lnColuna

lcMeses = "JANFEVMARABRMAIJUNJULAGOSETOUTNOVDEZ"

With ThisForm.PageFrame.Page2.grdHistoricoCompraVenda

For lnColuna = 2 To 13
ldData = GoMonth(oSistema.Hoje, (lnColuna - 2) * -1)
lcColuna = ".InteliColumn" + Transform(lnColuna) + ".InteliHeader1.Caption = '" + Substr(lcMeses, (Month(ldData) * 3) - 2, 3) + "/" + Transform(Year(ldData)) + "'"
&amp;lcColuna.
Next

EndWith

ENDPROC
PROCEDURE historico
*!* 29/05/2009 18:00:28   TERTEROLA # Juliano
*!* Iniciados os ajustes para trabalhar com multilojas.


ENDPROC
PROCEDURE informacoescomplementares_historicocompravenda
With ThisForm.PageFrame.Page2
If ThisForm.lVisualizarHistoricosCompraVenda
If ThisForm.lCriaNovoHistorico
.grdHistoricoCompraVenda.SalvarControlSource()
ThisForm.CriarCursorHistoricoCompraVenda()
.grdHistoricoCompraVenda.RecuperarControlSource()
ThisForm.lCriaNovoHistorico = .F.
EndIf
Set Filter To Id = curListaProd.Id In curHistoCompraVenda
Go Top In curHistoCompraVenda
.grdHistoricoCompraVenda.Refresh()
Else
*!* Matheus #60039  17/08/18: Acrescentado o "txtQtdEmbalagem02.
.txtCompraFor.Refresh()
.txtVendaFor.Refresh()
.txtPedMinimo.Refresh()
.txtFretes.Refresh()
.txtUltCompra.Refresh()
.txtUltVenda.Refresh()
.txtEstMedio.Refresh()
.txtQtdEmbalagem02.Refresh()
.txtQtdEmbalagem.Refresh()
.txtEstCompra.Refresh()
.txtEstVenda.Refresh()
.txtEstMinCusto.Refresh()
.txtTotal.Refresh()
.txtTotalPreCusto.Refresh()
.txtPesoTotal.Refresh()
.txtLitragem.Refresh()
EndIf
EndWith

ENDPROC
PROCEDURE Init
Lparameters tnIdFornec, tcXmlItens, tcOrdenadoPor, tlUtilizaPedidosDuasLojas

If oSistema.Debug
*!*	tnIdFornec = 65
*!*	tcXmlItens = ''
Endif

*!* Raul    #19426  02/04/14: Criado novo parâmetro para receber o campo de ordenação
Thisform.cOrdenadoPor = Iif(Vartype(tcOrdenadoPor) = 'C' And Upper(Alltrim(tcOrdenadoPor)) = 'ORDEM_ESTOCAGEM', 'ORDEM_ESTOCAGEM', '')

Thisform.cselcodigoinicial = []
Thisform.cselcodigofinal = []

Thisform.Tag = 'x' &amp;&amp;Flag para nao executar o setfocus no grid no activate do form

* Config 40027: Permissão para criar pedido com quantidades fora da embalagem.
If BuscarConfig('40027') ='Não'
Thisform.PageFrame.page2.checkbox_2.Value = .T.
Else
Thisform.PageFrame.page2.checkbox_2.Value = .F.
Endif


If BuscarConfig('41007') = 'Não'
Thisform.chkVendas_ultimos_4_meses.Visible = .T.
Else
thisform.pageFrame.page1.opganalise.optionbutton_5.Visible = .F.
thisform.pageFrame.page1.opganalise.option2.Top = thisform.pageFrame.page1.opganalise.option2.Top - 20
thisform.pageFrame.page1.opganalise.optionbutton_3.Top = thisform.pageFrame.page1.opganalise.optionbutton_3.Top - 20
thisform.pageFrame.page1.opganalise.optionbutton_4.Top = thisform.pageFrame.page1.opganalise.optionbutton_4.Top - 20
Endif

*!* Tiago   #27723  24/04/15: Carregando informação
This.utilizapedidoduaslojas = tlUtilizaPedidosDuasLojas

*!* Raul    #19426  03/04/14: A primeira coluna passa a ser a ordem de estocagem
*!*                           Esta coluna somente será visível caso o parâmetro tcOrdenadoPor for "Ordem_Estocagem"
If Thisform.cOrdenadoPor = "ORDEM_ESTOCAGEM"
Thisform.PageFrame.page2.GridOrder1.Intelicolumn36.Visible = .T.
Else
Thisform.PageFrame.page2.GridOrder1.Intelicolumn36.Visible = .F.
Endif

*!* Tiago   #27723  24/04/15: Se a config estiver false, desabilita as colunas de pedido 2 e venda media 2.
*!* Carlos  #56344  23/04/18: Adicionado validação para ocultar as colubas de pedido 3 e venda media 3.
If !This.utilizapedidoduaslojas
This.PageFrame.page2.GridOrder1.intelicolumn39.Visible = .F.
This.PageFrame.page2.GridOrder1.intelicolumn40.Visible = .F.
This.PageFrame.page2.GridOrder1.intelicolumn52.Visible = .F.
This.PageFrame.page2.GridOrder1.intelicolumn53.Visible = .F.
Endif

Do Case
Case Vartype(tcXmlItens)='C'
If !Empty(tcXmlItens)
Xmltocursor(tcXmlItens,'cur_itens')
This.WindowType = 1
EndIf
Case Vartype(tcXmlItens)='N'
Thisform.nIdLoja = tcXmlItens
Thisform.PageFrame.page2.cmdsalvar1.Caption = ' \&lt;Gerar pedido'
Thisform.PageFrame.page2.cmdsalvar2.Enabled = .T.
Thisform.lGerarpedido = .T.

Otherwise
Thisform.PageFrame.page2.cmdsalvar1.Caption = ' \&lt;Gerar pedido'
Thisform.PageFrame.page2.cmdsalvar2.Enabled = .T.
Thisform.lGerarpedido = .T.
Thisform.nIdLoja = oempresa.Id
Endcase

*!*	If Vartype(tnIdFornec)='L'
*!*	   tnIdFornec = 65
*!*	Endif
*tnIdSession = 2
*!*	If Vartype(tnIdSession)&lt;&gt;'L'
*!*	   Set DataSession To tnIdSession
*!*	Endif

Thisform.CamposProd = [id, codigo,Nome, preco_compra, preco_venda, preco_custo, ]+;
[ est_venda, est_pedido, est_minimo, -0000000001 as id_itempedido, ]+;
[ est_mostruario, est_terceiros, est_defeito, est_reservado,est_vendido,]+;
[ 0000000.00 as pedido, 0000000.00 as estoque_medio, 000000.00 as venda_media, ]+;
[ 000000.00 as est_distribuidor, 000000.00 as vl_distribuidor, ]+;
[ ultima_compra, ultima_venda,id_forn1,qtd_embalagem, peso, cod_distri, ] +;
[ Space(100) as nome_distri,Space(10) as unidade,0000000.00 as est_pedi_distr,Space(10) as un, 0000000000 as promo]


*!* Tiago   #19979  28/04/14: Inserido as colunas est_ven_5 e est_dis_5.;
Criado as colunas coldisp05 e colFisi05 na grid para exibir esses valores.
*!* Lucas   #19032  25/04/14: Adiciona o campo 'Flags da tabela produtos'


*!* Cristof #69129  05/06/19: Adicionado o volume das unidades para calcular a litragem
*!* Cristof #80704  10/09/20: Adicionado 15 colunas para os campos (minimo,ideal,fisico,diponivel)
Thisform.CamposProd = [Ordem_Estocagem, id, codigo,Nome, preco_compra, preco_venda, preco_custo,id_unidade,id_grupo, ]+;
[ 0000000.00 as est_venda, ]+;
[ 0000000.00 as est_ven_1, ]+;
[ 0000000.00 as est_ven_2, ]+;
[ 0000000.00 as est_ven_3, ]+;
[ 0000000.00 as est_ven_4, ]+;
[ 0000000.00 as est_ven_5, ]+;
[ 0000000.00 as est_ven_6, ]+; &amp;&amp; Eber    #73705  11/12/19: Estoque Físico Loja 06
[ 0000000.00 as est_ven_7, ]+; &amp;&amp; Eber    #73705  11/12/19: Estoque Físico Loja 07
[ 0000000.00 as est_ven_8, ]+;
[ 0000000.00 as est_ven_9, ]+;
[ 0000000.00 as est_ven_10, ]+;
[ 0000000.00 as est_ven_11, ]+;
[ 0000000.00 as est_ven_12, ]+;
[ 0000000.00 as est_ven_13, ]+;
[ 0000000.00 as est_ven_14, ]+;
[ 0000000.00 as est_ven_15, ]+;
[ 0000000.00 as est_pedido, ]+;
[ 0000000.0000 as est_pedido1, ]+;
[ 0000000.0000 as est_pedido2, ]+; &amp;&amp; Tiago   #27723  24/04/15: Inserido campo para guardar a qtd do pedido para loja 2
[ 0000000.0000 as est_pedido3, ]+; &amp;&amp; Carlos  #56344  26/03/18: Inserido campo para guardar a qtd do pedido para loja 3
[ 0000000.00 as est_min_1, ]+;
[ 0000000.00 as est_min_2, ]+;
[ 0000000.00 as est_min_3, ]+;
[ 0000000.00 as est_min_4, ]+;
[ 0000000.00 as est_min_5, ]+;
[ 0000000.00 as est_min_6, ]+;
[ 0000000.00 as est_min_7, ]+;
[ 0000000.00 as est_min_8, ]+;
[ 0000000.00 as est_min_9, ]+;
[ 0000000.00 as est_min_10, ]+;
[ 0000000.00 as est_min_11, ]+;
[ 0000000.00 as est_min_12, ]+;
[ 0000000.00 as est_min_13, ]+;
[ 0000000.00 as est_min_14, ]+;
[ 0000000.00 as est_min_15, ]+;
[ 0000000.00 as est_minimo, ]+;
[ 0000000.00 as Est_Ideal, ]+;
[ 0000000.00 as Est_Ideal_1, ]+;
[ 0000000.00 as Est_Ideal_2, ]+;
[ 0000000.00 as Est_Ideal_3, ]+;
[ 0000000.00 as Est_Ideal_4, ]+;
[ 0000000.00 as Est_Ideal_5, ]+;
[ 0000000.00 as Est_Ideal_6, ]+;
[ 0000000.00 as Est_Ideal_7, ]+;
[ 0000000.00 as Est_Ideal_8, ]+;
[ 0000000.00 as Est_Ideal_9, ]+;
[ 0000000.00 as Est_Ideal_10, ]+;
[ 0000000.00 as Est_Ideal_11, ]+;
[ 0000000.00 as Est_Ideal_12, ]+;
[ 0000000.00 as Est_Ideal_13, ]+;
[ 0000000.00 as Est_Ideal_14, ]+;
[ 0000000.00 as Est_Ideal_15, ]+;
[ 0000000.00 as est_transferir, ]+;
[ -0000000001 as id_itempedido, ]+;
[ 0000000.00 as est_mostruario, ]+;
[ 0000000.00 as est_terceiros, ]+;
[ 0000000.00 as est_defeito, ]+;
[ 0000000.00 as est_reservado, ]+;
[ 0000000.00 as est_vendido, ]+;
[ 0000000.00 as est_vendido1, ]+;
[ 0000000.00 as est_vendido2, ]+;
[ 0000000.00 as est_vendido3, ]+;
[ 0000000.00 as est_disponivel, ]+;
[ 0000000.00 as est_dis_1, ]+;
[ 0000000.00 as est_dis_2, ]+;
[ 0000000.00 as est_dis_3, ]+;
[ 0000000.00 as est_dis_4, ]+;
[ 0000000.00 as est_dis_5, ]+;
[ 0000000.00 as est_dis_6, ]+; &amp;&amp; Eber    #73705  11/12/19: Estoque Disponível Loja 06
[ 0000000.00 as est_dis_7, ]+; &amp;&amp; Eber    #73705  11/12/19: Estoque Disponível Loja 07
[ 0000000.00 as est_dis_8, ]+;
[ 0000000.00 as est_dis_9, ]+;
[ 0000000.00 as est_dis_10, ]+;
[ 0000000.00 as est_dis_11, ]+;
[ 0000000.00 as est_dis_12, ]+;
[ 0000000.00 as est_dis_13, ]+;
[ 0000000.00 as est_dis_14, ]+;
[ 0000000.00 as est_dis_15, ]+;
[ 0000000.0000 as pedido, ]+; &amp;&amp; Tiago   #12382  11/06/13: Aumentado para 4 casas decimais.
[ 0000000.0000 as pedido1, ]+;
[ 0000000.0000 as pedido2, ]+; &amp;&amp; Tiago   #27723  24/04/15: Inserido campo para guardar a qtd do pedido para loja 2
[ 0000000.0000 as pedido3, ]+; &amp;&amp; Carlos  #56344  26/03/18: Inserido campo para guardar a qtd do pedido para loja 3
[ 0000000.00 as estoque_medio, ]+;
[ 000000.00 as venda_media, ]+;
[ 000000.00 as venda_media2, ]+; &amp;&amp; Tiago   #27723  24/04/15: Inserido campo para guardar a venda média da loja 2
[ 000000.00 as venda_media3, ]+; &amp;&amp; Carlos  #56344  26/03/18: Inserido campo para guardar a venda média da loja 3
[ 000000.00 as est_distribuidor, ]+;
[ 000000.00 as vl_distribuidor, ]+;
[ Space(100) as nome_distri, ]+;
[ Space(10) as unidade, ]+;
[ 000000.00 as est_pedi_distr, ]+;
[ ultima_compra,Cod_ref,]+;
[ Space(100) as grupo_produto,]+; &amp;&amp;Matheus  #94384   29/03/2022: Incluido grupo de produtos
[ ultima_venda,id_forn1,qtd_embalagem, peso, ] +;
[ cod_distri, ' ' as flag_sel,Space(10) as unidMedi, flags, Id_Vinculo_Est, ] +; &amp;&amp; *!* Raul    #19798  17/07/14: Incluido o campo Id_Vinculo_Est
[ Encomenda, ] +;  &amp;&amp; *!* Raul    #37623  09/09/16: Incluido o campo Encomenda
[ Est_Terceiros As EstoqueRD, ]+; &amp;&amp; *!* Raul    #39874  19/10/16: Incluido o campo est_terceiros
[ 0000000.00 as qtd_vendas_m1,]+; &amp;&amp;*!* Carlos  #32205  31/10/2016: Mostrar a quantidade vendida dos últimos 4 meses
[ 0000000.00 as qtd_vendas_m2,]+;
[ 0000000.00 as qtd_vendas_m3,]+;
[ 0000000.00 as qtd_vendas_m4,]+;
[ 0000000.00 as volume, 0000000000 as promo,]+; &amp;&amp; Cristof #69129  04/06/19: Adicionado o volume das unidades para calcular a litragem
[ 0000000.00 as totalPedido, ]+; &amp;&amp; Matheus #72517  28/01/20: Totalizador da coluna pedido 1 pedido 2 e pedido 3.
[ 0000000.00 as saldo_emprestimo, ]+; &amp;&amp; Gabriel #82923  31/03/21: Total de saldo de emprestimos para outras lojas
[ 'teste' as teste]

lcCampos = Thisform.CamposProd
Select &amp;lcCampos ;
From produtos Where Id &lt; 0 ;
Into Cursor curListaProd Readwrite

Thisform.BindControls =.T.


*!* Cristof #82923  19/04/21: Iniciar coluna "Saldo Emprestimo" de forma oculta
Thisform.PageFrame.page2.gridorder1.intelicolumn95.Visible = .F.


DoDefault()

If Vartype(tnIdFornec)&lt;&gt;'L'
If tnIdFornec &gt; 0
Thisform.PageFrame.page1.selfornec.setarregistro(tnIdFornec)
Endif
Endif
*This.buscarprodutos(.T.)
*Thisform.calculartotal()
Thisform.PageFrame.page1.selfornec.txtsEEK.SetFocus
Thisform.PageFrame.page1.cbolojas1.InteractiveChange

If curListaProd.Id &gt; 0
Thisform.PageFrame.page2.cmdestoquelote.Enabled = .T.
Else
Thisform.PageFrame.page2.cmdestoquelote.Enabled = .F.
Endif


*!* Cristof #80704  14/09/20: Chamada ao método "CarregarLojasAtivas()", para gerar o cursor "curLojasAtivas" que vai servir para montar as colunas (ideal,minimo,fisico,disponivel)
thisform.CarregarLojasAtivas()

*!* Cristof #80704  14/09/20: Chamada ao método "MostrarNomeLoja()", que vai servir para montar nomear as colunas (ideal,minimo,fisico,disponivel)
thisform.MostrarNomeLoja()


*!*	If BuscarConfig('19000') = "Sim"
*!*	   Thisform.PageFrame.page2.GridOrder1.InteliColumn47.Visible = .T.
*!*	Else
*!*	   Thisform.PageFrame.page2.GridOrder1.InteliColumn47.Visible = .F.
*!*	Endif

*!* Cristof #77000  02/06/20: Avisar que a tarefa agendada 'SINCRONIZAR_ESTOQUE_REDEMAC' esta sem rodar a mais de uma hora
* VerificarSincronizacao_Tarefas(tcTarefa, tnMinutos)
lcMensagemRetorno = VerificarSincronizacao_Tarefas('SINCRONIZAR_ESTOQUE_REDEMAC', 60)
Do case
Case lcMensagemRetorno = "A tarefa não roda a mais de uma hora e está sem erros."
MessageBox("Atenção: Os estoques da Redemac Distribuidora estão desatualizados em sua base. Entre em contato com a Boreo para verificar a situação.",64,"Informação")
Case lcMensagemRetorno = "A tarefa não roda a mais de uma hora e está com erros."
MessageBox("Atenção: Ocorreu um problema ao atualizar os dados de estoque da Redemac Distribuidora na sua base. Entre em contato com a Boreo para verificar a situação.",64,"Informação")
Case lcMensagemRetorno = "A tarefa está com erros."
MessageBox("Atenção: Ocorreu um problema ao atualizar os dados de estoque da Redemac Distribuidora na sua base. Entre em contato com a Boreo para verificar a situação.",64,"Informação")
EndCase


ENDPROC
PROCEDURE Load
If ! DoDefault()
	Return
Endif

* this.dbc.opendbtable('est_tipos')
this.dbc.opendbtable('caixa_cliente')
*!* Tiago   #24417  16/12/14: Abrindo tabela estoque e movimento do banco de dados.
Thisform.config41007 = buscarconfig('41007')

If This.config41007 == 'Sim'
	This.oestoque = Createobject([CABUILDER])
	This.oestoque.setuptable('est_estoque')
	This.oestoque.loadempty()
	
	This.omovimento = Createobject([CABUILDER])
	This.omovimento.setuptable('est_movimento')
	This.omovimento.loadempty()
Else
	This.Dbc.opendbtable('est_estoque')
	This.Dbc.opendbtable('est_movimento')
Endif

This.Dbc.opendbtable('est_remoto')
This.Dbc.opendbtable('ven_promocoes_itens')
This.Dbc.opendbtable('ven_promocoes')

*!* Raul    #19426  03/04/14: Criado o cursor com os meses que serão processados nos históricos de compra e venda
Create Cursor curHistoCompraVenda (Id I, Movimento C(7), Mes01 N(14,2), Mes02 N(14,2), Mes03 N(14,2), Mes04 N(14,2), Mes05 N(14,2),;
	Mes06 N(14,2), Mes07 N(14,2), Mes08 N(14,2), Mes09 N(14,2), Mes10 N(14,2), Mes11 N(14,2), Mes12 N(14,2))
Index On Padl(Id, 10) + Movimento Tag Id
Index On Deleted() Tag DEL Additive
Set Order To 1

*!* Raul    #21531  08/07/14: Este cursor não está mais sendo utilizado
*!*	*!* Raul    #19426  03/04/14: Para o controle de locais de estocagem é necessário o cursor de estoques
*!*	Select Est.*, e.NomeLogin, LocExp.Codigo As Exposicao, LocEst.Codigo As Estocagem;
*!*		From Est_Estoque As Est;
*!*		Left Join Empresas As e On e.Id = Est.Id_Loja;
*!*		Left Join Locais As LocExp On LocExp.Id = Est.Id_LocalExp;
*!*		Left Join Locais As LocEst On LocEst.Id = Est.Id_LocalEst;
*!*		Where Est.Id_Loja &gt; 0;
*!*		Into Cursor curEstoques;
*!*		Readwrite

ENDPROC
PROCEDURE mostrarnomeloja
Private All Like l*

*!* Cristof #80704  10/09/20: Responsavel por colocar no nome da loja nas colunas de estoque expansivel (ideal,minimo,fisico,disponivel)

* Config 90002: Quantidade de estoques a gerenciar (lojas).
lnQtdEstoque = BuscarConfig('90002') &amp;&amp;Qtd lojas

For lnI = 1 to 15
If lnQtdEstoque &gt;= lnI and Seek(lnI,"curLojasAtivas","id_coluna")
lcComando = "Thisform.PageFrame.page2.gridorder1.colMin"+Padl(lnI,2,"0")+".Controls[1].Caption = "+;
"'Mínimo' + Chr(13) + '" + Alltrim(curLojasAtivas.nomelogin) + "'"
&amp;lcComando
lcComando = "Thisform.PageFrame.page2.gridorder1.col_ideal"+Transform(lnI)+".Controls[1].Caption = "+;
"'Ideal' + Chr(13) + '" + Alltrim(curLojasAtivas.nomelogin) + "'"
&amp;lcComando
lcComando = "Thisform.PageFrame.page2.gridorder1.coldisp"+Padl(lnI,2,"0")+".Controls[1].Caption = "+;
"'Disponível' + Chr(13) + '" + Alltrim(curLojasAtivas.nomelogin) + "'"
&amp;lcComando
lcComando = "Thisform.PageFrame.page2.gridorder1.colFisi"+Padl(lnI,2,"0")+".Controls[1].Caption = "+;
"'Físico' + Chr(13) + '" + Alltrim(curLojasAtivas.nomelogin) + "'"
&amp;lcComando
EndIf
EndFor


ENDPROC
PROCEDURE pesq_compras
lcWhere = ''
*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
If !Empty(Thisform.PageFrame.page1.cboLojasMultiSelecao.Value)
		lcWhere = "Inlist(p.id_loja, " + Thisform.PageFrame.page1.cboLojasMultiSelecao.Value + ") and "
	Endif
Else
	If Thisform.PageFrame.page1.cbolojas1.Value &gt; 0
		lcWhere = "p.id_loja ="+Alltrim(Transform(Thisform.PageFrame.page1.cbolojas1.Value))+" and "
	Endif
Endif

lcWhere = lcWhere + "p.situacao = [Pendente] and  (p.id in (select id_pedido from pedidos_itens where id_produto = "+Alltrim(Str(curListaProd.Id))+"))"
executarform('frmpesqpedidoscompra',.T.,lcWhere)

ENDPROC
PROCEDURE pesq_entregafutura
lcWhere = " v.status = [ ] and  v.Ent_Futura != 0 and v.id in (select id_venda from vendas_itens where id_produto = " + Alltrim(Str(curlistaprod.id)) + " and qtd_futura &lt; quantidade)"
executarform('frmpesqnotasfiscais_venda',.t.,lcWhere)

ENDPROC
PROCEDURE pesq_reservas
lcWhere = "v.status = ' ' and  v.regiao = '040' and "+;
" v.id in (select id_venda from vendas_itens where id_produto = "+Alltrim(Str(curlistaprod.id))+")"
executarform('frmpesqorcamentos_reserva',.t.,lcWhere)
ENDPROC
PROCEDURE pesq_terceiros
lcWhere = "t.situacao = [Enviado] and t.id in (select id_terceiros from est_terceiros_itens where id_produto = "+Alltrim(Str(curListaProd.id))+")"
*lcWhere = "p.situacao = [Aberto] and  (p.id in (select id_pedido from pedidos_itens where id_produto = "+Alltrim(Str(curListaProd.id))+"))"
executarform('frmpesqremessa_terc',.t.,lcWhere)

ENDPROC
PROCEDURE setarestoqueproduto
Lparameters tcTipoEstoque, tnIdProduto, tnidColuna, tnValor, tcValorAnterior

Private All Like l*

*!* Cristof #80704  14/09/20: Responsavel por gravar o valor de estoque minimo e ideal na loja correspondente

lnIdLoja = 0
If Seek(tnidColuna,"curLojasAtivas","id_coluna")
lnIdLoja = curLojasAtivas.id
Else
Return .F.
EndIf


If Thisform.config41007 == 'Sim'
oEstoque = Createobject([estoque])
Else
oEstoque = Createobject([db_est_estoque])
Endif

Do case
Case tcTipoEstoque = "MINIMO"
oEstoque.setarestoqueminimo(tnIdProduto,lnIdLoja,tnValor)
oSistema.RegistraAuditoria('PRODUTOS', 'ALTERACAO', 'ALTERADO O ESTOQUE MÍNIMO DA LOJA ' + Transform(lnIdLoja) + ' DE ' + Alltrim(tcValorAnterior) + ' PARA ' + Alltrim(str(tnValor,12,2)), oUsuario.Id, curListaProd.Id)
Case tcTipoEstoque = "REPOSICAO"
oEstoque.setarestoquereposicao(tnIdProduto,lnIdLoja,tnValor)
oSistema.RegistraAuditoria('PRODUTOS', 'ALTERACAO', 'ALTERADO O ESTOQUE IDEAL DA LOJA ' + Transform(lnIdLoja) + ' DE ' + Alltrim(tcValorAnterior) + ' PARA ' + Alltrim(str(tnValor,12,2)), oUsuario.Id, curListaProd.Id)
EndCase

Release oProd
ENDPROC
PROCEDURE Unload
DoDefault()
Return Thisform.cRetorno
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3>camposprod
oldsessionid
cretorno
lgerarpedido
nidloja
cselcodigoinicial
cselcodigofinal
lofornecedor
ult_atualizacao
cordenadopor
lvisualizarhistoricoscompravenda
lcrianovohistorico
config41007
oestoque
omovimento
utilizapedidoduaslojas
*buscarprodutos_duaslojas 
*abrircadastro 
*pesq_reservas 
*pesq_compras 
*pesq_terceiros 
*pesq_entregafutura 
*calculartotal 
*calcularfretes 
*historico 
*carregarestoques 
*atualizarestoqueremoto 
*buscarqtdestoquesremotos 
*corrigeestoquecomprado 
*informacoescomplementares_historicocompravenda 
*criarcursorhistoricocompravenda 
*gerarcaptiongridhistoricocompravenda 
*diplaydadoscomplementares_historiccompravenda 
*alterarordemprodutos 
*criarxmlcompra 
*buscarprodutos 
*calcularqtdvendasultimos4meses 
*setarestoqueproduto 
*mostrarnomeloja 
*carregarlojasativas 
*carregaremprestimos 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N0ZSB3A</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>pageframe_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>pageframe</baseclass>
		<objname>pageframe</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>ErasePage = .T.
Top = 5
Left = 5
Width = 825
Height = 575
TabIndex = 1
resizelock = TL
Name = "pageframe"
Page1.Caption = "Filtros e Análise"
Page1.Name = "Page1"
Page2.Caption = "Listagem de Produtos"
Page2.Name = "Page2"
</properties>
		<protected/>
		<methods>PROCEDURE Page1.Activate
thisform.cmdFoto.Visible = .F.
ENDPROC
PROCEDURE Page2.Activate
thisform.cmdFoto.Visible = .T.
this.txtCompraFor.GotFocus()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10TAQU</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 10
Left = 9
Height = 153
Width = 805
ZOrderSet = 0
resizelock = TLHW
Name = "Shape_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE96</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 344
Left = 534
Height = 25
Width = 132
Picture = ..\imagens\imgvisto.bmp
Caption = " \&lt;Processar Análise"
TabIndex = 44
ToolTipText = "Realizar a busca por produtos"
ZOrderSet = 1
resizelock = TLHW
disable_rule = 
Name = "Commandbutton_1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DO CASE
CASE THIS.PARENT.selfornec.getvalue() = 0 AND THIS.PARENT.cntseekgrupos1.getvalue() = 0 AND !THIS.PARENT.chkVip.VALUE
	*!* Raul    #16523  13/11/13: Raul Remover a mensagem quando o fornecedor não é informado
	*Messagebox("Você deve selecionar um fornecedor ou um grupo de produtos.",64,"Informação")
	*This.Parent.selfornec.txtsEEK.SetFocus()
	*Return
CASE (THIS.PARENT.opganalise.VALUE = 2 OR  THIS.PARENT.opganalise.VALUE = 3) AND ;
		THIS.PARENT.cntVendaMedia.cntdata1.getvalue() = {} AND THIS.PARENT.cntVendaMedia.cntdata2.getvalue() = {}
	MESSAGEBOX("Você deve informar o período para análise das vendas.",64,"Informação")
	THIS.PARENT.cntVendaMedia.cntdata1.txtData.SETFOCUS()
	RETURN
ENDCASE

*!* Caroline #55076  06/02/18:    Ao menos um tipo de produto (inativo ou ativo) deve ser selecionado
IF !THISFORM.PAGEFRAME.page1.chkProdutosAtivos.VALUE AND !THISFORM.PAGEFRAME.page1.chkProdutosInativos.VALUE
	MESSAGEBOX("Você deve informar se deseja visualizar produtos ativos, inativos ou ambos.",64,"Informação")
	THISFORM.PAGEFRAME.page1.chkProdutosAtivos.SETFOCUS()
	RETURN
ENDIF

IF THISFORM.PAGEFRAME.page1.selfornec.getvalue() &gt; 0

	THISFORM.loFornecedor = seekregobj('fornecedores','id',THISFORM.PAGEFRAME.page1.selfornec.getvalue())
	IF THISFORM.loFornecedor.distribuidor = 1

		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn26.VISIBLE = .T.
		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn27.VISIBLE = .T.
		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn28.VISIBLE = .T.

		THISFORM.atualizarestoqueremoto()
	ELSE
		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn26.VISIBLE = .F.
		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn27.VISIBLE = .F.
		THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn28.VISIBLE = .F.

	ENDIF
ENDIF

*!* Gabriel #82923  31/03/21: Oculta coluna de saldos
IF THISFORM.PAGEFRAME.page1.chkEmprestimos.VALUE
	THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn95.VISIBLE = .T.
ELSE
	THISFORM.PAGEFRAME.page2.gridorder1.intelicolumn95.VISIBLE = .F.
ENDIF

THISFORM.lCriaNovoHistorico = .T.

THISFORM.BuscarProdutos()
THISFORM.calculartotal()
THISFORM.PAGEFRAME.ACTIVEPAGE = 2
THISFORM.PAGEFRAME.page2.REFRESH
THISFORM.PAGEFRAME.page2.shpHistoCompraVenda.REFRESH
*!*	Thisform.gridorder1.ActivateCell(1,6)
*!*	Thisform.gridorder1.ajustarcolunas()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 171
Left = 9
Height = 170
Width = 425
ZOrderSet = 2
resizelock = TLHW
Name = "Shape_2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0XPOZO</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>optiongroup_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>optiongroup</baseclass>
		<objname>opganalise</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>ButtonCount = 5
BorderStyle = 0
Value = 1
ControlSource = ""
Height = 103
Left = 94
Top = 184
Width = 140
TabIndex = 29
ZOrderSet = 3
Name = "opganalise"
OPTION1.Caption = "No estoque mínimo"
OPTION1.Value = 1
OPTION1.ControlSource = ""
OPTION1.Left = 5
OPTION1.TabIndex = 1
OPTION1.ToolTipText = "A quantidade sugerida será a diferença entre o estoque mínimo e o disponível"
OPTION1.Top = 2
OPTION1.Name = "OPTION1"
OPTION2.Caption = "Na venda média"
OPTION2.ControlSource = ""
OPTION2.Left = 5
OPTION2.TabIndex = 3
OPTION2.ToolTipText = "A quantidade sugerida será a diferença entre a quantidade média vendida no período e o disponível"
OPTION2.Top = 42
OPTION2.Name = "OPTION2"
Optionbutton_3.Caption = "Na venda no período"
Optionbutton_3.ControlSource = ""
Optionbutton_3.Left = 5
Optionbutton_3.TabIndex = 4
Optionbutton_3.ToolTipText = "A quantidade sugerida será exatamente a quantidade vendida durante o período"
Optionbutton_3.Top = 62
Optionbutton_3.Name = "Optionbutton_3"
Optionbutton_4.Caption = "Nenhuma análise"
Optionbutton_4.Value = 0
Optionbutton_4.ControlSource = ""
Optionbutton_4.Left = 5
Optionbutton_4.TabIndex = 5
Optionbutton_4.ToolTipText = "Não sugerir quantidade para compra"
Optionbutton_4.Top = 82
Optionbutton_4.Name = "Optionbutton_4"
Optionbutton_5.Caption = "No estoque ideal"
Optionbutton_5.Left = 5
Optionbutton_5.TabIndex = 2
Optionbutton_5.ToolTipText = "A quantidade sugerida será a diferença entre o estoque ideial e o disponível."
Optionbutton_5.Top = 22
Optionbutton_5.Name = "Optionbutton_5"
</properties>
		<protected/>
		<methods>PROCEDURE InteractiveChange
If This.Value = 2
If !This.Parent.chkAnalMedia.Value
This.Parent.chkAnalMedia.Value = .T.
This.Parent.cntvendaMedia.InteractiveChange()
Endif

If Upper(oempresa.razsoc) = 'ZONA NOVA'
This.Parent.cntvendaMedia.cntdata1.txtData.Value = Gomonth(primeirodiadomes(osistema.hoje),-12)
This.Parent.cntvendaMedia.cntdata2.txtData.Value = ultimodiadomes(Gomonth(primeirodiadomes(osistema.hoje),-9))
Else
This.Parent.cntvendaMedia.cntdata1.txtData.Value = {}
This.Parent.cntvendaMedia.cntdata2.txtData.Value = {}
*!* Charles #66365  26/04/19: Limpar também o label de meses
This.Parent.lblMeses.Caption = []
Endif
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0X8IK1</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 171
Left = 439
Height = 170
Width = 375
ZOrderSet = 4
resizelock = TLHW
Name = "Shape_3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE98</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>optiongroup_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>optiongroup</baseclass>
		<objname>opgTodos</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Height = 45
Left = 393
Top = 97
Width = 179
TabIndex = 17
ZOrderSet = 5
resizelock = TLWH
Name = "opgTodos"
Option1.Caption = " Apenas deste fornecedor"
Option1.ControlSource = ""
Option1.Left = 5
Option1.Top = 10
Option1.Name = "Option1"
Option2.Caption = " Todos do cadastro"
Option2.ControlSource = ""
Option2.Left = 5
Option2.Top = 24
Option2.Name = "Option2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkManter</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 206
Left = 459
Height = 15
Width = 284
Alignment = 0
Caption = " Man\&lt;ter os itens do pedido ao realizar uma nova análise"
Value = .T.
ControlSource = ""
TabIndex = 35
TabStop = .T.
ZOrderSet = 6
resizelock = TLWH
Name = "chkManter"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkEmbalagem</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 226
Left = 459
Height = 15
Width = 298
Alignment = 0
Caption = " \&lt;Sugerir pedido pela quantidade na embalagem do produto"
Value = .T.
ControlSource = ""
TabIndex = 36
TabStop = .T.
ZOrderSet = 7
resizelock = TLWH
Name = "chkEmbalagem"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkTransf</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 246
Left = 459
Height = 15
Width = 323
Alignment = 0
Caption = " \&lt;Incluir notas fiscais de transferência no cálculo da venda média"
Value = .F.
ControlSource = ""
TabIndex = 37
TabStop = .T.
ZOrderSet = 8
resizelock = TLWH
Name = "chkTransf"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_13</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Loj\&lt;a:"
Left = 19
Top = 102
TabIndex = 9
ZOrderSet = 9
Name = "Label_13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9D</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cntperiodo2</class>
		<classloc>..\classes\calendario.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntVendaMedia</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 296
Left = 93
Width = 256
Height = 23
TabIndex = 31
ZOrderSet = 10
Name = "cntVendaMedia"
Cntdata1.txtData.ControlSource = ""
Cntdata1.txtData.Name = "txtData"
Cntdata1.Commandbutton_1.Name = "Commandbutton_1"
Cntdata1.Name = "Cntdata1"
Cntdata2.txtData.ControlSource = ""
Cntdata2.txtData.Name = "txtData"
Cntdata2.Commandbutton_1.Name = "Commandbutton_1"
Cntdata2.Name = "Cntdata2"
Label_1.Name = "Label_1"
cmdPeriodo.Name = "cmdPeriodo"
</properties>
		<protected/>
		<methods>PROCEDURE Cntdata1.txtData.Init
DoDefault()
If Upper(oempresa.razsoc) = 'ZONA NOVA'
This.Value = Gomonth(primeirodiadomes(osistema.hoje),-12)
Endif

ENDPROC
PROCEDURE Cntdata2.txtData.Init
DoDefault()
If Upper(oempresa.razsoc) = 'ZONA NOVA'
This.Value = ultimodiadomes(Gomonth(primeirodiadomes(osistema.hoje),-9))
Else
This.Value = {}
Endif

ENDPROC
PROCEDURE interactivechange
DoDefault()
*!* lnDif = This.diferenca("MESES")
*!* Charles #66365  18/04/19: Nova função que retorna quantidade fracionada e exibe no label.
Try
	If this.cntData1.txtData.Value &lt;= this.cntData2.txtData.Value
		lnDif = RetornaQuantidadeFracionadaMeses(this.cntData1.txtData.Value, this.cntData2.txtData.Value)
	Else
		lnDif = 0
	EndIf 		
	Do Case
	   Case lnDif = 0
	      This.Parent.lblmeses.Caption = ''	
	   Case lnDif &gt; 0 and lnDif &lt;= 1
	      This.Parent.lblmeses.Caption = Alltrim(Str(lnDif,10,4))+' mês'
	   Case lnDif &gt; 1
	      This.Parent.lblmeses.Caption = Alltrim(Str(lnDif,10,4))+' meses'
	EndCase
Catch to loErro
	This.Parent.lblmeses.Caption = ''	
EndTry
	
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_50A0VK517</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkPontaEstoque</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 138
Left = 587
Alignment = 0
Caption = " Não trazer produtos de \&lt;ponta de estoque"
Value = .F.
TabIndex = 26
ToolTipText = "Filtrar apenas produtos que não estejam como ponta de estoque"
ZOrderSet = 11
Name = "chkPontaEstoque"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_54J0MV4VH</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkProdutosInativos</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 48
Left = 587
Alignment = 0
Caption = " Apenas produtos inativos"
Value = .F.
TabIndex = 20
ToolTipText = "Filtrar apenas produtos de alta rotatividade"
ZOrderSet = 12
Name = "chkProdutosInativos"
</properties>
		<protected/>
		<methods>PROCEDURE Click


ENDPROC
PROCEDURE InteractiveChange
*!* Caroline #57091  16/04/18: mantem sempre somente um dos checks selecionados
If this.Value
	thisform.pageFrame.page1.chkProdutosAtivos.Value = .F.
EndIf
	
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkForaLinha</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 123
Left = 587
Alignment = 0
Caption = " Não trazer produtos \&lt;fora de linha"
Value = .F.
TabIndex = 25
ToolTipText = "Filtrar apenas produtos que estejam em linha na loja e no fornecedor"
ZOrderSet = 13
Name = "chkForaLinha"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkRotatividade</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 78
Left = 587
Alignment = 0
Caption = " Apenas produtos alta \&lt;rotatividade"
Value = .F.
TabIndex = 22
ToolTipText = "Filtrar apenas produtos de alta rotatividade"
ZOrderSet = 14
Name = "chkRotatividade"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5830M4C5B</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkfiliais</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 18
Left = 587
Alignment = 0
Caption = " Pesquisar fornecedores vinculados"
Value = .F.
TabIndex = 18
ToolTipText = "Filtrar apenas produtos cadastrados como VIP"
ZOrderSet = 15
Name = "chkfiliais"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkAnalMedia</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 186
Left = 459
Alignment = 0
Caption = " Calcular venda \&lt;média"
Value = .T.
ControlSource = ""
TabIndex = 34
ToolTipText = "Análise da venda média"
ZOrderSet = 16
Name = "chkAnalMedia"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If This.Value And Upper(oempresa.razsoc) = 'ZONA NOVA'
this.Parent.cntvendaMedia.cntdata1.txtData.Value = Gomonth(primeirodiadomes(osistema.hoje),-12)
this.Parent.cntvendaMedia.cntdata2.txtData.Value = ultimodiadomes(Gomonth(primeirodiadomes(osistema.hoje),-9))
Else
this.Parent.cntvendaMedia.cntdata2.txtData.Value = {}
this.Parent.cntvendaMedia.cntdata1.txtData.Value = {}
EndIf


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE92</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtQtdmin</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>ControlSource = ""
Height = 21
Left = 704
TabIndex = 43
ToolTipText = "Gerar pedido apenas de produtos com quantidade faltante igual ou acima desta"
Top = 308
Width = 65
ZOrderSet = 17
resizelock = TLHW
Name = "txtQtdmin"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 0
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkVip</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 63
Left = 587
Alignment = 0
Caption = " Apenas produtos \&lt;VIP"
Value = .F.
TabIndex = 21
ToolTipText = "Filtrar apenas produtos cadastrados como VIP"
ZOrderSet = 18
Name = "chkVip"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Tipo de Análise"
Left = 14
Top = 166
TabIndex = 27
ZOrderSet = 19
resizelock = TLWH
Name = "Label_shape1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblQtd</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "\&lt;Qtd mínima:"
Height = 15
Left = 644
Top = 313
Width = 59
TabIndex = 42
ZOrderSet = 20
resizelock = TLHW
Name = "lblQtd"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24P0MDTIB</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblMeses</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "lblMeses"
Height = 15
Left = 347
Top = 300
Width = 42
TabIndex = 32
ZOrderSet = 21
resizelock = TLHW
Name = "lblMeses"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Caption = ''
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Filtros"
Left = 14
Top = 6
TabIndex = 1
ZOrderSet = 22
resizelock = TLWH
Name = "Label_shape2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE94</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "\&lt;Fornecedor:"
Left = 19
Top = 27
TabIndex = 3
ZOrderSet = 23
ToolTipText = ""
resizelock = TLWH
Name = "Label_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>cntseekgruposprod</class>
		<classloc>..\classes\caixasselecao.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntseekgrupos1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 47
Left = 84
Width = 226
Height = 23
TabIndex = 6
ZOrderSet = 24
ToolTipText = "Grupo de produtos"
Name = "Cntseekgrupos1"
txtseek.ControlSource = ""
txtseek.Height = 21
txtseek.Left = 0
txtseek.Top = 0
txtseek.Width = 200
txtseek.Name = "txtseek"
Cmdseekbase1.Top = 0
Cmdseekbase1.Left = 202
Cmdseekbase1.Name = "Cmdseekbase1"
txtId.ControlSource = ""
txtId.Left = 165
txtId.Top = 0
txtId.Name = "txtId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9C</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cntseekfornec</class>
		<classloc>..\classes\caixasselecao.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>selfornec</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 22
Left = 84
Width = 525
Height = 23
TabIndex = 4
ZOrderSet = 25
ToolTipText = "Fornecedor"
Name = "selfornec"
txtseek.ControlSource = ""
txtseek.Height = 21
txtseek.Left = 0
txtseek.Top = 0
txtseek.Width = 466
txtseek.Name = "txtseek"
Cmdseekbase1.Top = 0
Cmdseekbase1.Left = 469
Cmdseekbase1.Height = 20
Cmdseekbase1.Name = "Cmdseekbase1"
txtId.ControlSource = ""
txtId.Left = 165
txtId.Top = 0
txtId.Name = "txtId"
</properties>
		<protected/>
		<methods>PROCEDURE alterouvalor
DoDefault()

*!* Gabriel #48496  05/09/17: Além da validação por créditos, agora também deve verificar a config 40053
If Buscarconfig('40053') = 'Sim'
*!* Gabriel #48496  20/07/17: Caso a loja tenha créditos com o fornecedor escolhido, o label irá aparecer e ser alimentado.
Select caixa_cliente
Locate For id_fornecedor = This.getvalue()
If Found() And This.getvalue() &gt; 0
lnCredito = 0
Scan For id_fornecedor = This.getvalue()
lnCredito = lnCredito + Iif(caixa_cliente.deb_cred = 'C', valor, -valor)
Endscan
If lnCredito &gt; 0
Thisform.PageFrame.page1.lblCredito.Visible = .T.
Thisform.PageFrame.page1.lblCredito.Caption = 'Crédito Disponível: R$' + Transform(lnCredito,'9,999,999.99')
Else
Thisform.PageFrame.page1.lblCredito.Visible = .F.
Thisform.PageFrame.page1.lblCredito.Caption = ''
Endif
Else
Thisform.PageFrame.page1.lblCredito.Visible = .F.
Thisform.PageFrame.page1.lblCredito.Caption = ''
Endif
EndIf

*!* Caroline #58126  22/05/18: se tiver valor em fornecedores.aviso, informa ao usuário
If Vartype(This.oRegistro) == "O"
	If !IsBlank(Alltrim(this.oregistro.aviso))
		Messagebox(this.oregistro.aviso,64,'Informação')
	EndIf
Endif
*!* Fim -- Caroline #58126


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_9</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "\&lt;Grupo:"
Height = 15
Left = 19
Top = 52
Width = 35
TabIndex = 5
ZOrderSet = 26
ToolTipText = "Grupo de produtos"
resizelock = TLWH
Name = "Label_9"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0VYG9B</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdsair</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmdsair1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 344
Left = 669
Height = 25
Width = 115
Caption = " \&lt;Sair"
TabIndex = 45
ToolTipText = "Sair desta tela (sem salvar alterações)"
ZOrderSet = 27
resizelock = TLHW
disable_rule = 
lconfirmarfechamento = .T.
Name = "Cmdsair1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.cRetorno = ''
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3SW0IK9ZE</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_6</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "\&lt;Marca:"
Left = 19
Top = 76
TabIndex = 7
ZOrderSet = 28
Name = "Label_6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0X8IKE</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Outras opções"
Height = 15
Left = 444
Top = 166
Width = 72
TabIndex = 33
ZOrderSet = 29
resizelock = TLWH
Name = "Label_shape3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0XZ1RU</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_5</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Aplicar índ\&lt;ice:"
Left = 459
Top = 313
TabIndex = 40
ZOrderSet = 30
resizelock = TLHW
Name = "Label_5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0XZ1RT</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Basear \&lt;cálculo:"
Left = 19
Top = 188
TabIndex = 28
ZOrderSet = 31
Name = "Label_4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "P\&lt;eríodo:"
Left = 49
Top = 301
TabIndex = 30
ZOrderSet = 32
Name = "Label_3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0XZ1RV</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>spinner_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>spinner</baseclass>
		<objname>spnindice</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Height = 21
Left = 529
TabIndex = 41
ToolTipText = "Aplica um índice multiplicador na quantidade sugerida pela análise"
Top = 308
Width = 75
ZOrderSet = 33
ControlSource = ""
resizelock = TLHW
Name = "spnindice"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 1.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2NW157253</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cbolojas</class>
		<classloc>..\classes\tools.vcx</classloc>
		<baseclass>combobox</baseclass>
		<objname>Cbolojas1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>ControlSource = "thisform.nIdLoja"
Enabled = .T.
Height = 21
Left = 84
TabIndex = 10
Top = 97
Width = 221
ZOrderSet = 34
lmostraropcaotodas = .T.
lpreselecionarempresalogada = .T.
Name = "Cbolojas1"
</properties>
		<protected/>
		<methods>PROCEDURE InteractiveChange
DoDefault()

thisform.Caption = Alltrim(GetWordNum(Alltrim(thisform.Caption),1,'-'))+ ' - '+this.Displayvalue

This.Parent.cntSeekLocais2.SetarRegistro(0)

*!* Raul    #21531  08/07/14: Este cursor não está mais sendo utilizado
*!*	Local lcWhere
*!*	lcWhere = Iif(This.Value = 0, 'Est.Id_Loja &gt; 0', 'Est.Id_Loja = ' + Transform(This.Value))

*!*	Select Est.*, e.NomeLogin, LocExp.Codigo As Exposicao, LocEst.Codigo As Estocagem;
*!*		From Est_Estoque As Est;
*!*		Left Join Empresas As e On e.Id = Est.Id_Loja;
*!*		Left Join Locais As LocExp On LocExp.Id = Est.Id_LocalExp;
*!*		Left Join Locais As LocEst On LocEst.Id = Est.Id_LocalEst;
*!*		Where &amp;lcWhere.;
*!*		Into Cursor curEstoques;
*!*		Readwrite

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>optiongroup_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>optiongroup</baseclass>
		<objname>opgLoja</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>BorderStyle = 0
ControlSource = ""
Height = 27
Left = 79
Top = 116
Width = 190
TabIndex = 11
ZOrderSet = 35
Name = "opgLoja"
Option1.Caption = "Loja de saída"
Option1.ControlSource = ""
Option1.Left = 5
Option1.Top = 5
Option1.Name = "Option1"
Option2.Anchor = 0
Option2.Caption = "Loja de origem"
Option2.ControlSource = ""
Option2.Left = 90
Option2.Top = 5
Option2.Name = "Option2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3TH0WTJQF</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>cntseekmarcas</class>
		<classloc>..\classes\caixasselecao.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntseekmarcas1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 72
Left = 84
Width = 225
Height = 24
TabIndex = 8
ZOrderSet = 36
Name = "Cntseekmarcas1"
txtseek.Height = 21
txtseek.Left = 0
txtseek.Top = 0
txtseek.Width = 200
txtseek.Name = "txtseek"
Cmdseekbase1.Top = 0
Cmdseekbase1.Left = 202
Cmdseekbase1.Name = "Cmdseekbase1"
txtId.Name = "txtId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41A127I0B</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_7</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Local estocag:"
Left = 321
Top = 51
TabIndex = 12
ZOrderSet = 37
Name = "Label_7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_54J0MV4VI</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkProdutosAtivos</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 33
Left = 587
Height = 15
Width = 135
Alignment = 0
Caption = " Apenas produtos ativos"
Value = .T.
ControlSource = ""
TabIndex = 19
TabStop = .T.
ZOrderSet = 38
resizelock = TLWH
Name = "chkProdutosAtivos"
</properties>
		<protected/>
		<methods>PROCEDURE InteractiveChange
*!* Caroline #57091  16/04/18: mantem sempre somente um dos checks selecionados
If this.Value
	thisform.pageFrame.page1.chkProdutosInativos.Value = .F.
EndIf
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41A127I0C</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>cntseeklocais</class>
		<classloc>..\classes\caixasselecao.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntseeklocais2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 46
Left = 393
Width = 180
Height = 25
TabIndex = 14
ZOrderSet = 39
lreadonly = .F.
ntamcodigo = 5
Name = "Cntseeklocais2"
txtseek.Height = 21
txtseek.Left = 0
txtseek.ReadOnly = .T.
txtseek.Top = 0
txtseek.Width = 157
txtseek.Name = "txtseek"
Cmdseekbase1.Top = 0
Cmdseekbase1.Left = 160
Cmdseekbase1.Name = "Cmdseekbase1"
txtId.Left = 128
txtId.Top = 0
txtId.Name = "txtId"
</properties>
		<protected/>
		<methods>PROCEDURE Cmdseekbase1.Click
*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
	This.Parent.cfiltro = [estoque = 1 ] + Iif(This.Parent.Parent.cboLojas1.Value = 0, '', [and InList(id_loja, ] + This.Parent.Parent.cboLojas1.Value + ')')
Else
	This.Parent.cfiltro = [estoque = 1 ] + Iif(This.Parent.Parent.cboLojas1.Value = 0, '', [and id_loja = ]+vfpval(This.Parent.Parent.cboLojas1.Value))
Endif
DoDefault()

ENDPROC
PROCEDURE txtseek.GotFocus
this.Parent.cfiltro = [estoque = 1]  &amp;&amp; and id_loja = ] + vfpval(curEstoques.id_loja)
DoDefault()

ENDPROC
PROCEDURE txtseek.KeyPress
Lparameters nKeyCode, nShiftAltCtrl
*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
	This.Parent.cfiltro = [estoque = 1 ] + Iif(This.Parent.Parent.cboLojas1.Value = 0, '', [ and InList(id_loja, ] + This.Parent.Parent.cboLojasMultiSelecao.Value + ')')
Else
	This.Parent.cfiltro = [estoque = 1 ] + Iif(This.Parent.Parent.cboLojas1.Value = 0, '', [ and id_loja = ]+vfpval(This.Parent.Parent.cboLojas1.Value))
Endif
DoDefault(nKeyCode, nShiftAltCtrl)

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkEncomenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 93
Left = 587
Height = 15
Width = 181
Alignment = 0
Caption = " Apenas produtos sob encomenda"
Value = .F.
ControlSource = ""
TabIndex = 23
TabStop = .T.
ZOrderSet = 40
resizelock = TLWH
Name = "chkEncomenda"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If this.Value
	this.Parent.ChkNaoTrazEncomenda.Value = .F.
Endif	
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_57T0JFN41</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkNaoTrazEncomenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 108
Left = 587
Height = 15
Width = 196
Alignment = 0
Caption = " Não trazer produtos sob encomenda"
Value = .F.
ControlSource = ""
TabIndex = 24
TabStop = .T.
ZOrderSet = 41
resizelock = TLWH
Name = "chkNaoTrazEncomenda"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If this.Value
	this.Parent.ChkEncomenda.Value = .F.
Endif	
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5GP10E21K</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkAbaterTrasnfReceb</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 266
Left = 459
Height = 15
Width = 274
Alignment = 0
Caption = 'Abater a quantidade "a transferir" da coluna "pedido"'
Value = .F.
ControlSource = ""
TabIndex = 38
TabStop = .T.
ToolTipText = "Qtd Pedido - Qtd a Transferir - Qtd a Receber"
ZOrderSet = 42
resizelock = TLWH
Name = "chkAbaterTrasnfReceb"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4SY100493</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>cntseekdeposito</class>
		<classloc>..\classes\caixasselecao.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntseekdeposito1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 71
Left = 393
Width = 182
Height = 23
TabIndex = 15
ZOrderSet = 43
ntamcodigo = 3
Name = "Cntseekdeposito1"
txtseek.Height = 21
txtseek.Left = 0
txtseek.Top = 0
txtseek.Width = 157
txtseek.Name = "txtseek"
Cmdseekbase1.Top = 0
Cmdseekbase1.Left = 160
Cmdseekbase1.Name = "Cmdseekbase1"
txtId.Left = 120
txtId.Top = 0
txtId.Name = "txtId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4SY100494</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_8</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Depósito:"
Left = 321
Top = 74
TabIndex = 13
ZOrderSet = 44
Name = "Label_8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4YV0KXN1A</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCredito</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>FontBold = .T.
BackStyle = 1
Caption = "Crédito disponível: R$ 1.023,00"
Height = 15
Left = 84
MousePointer = 15
Top = 6
Visible = .F.
Width = 175
TabIndex = 2
ForeColor = 0,0,128
ZOrderSet = 45
Name = "lblCredito"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If This.Visible = .T.
ExecutarForm('frmhistorico_creditos_fornecedor',.T.,Thisform.pageFrame.page1.selfornec.getvalue())
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_50A0LW5JE</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Caption = "Pr\&lt;odutos:"
Height = 15
Left = 396
Top = 92
Width = 49
TabIndex = 16
ZOrderSet = 46
Name = "Label_shape4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_60L0O9MIT</uniqueid>
		<timestamp>1420458489</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkEmprestimos</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Top = 286
Left = 459
Alignment = 0
Caption = "Incluir saldos de empréstimos"
TabIndex = 39
ToolTipText = "Incluir a coluna com os saldos dos empréstimos gerados através da tela de controle de empréstimos."
Visible = .F.
ZOrderSet = 47
Name = "chkEmprestimos"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_6BW0W9JID</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cbomultiselecao_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>combobox</baseclass>
		<objname>cboLojasMultiSelecao</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page1</parent>
		<properties>Height = 22
Left = 84
TabIndex = 11
Top = 97
Visible = .F.
Width = 221
ZOrderSet = 48
Name = "cboLojasMultiSelecao"
</properties>
		<protected/>
		<methods>PROCEDURE Init
Select id, nomelogin as descricao from empresas where ativa = 1 order by descricao asc into cursor curEmpresasTmp READWRITE
Go Top

thisform.AddProperty("cIdLoja","")

DoDefault()

With this
	.ColumnWidths = "200"
	.srcValCol = "id"
	.srcDispCol = "descricao"
	.srcColTitls = "Loja"
	.ControlSource="Thisform.cIdLoja"
	.RowSource = "curEmpresasTmp.Descricao"
EndWith




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41E0JCDAD</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>shpHistoCompraVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 315
Left = 4
Height = 115
Width = 813
Visible = .F.
ZOrderSet = 0
Name = "shpHistoCompraVenda"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVAD9</uniqueid>
		<timestamp>1283095093</timestamp>
		<class>inteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdHistoricoCompraVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ColumnCount = 13
Height = 90
Left = 9
Panel = 1
ReadOnly = .T.
RecordSource = "curHistoCompraVenda"
TabIndex = 43
Top = 330
Visible = .F.
Width = 800
HighlightStyle = 2
ZOrderSet = 1
resizelock = HL
Name = "grdHistoricoCompraVenda"
Intelicolumn1.ControlSource = "Movimento"
Intelicolumn1.Width = 60
Intelicolumn1.ReadOnly = .T.
Intelicolumn1.Visible = .F.
Intelicolumn1.LBRANCO_SE_VAZIO = .T.
Intelicolumn1.Name = "Intelicolumn1"
Intelicolumn2.ControlSource = "Mes01"
Intelicolumn2.Width = 79
Intelicolumn2.ReadOnly = .T.
Intelicolumn2.Visible = .F.
Intelicolumn2.LBRANCO_SE_VAZIO = .T.
Intelicolumn2.Name = "Intelicolumn2"
Intelicolumn3.ControlSource = "Mes02"
Intelicolumn3.Width = 79
Intelicolumn3.ReadOnly = .T.
Intelicolumn3.Visible = .F.
Intelicolumn3.LBRANCO_SE_VAZIO = .T.
Intelicolumn3.Name = "Intelicolumn3"
Intelicolumn4.ControlSource = "Mes03"
Intelicolumn4.Width = 79
Intelicolumn4.ReadOnly = .T.
Intelicolumn4.Visible = .F.
Intelicolumn4.LBRANCO_SE_VAZIO = .T.
Intelicolumn4.Name = "Intelicolumn4"
Intelicolumn5.ControlSource = "Mes04"
Intelicolumn5.Width = 79
Intelicolumn5.ReadOnly = .T.
Intelicolumn5.Visible = .F.
Intelicolumn5.LBRANCO_SE_VAZIO = .T.
Intelicolumn5.Name = "Intelicolumn5"
Intelicolumn6.ControlSource = "Mes05"
Intelicolumn6.Width = 79
Intelicolumn6.ReadOnly = .T.
Intelicolumn6.Visible = .F.
Intelicolumn6.LBRANCO_SE_VAZIO = .T.
Intelicolumn6.Name = "Intelicolumn6"
Intelicolumn7.ControlSource = "Mes06"
Intelicolumn7.Width = 79
Intelicolumn7.ReadOnly = .T.
Intelicolumn7.Visible = .F.
Intelicolumn7.LBRANCO_SE_VAZIO = .T.
Intelicolumn7.Name = "Intelicolumn7"
Intelicolumn8.ControlSource = "Mes07"
Intelicolumn8.Width = 79
Intelicolumn8.ReadOnly = .T.
Intelicolumn8.Visible = .F.
Intelicolumn8.LBRANCO_SE_VAZIO = .T.
Intelicolumn8.Name = "Intelicolumn8"
Intelicolumn9.ControlSource = "Mes08"
Intelicolumn9.Width = 79
Intelicolumn9.ReadOnly = .T.
Intelicolumn9.Visible = .F.
Intelicolumn9.LBRANCO_SE_VAZIO = .T.
Intelicolumn9.Name = "Intelicolumn9"
Intelicolumn10.ControlSource = "Mes09"
Intelicolumn10.Width = 79
Intelicolumn10.ReadOnly = .T.
Intelicolumn10.Visible = .F.
Intelicolumn10.LBRANCO_SE_VAZIO = .T.
Intelicolumn10.Name = "Intelicolumn10"
Intelicolumn11.ControlSource = "Mes10"
Intelicolumn11.Width = 79
Intelicolumn11.ReadOnly = .T.
Intelicolumn11.Visible = .F.
Intelicolumn11.LBRANCO_SE_VAZIO = .T.
Intelicolumn11.Name = "Intelicolumn11"
Intelicolumn12.ControlSource = "Mes11"
Intelicolumn12.Width = 79
Intelicolumn12.ReadOnly = .T.
Intelicolumn12.Visible = .F.
Intelicolumn12.LBRANCO_SE_VAZIO = .T.
Intelicolumn12.Name = "Intelicolumn12"
Intelicolumn13.ControlSource = "Mes12"
Intelicolumn13.Width = 79
Intelicolumn13.ReadOnly = .T.
Intelicolumn13.Visible = .F.
Intelicolumn13.LBRANCO_SE_VAZIO = .T.
Intelicolumn13.Name = "Intelicolumn13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADA</uniqueid>
		<timestamp>1149463189</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn1</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADB</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn1</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADC</uniqueid>
		<timestamp>1149469902</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn2</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADD</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn2</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADE</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn3</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADF</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn3</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADG</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn4</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADH</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn4</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADI</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn5</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADJ</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn5</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADK</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn6</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADL</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn6</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADM</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn7</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADN</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn7</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADO</uniqueid>
		<timestamp>1149586546</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn8</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADP</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn8</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADQ</uniqueid>
		<timestamp>1149469902</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn9</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADR</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn9</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADS</uniqueid>
		<timestamp>1149469902</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn10</parent>
		<properties>Caption = ""
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADT</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn10</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADU</uniqueid>
		<timestamp>1149463189</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn11</parent>
		<properties>Caption = (BuscarCaptionMes(10))
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADV</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn11</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADW</uniqueid>
		<timestamp>1149463189</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn12</parent>
		<properties>Caption = (BuscarCaptionMes(11))
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADX</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn12</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADY</uniqueid>
		<timestamp>1149463189</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn13</parent>
		<properties>Caption = (BuscarCaptionMes(12))
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0QVADZ</uniqueid>
		<timestamp>1149651749</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.grdHistoricoCompraVenda.Intelicolumn13</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41E0JCDAN</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblHistoCompraVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Histórico de Compra e Venda"
Left = 9
Top = 307
Visible = .F.
TabIndex = 42
ZOrderSet = 2
resizelock = WHL
Name = "lblHistoCompraVenda"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Select curHistoCompraVenda
Browse

Select curListaProd
Browse
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24Q0KKE4R</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_5</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 355
Left = 544
Height = 75
Width = 273
ZOrderSet = 3
resizelock = WHL
Name = "Shape_5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9O</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 315
Left = 349
Height = 115
Width = 192
ZOrderSet = 4
resizelock = WHL
Name = "Shape_4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 315
Left = 544
Height = 34
Width = 273
ToolTipText = "Informe um índice para aplicar nas quantidades do pedido"
ZOrderSet = 5
resizelock = WHL
Name = "Shape_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEA5</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtEstVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = ""
Enabled = .F.
Height = 21
InputMask = "9999,999,999.99"
Left = 443
TabIndex = 27
ToolTipText = "Estoque atual em preço de venda"
Top = 350
Width = 92
ZOrderSet = 6
resizelock = WHL
Name = "txtEstVenda"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 0
DoDefault()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>inteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>gridorder1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ColumnCount = 97
HeaderHeight = 31
Height = 280
Left = 4
Panel = 1
ReadOnly = .T.
RecordMark = .F.
RecordSource = "curListaProd"
RowHeight = 17
TabIndex = 1
Top = 6
Width = 810
Partition = 0
ForeColor = 70,70,70
SelectedItemBackColor = 58,110,165
ZOrderSet = 7
resizelock = TL
lajustarcolunas = .T.
dyna_backcolors = RGB(255,63,63);rgb(200,240,255)
dyna_back_conditions = Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0 or curListaProd.pedido2&gt;0 or curListaProd.pedido3&gt;0
dyna_fore_conditions = Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
dyna_forecolors = RGB(255,255,255)
Name = "gridorder1"
Intelicolumn1.ColumnOrder = 2
Intelicolumn1.ControlSource = "nome"
Intelicolumn1.Width = 257
Intelicolumn1.ReadOnly = .T.
Intelicolumn1.ForeColor = 70,70,70
Intelicolumn1.Dyna_fore_conditions = Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn1.Dyna_forecolors = RGB(255,255,255);rgb(0,0,255)
Intelicolumn1.LSUBSTITUIRTEXT = .F.
Intelicolumn1.Dyna_back_conditions = Encomenda = 1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0 or curListaProd.pedido2&gt;0 or curListaProd.pedido3&gt;0
Intelicolumn1.Dyna_backcolors = Rgb(191,222,131);rgb(255,63,63);rgb(200,240,255)
Intelicolumn1.Name = "Intelicolumn1"
Intelicolumn2.Alignment = 2
Intelicolumn2.ColumnOrder = 1
Intelicolumn2.ControlSource = "codigo"
Intelicolumn2.Width = 57
Intelicolumn2.ReadOnly = .T.
Intelicolumn2.ForeColor = 70,70,70
Intelicolumn2.Dyna_back_conditions = 
Intelicolumn2.Dyna_backcolors = 
Intelicolumn2.Dyna_fore_conditions = curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.promo&gt;0
Intelicolumn2.Dyna_forecolors = rgb(200,10,10);RGB(255,255,255);rgb(0,0,255)
Intelicolumn2.Name = "Intelicolumn2"
Intelicolumn3.ColumnOrder = 4
Intelicolumn3.ControlSource = "preco_compra"
Intelicolumn3.Width = 70
Intelicolumn3.ReadOnly = .F.
Intelicolumn3.InputMask = "999,999.9999"
Intelicolumn3.ForeColor = 70,70,70
Intelicolumn3.Dyna_back_conditions = 
Intelicolumn3.Dyna_backcolors = 
Intelicolumn3.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn3.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn3.LEXIBIR_ATRIBUIRVALORPADRAO = .F.
Intelicolumn3.Name = "Intelicolumn3"
Intelicolumn4.ColumnOrder = 5
Intelicolumn4.ControlSource = "est_minimo"
Intelicolumn4.Width = 65
Intelicolumn4.ReadOnly = .F.
Intelicolumn4.ForeColor = 70,70,70
Intelicolumn4.Dyna_back_conditions = 
Intelicolumn4.Dyna_backcolors = 
Intelicolumn4.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn4.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn4.LSUBSTITUIRTEXT = .F.
Intelicolumn4.NLARGURAFIXA = 0
Intelicolumn4.LEXIBIR_ATRIBUIRVALORPADRAO = .F.
Intelicolumn4.Name = "Intelicolumn4"
Intelicolumn5.ColumnOrder = 54
Intelicolumn5.ControlSource = "est_venda"
Intelicolumn5.ReadOnly = .T.
Intelicolumn5.ForeColor = 70,70,70
Intelicolumn5.Dyna_backcolors = 
Intelicolumn5.Dyna_back_conditions = 
Intelicolumn5.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn5.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn5.Name = "Intelicolumn5"
Intelicolumn6.ColumnOrder = 81
Intelicolumn6.ControlSource = "est_pedido"
Intelicolumn6.Width = 63
Intelicolumn6.ReadOnly = .T.
Intelicolumn6.ForeColor = 70,70,70
Intelicolumn6.Dyna_backcolors = 
Intelicolumn6.Dyna_back_conditions = 
Intelicolumn6.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn6.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn6.LSUBSTITUIRTEXT = .F.
Intelicolumn6.Name = "Intelicolumn6"
Intelicolumn7.ColumnOrder = 82
Intelicolumn7.ControlSource = "est_defeito"
Intelicolumn7.Width = 70
Intelicolumn7.ReadOnly = .T.
Intelicolumn7.ForeColor = 70,70,70
Intelicolumn7.Dyna_back_conditions = curListaProd.est_defeito &gt; 0;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0 or curListaProd.pedido2&gt;0 or curListaProd.pedido3&gt;0
Intelicolumn7.Dyna_backcolors = rgb(255,255,0);RGB(255,63,63);rgb(200,240,255)
Intelicolumn7.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn7.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn7.Name = "Intelicolumn7"
Intelicolumn8.ColumnOrder = 70
Intelicolumn8.ControlSource = "curListaProd.pedido"
Intelicolumn8.Width = 69
Intelicolumn8.ReadOnly = .F.
Intelicolumn8.ForeColor = 70,70,70
Intelicolumn8.Dyna_back_conditions = curListaProd.est_minimo &gt; curListaProd.pedido + curListaProd.est_disponivel and curListaProd.pedido &gt; 0;curListaProd.pedido&gt;0 or curListaProd.pedido2&gt;0 or curListaProd.pedido3&gt;0
Intelicolumn8.Dyna_backcolors = rgb(255,153,0);rgb(200,240,255)
Intelicolumn8.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(Flags,5,1)='1' OR Substr(Flags,6,1)='1'
Intelicolumn8.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);rgb(255,255,255)
Intelicolumn8.LSUBSTITUIRTEXT = .F.
Intelicolumn8.LGOTFOCUSPEGACORDYNAMIC = .T.
Intelicolumn8.LEXIBIR_ATRIBUIRVALORPADRAO = .T.
Intelicolumn8.LEXIBIR_INSERIRTEXTOPADRAOFINAL = .T.
Intelicolumn8.Name = "Intelicolumn8"
Intelicolumn9.ColumnOrder = 86
Intelicolumn9.ControlSource = "est_mostruario"
Intelicolumn9.ReadOnly = .T.
Intelicolumn9.ForeColor = 70,70,70
Intelicolumn9.Dyna_back_conditions = 
Intelicolumn9.Dyna_backcolors = 
Intelicolumn9.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn9.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn9.Name = "Intelicolumn9"
Intelicolumn10.ColumnOrder = 87
Intelicolumn10.ControlSource = "est_terceiros"
Intelicolumn10.ReadOnly = .T.
Intelicolumn10.ForeColor = 70,70,70
Intelicolumn10.Dyna_back_conditions = 
Intelicolumn10.Dyna_backcolors = 
Intelicolumn10.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn10.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn10.Name = "Intelicolumn10"
Intelicolumn11.ColumnOrder = 84
Intelicolumn11.ControlSource = "est_reservado"
Intelicolumn11.ReadOnly = .T.
Intelicolumn11.ForeColor = 70,70,70
Intelicolumn11.Dyna_back_conditions = 
Intelicolumn11.Dyna_backcolors = 
Intelicolumn11.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn11.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn11.LSUBSTITUIRTEXT = .F.
Intelicolumn11.Name = "colReservado"
Intelicolumn12.ColumnOrder = 83
Intelicolumn12.ControlSource = "est_vendido"
Intelicolumn12.ReadOnly = .T.
Intelicolumn12.ForeColor = 70,70,70
Intelicolumn12.Dyna_back_conditions = curListaProd.est_vendido &gt; 0;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0 or curListaProd.pedido2&gt;0 or curListaProd.pedido3&gt;0
Intelicolumn12.Dyna_backcolors = rgb(255,255,0);RGB(255,63,63);rgb(200,240,255)
Intelicolumn12.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn12.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn12.LSUBSTITUIRTEXT = .F.
Intelicolumn12.Name = "colEF"
Intelicolumn13.ColumnOrder = 77
Intelicolumn13.ControlSource = "Round((curListaProd.pedido*curListaProd.preco_compra) + (curListaProd.pedido2*curListaProd.preco_compra) + (curListaProd.pedido3*curListaProd.preco_compra), 2)"
Intelicolumn13.Width = 88
Intelicolumn13.ReadOnly = .T.
Intelicolumn13.InputMask = "99,999,999.99"
Intelicolumn13.ForeColor = 70,70,70
Intelicolumn13.Dyna_back_conditions = 
Intelicolumn13.Dyna_backcolors = 
Intelicolumn13.Name = "Intelicolumn13"
Intelicolumn14.ColumnOrder = 78
Intelicolumn14.ControlSource = "venda_media"
Intelicolumn14.ReadOnly = .T.
Intelicolumn14.ForeColor = 70,70,70
Intelicolumn14.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn14.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn14.Dyna_back_conditions = 
Intelicolumn14.Dyna_backcolors = 
Intelicolumn14.Name = "Intelicolumn14"
Intelicolumn15.ColumnOrder = 88
Intelicolumn15.ControlSource = "peso"
Intelicolumn15.ReadOnly = .F.
Intelicolumn15.ForeColor = 70,70,70
Intelicolumn15.LSUBSTITUIRTEXT = .F.
Intelicolumn15.Dyna_backcolors = 
Intelicolumn15.Dyna_back_conditions = 
Intelicolumn15.LEXIBIR_ATRIBUIRVALORPADRAO = .F.
Intelicolumn15.Name = "Intelicolumn15"
Intelicolumn16.Tag = "OCULTAR MINIMO"
Intelicolumn16.ColumnOrder = 6
Intelicolumn16.ControlSource = "est_min_1"
Intelicolumn16.Width = 65
Intelicolumn16.ReadOnly = .F.
Intelicolumn16.ForeColor = 70,70,70
Intelicolumn16.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn16.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn16.LSUBSTITUIRTEXT = .F.
Intelicolumn16.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn16.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn16.Name = "colMin01"
Intelicolumn17.Tag = "OCULTAR MINIMO"
Intelicolumn17.ColumnOrder = 7
Intelicolumn17.ControlSource = "est_min_2"
Intelicolumn17.Width = 65
Intelicolumn17.ReadOnly = .F.
Intelicolumn17.ForeColor = 70,70,70
Intelicolumn17.LSUBSTITUIRTEXT = .F.
Intelicolumn17.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn17.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn17.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn17.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn17.Name = "colMin02"
Intelicolumn18.Tag = "OCULTAR MINIMO"
Intelicolumn18.ColumnOrder = 8
Intelicolumn18.ControlSource = "est_min_3"
Intelicolumn18.Width = 65
Intelicolumn18.ReadOnly = .F.
Intelicolumn18.ForeColor = 70,70,70
Intelicolumn18.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn18.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn18.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn18.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn18.LSUBSTITUIRTEXT = .F.
Intelicolumn18.Name = "colMin03"
Intelicolumn19.Tag = "OCULTAR MINIMO"
Intelicolumn19.ColumnOrder = 9
Intelicolumn19.ControlSource = "est_min_4"
Intelicolumn19.Width = 65
Intelicolumn19.ReadOnly = .F.
Intelicolumn19.ForeColor = 70,70,70
Intelicolumn19.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn19.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn19.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn19.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn19.LSUBSTITUIRTEXT = .F.
Intelicolumn19.Name = "colMin04"
Intelicolumn20.Tag = "OCULTAR MINIMO"
Intelicolumn20.ColumnOrder = 10
Intelicolumn20.ControlSource = "est_min_5"
Intelicolumn20.Width = 65
Intelicolumn20.ReadOnly = .F.
Intelicolumn20.ForeColor = 70,70,70
Intelicolumn20.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn20.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn20.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn20.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn20.Lhabilitarpesquisa = .F.
Intelicolumn20.LSUBSTITUIRTEXT = .F.
Intelicolumn20.Name = "colMin05"
Intelicolumn21.Tag = "OCULTAR DISPONIVEL"
Intelicolumn21.ColumnOrder = 55
Intelicolumn21.ControlSource = "est_ven_1"
Intelicolumn21.ReadOnly = .T.
Intelicolumn21.ForeColor = 70,70,70
Intelicolumn21.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn21.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn21.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn21.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn21.LSUBSTITUIRTEXT = .F.
Intelicolumn21.Name = "colFisi01"
Intelicolumn22.Tag = "OCULTAR DISPONIVEL"
Intelicolumn22.ColumnOrder = 56
Intelicolumn22.ControlSource = "est_ven_2"
Intelicolumn22.ReadOnly = .T.
Intelicolumn22.ForeColor = 70,70,70
Intelicolumn22.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn22.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn22.LSUBSTITUIRTEXT = .F.
Intelicolumn22.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn22.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn22.Name = "colFisi02"
Intelicolumn23.Tag = "OCULTAR DISPONIVEL"
Intelicolumn23.ColumnOrder = 57
Intelicolumn23.ControlSource = "est_ven_3"
Intelicolumn23.ReadOnly = .T.
Intelicolumn23.ForeColor = 70,70,70
Intelicolumn23.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn23.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn23.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn23.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn23.LSUBSTITUIRTEXT = .F.
Intelicolumn23.Name = "colFisi03"
Intelicolumn24.Tag = "OCULTAR DISPONIVEL"
Intelicolumn24.ColumnOrder = 58
Intelicolumn24.ControlSource = "est_ven_4"
Intelicolumn24.ReadOnly = .T.
Intelicolumn24.ForeColor = 70,70,70
Intelicolumn24.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn24.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn24.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn24.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn24.LSUBSTITUIRTEXT = .F.
Intelicolumn24.Name = "colFisi04"
Intelicolumn25.ColumnOrder = 85
Intelicolumn25.ControlSource = "est_transferir"
Intelicolumn25.ReadOnly = .T.
Intelicolumn25.ForeColor = 70,70,70
Intelicolumn25.Dyna_back_conditions = 
Intelicolumn25.Dyna_backcolors = 
Intelicolumn25.Name = "Intelicolumn25"
Intelicolumn26.ColumnOrder = 90
Intelicolumn26.ControlSource = "est_distribuidor"
Intelicolumn26.ReadOnly = .T.
Intelicolumn26.ForeColor = 70,70,70
Intelicolumn26.Dyna_back_conditions = Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'; iif(qtd_embalagem &gt; 0 , (pedido / qtd_embalagem)&gt; est_distribuidor,pedido &gt;  est_distribuidor)
Intelicolumn26.Dyna_backcolors = RGB(255,63,63);RGB(255,0,0)
Intelicolumn26.Name = "Intelicolumn26"
Intelicolumn27.ColumnOrder = 91
Intelicolumn27.ControlSource = "vl_distribuidor"
Intelicolumn27.ReadOnly = .T.
Intelicolumn27.ForeColor = 70,70,70
Intelicolumn27.BackColor = 255,255,255
Intelicolumn27.Dyna_back_conditions = 
Intelicolumn27.Dyna_backcolors = 
Intelicolumn27.Name = "Intelicolumn27"
Intelicolumn28.ColumnOrder = 94
Intelicolumn28.ControlSource = "unidade"
Intelicolumn28.ReadOnly = .T.
Intelicolumn28.ForeColor = 70,70,70
Intelicolumn28.Dyna_back_conditions = 
Intelicolumn28.Dyna_backcolors = 
Intelicolumn28.Name = "Intelicolumn28"
Intelicolumn29.ColumnOrder = 38
Intelicolumn29.ControlSource = "Est_disponivel"
Intelicolumn29.ReadOnly = .T.
Intelicolumn29.ForeColor = 70,70,70
Intelicolumn29.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_disponivel &lt; curListaProd.est_minimo;Substr(Flags,5,1)='1' OR Substr(Flags,6,1)='1'
Intelicolumn29.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn29.Dyna_back_conditions = 
Intelicolumn29.Dyna_backcolors = 
Intelicolumn29.Name = "Intelicolumn29"
Intelicolumn30.Tag = "OCULTAR DISPONIVEL"
Intelicolumn30.ColumnOrder = 39
Intelicolumn30.ControlSource = "est_dis_1"
Intelicolumn30.ReadOnly = .T.
Intelicolumn30.ForeColor = 70,70,70
Intelicolumn30.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn30.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn30.Name = "coldisp01"
Intelicolumn31.Tag = "OCULTAR DISPONIVEL"
Intelicolumn31.ColumnOrder = 40
Intelicolumn31.ControlSource = "est_dis_2"
Intelicolumn31.ReadOnly = .T.
Intelicolumn31.ForeColor = 70,70,70
Intelicolumn31.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn31.Dyna_backcolors = rgb(168,218,255);rgb(200,240,255)
Intelicolumn31.Name = "coldisp02"
Intelicolumn32.Tag = "OCULTAR DISPONIVEL"
Intelicolumn32.ColumnOrder = 41
Intelicolumn32.ControlSource = "est_dis_3"
Intelicolumn32.ReadOnly = .T.
Intelicolumn32.ForeColor = 70,70,70
Intelicolumn32.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn32.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn32.Name = "coldisp03"
Intelicolumn33.Tag = "OCULTAR DISPONIVEL"
Intelicolumn33.ColumnOrder = 42
Intelicolumn33.ControlSource = "est_dis_4"
Intelicolumn33.ReadOnly = .T.
Intelicolumn33.ForeColor = 70,70,70
Intelicolumn33.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn33.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn33.Name = "coldisp04"
Intelicolumn34.ColumnOrder = 3
Intelicolumn34.ControlSource = "unidMedi"
Intelicolumn34.Width = 46
Intelicolumn34.ReadOnly = .T.
Intelicolumn34.ForeColor = 70,70,70
Intelicolumn34.Dyna_fore_conditions = curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn34.Dyna_forecolors = rgb(200,10,10);RGB(255,255,255)
Intelicolumn34.Dyna_back_conditions = 
Intelicolumn34.Dyna_backcolors = 
Intelicolumn34.Name = "Intelicolumn34"
Intelicolumn35.ColumnOrder = 92
Intelicolumn35.ControlSource = "Cod_ref"
Intelicolumn35.ReadOnly = .T.
Intelicolumn35.ForeColor = 70,70,70
Intelicolumn35.Dyna_back_conditions = 
Intelicolumn35.Dyna_backcolors = 
Intelicolumn35.Name = "Intelicolumn35"
Intelicolumn36.ColumnOrder = 37
Intelicolumn36.ControlSource = "Ordem_Estocagem"
Intelicolumn36.Width = 79
Intelicolumn36.ReadOnly = .T.
Intelicolumn36.ForeColor = 70,70,70
Intelicolumn36.Name = "Intelicolumn36"
Intelicolumn37.Tag = "OCULTAR DISPONIVEL"
Intelicolumn37.ColumnOrder = 43
Intelicolumn37.ControlSource = "est_dis_5"
Intelicolumn37.ReadOnly = .T.
Intelicolumn37.ForeColor = 70,70,70
Intelicolumn37.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn37.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn37.Lhabilitarpesquisa = .F.
Intelicolumn37.Name = "coldisp05"
Intelicolumn38.Tag = "OCULTAR DISPONIVEL"
Intelicolumn38.ColumnOrder = 59
Intelicolumn38.ControlSource = "est_ven_5"
Intelicolumn38.ReadOnly = .T.
Intelicolumn38.ForeColor = 70,70,70
Intelicolumn38.Lhabilitarpesquisa = .F.
Intelicolumn38.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn38.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn38.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn38.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn38.Name = "colFisi05"
Intelicolumn39.ColumnOrder = 71
Intelicolumn39.ControlSource = "curListaProd.pedido2"
Intelicolumn39.ReadOnly = .F.
Intelicolumn39.ForeColor = 70,70,70
Intelicolumn39.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(Flags,5,1)='1' OR Substr(Flags,6,1)='1'
Intelicolumn39.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);rgb(255,255,255)
Intelicolumn39.Dyna_back_conditions = 
Intelicolumn39.Dyna_backcolors = 
Intelicolumn39.LEXIBIR_ATRIBUIRVALORPADRAO = .T.
Intelicolumn39.Name = "Intelicolumn39"
Intelicolumn40.ColumnOrder = 79
Intelicolumn40.ControlSource = "venda_media2"
Intelicolumn40.ReadOnly = .T.
Intelicolumn40.ForeColor = 70,70,70
Intelicolumn40.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn40.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn40.Dyna_back_conditions = 
Intelicolumn40.Dyna_backcolors = 
Intelicolumn40.Name = "Intelicolumn40"
Intelicolumn41.ColumnOrder = 21
Intelicolumn41.ControlSource = "Est_Ideal"
Intelicolumn41.ReadOnly = .T.
Intelicolumn41.Visible = .T.
Intelicolumn41.ForeColor = 70,70,70
Intelicolumn41.Dyna_back_conditions = 
Intelicolumn41.Dyna_backcolors = 
Intelicolumn41.Name = "col_Ideal"
Intelicolumn42.Tag = "OCULTAR"
Intelicolumn42.ColumnOrder = 22
Intelicolumn42.ControlSource = "Est_Ideal_1"
Intelicolumn42.ReadOnly = .F.
Intelicolumn42.Visible = .T.
Intelicolumn42.ForeColor = 70,70,70
Intelicolumn42.BackColor = 212,208,200
Intelicolumn42.Dyna_back_conditions = 1=1
Intelicolumn42.Dyna_backcolors = rgb(150,194,150)
Intelicolumn42.LSUBSTITUIRTEXT = .F.
Intelicolumn42.Name = "col_Ideal1"
Intelicolumn43.Tag = "OCULTAR"
Intelicolumn43.ColumnOrder = 23
Intelicolumn43.ControlSource = "Est_Ideal_2"
Intelicolumn43.ReadOnly = .F.
Intelicolumn43.Visible = .T.
Intelicolumn43.ForeColor = 70,70,70
Intelicolumn43.BackColor = 212,208,200
Intelicolumn43.Dyna_back_conditions = 1=1
Intelicolumn43.Dyna_backcolors = rgb(168,218,255)
Intelicolumn43.LSUBSTITUIRTEXT = .F.
Intelicolumn43.Name = "col_Ideal2"
Intelicolumn44.Tag = "OCULTAR"
Intelicolumn44.ColumnOrder = 24
Intelicolumn44.ControlSource = "Est_Ideal_3"
Intelicolumn44.ReadOnly = .F.
Intelicolumn44.Visible = .T.
Intelicolumn44.ForeColor = 70,70,70
Intelicolumn44.BackColor = 212,208,200
Intelicolumn44.Dyna_backcolors = rgb(150,194,150)
Intelicolumn44.Dyna_back_conditions = 1=1
Intelicolumn44.LSUBSTITUIRTEXT = .F.
Intelicolumn44.Name = "col_Ideal3"
Intelicolumn45.Tag = "OCULTAR"
Intelicolumn45.ColumnOrder = 25
Intelicolumn45.ControlSource = "Est_Ideal_4"
Intelicolumn45.ReadOnly = .F.
Intelicolumn45.Visible = .T.
Intelicolumn45.ForeColor = 70,70,70
Intelicolumn45.BackColor = 212,208,200
Intelicolumn45.Dyna_back_conditions = 1=1
Intelicolumn45.Dyna_backcolors = rgb(168,218,255)
Intelicolumn45.LSUBSTITUIRTEXT = .F.
Intelicolumn45.Name = "col_Ideal4"
Intelicolumn46.Tag = "OCULTAR"
Intelicolumn46.ColumnOrder = 26
Intelicolumn46.ControlSource = "Est_Ideal_5"
Intelicolumn46.ReadOnly = .F.
Intelicolumn46.Visible = .T.
Intelicolumn46.ForeColor = 70,70,70
Intelicolumn46.BackColor = 212,208,200
Intelicolumn46.Dyna_back_conditions = 1=1
Intelicolumn46.Dyna_backcolors = rgb(150,194,150)
Intelicolumn46.LSUBSTITUIRTEXT = .F.
Intelicolumn46.Name = "col_Ideal5"
Intelicolumn47.ColumnOrder = 95
Intelicolumn47.ControlSource = "EstoqueRD"
Intelicolumn47.Width = 104
Intelicolumn47.ReadOnly = .T.
Intelicolumn47.ForeColor = 70,70,70
Intelicolumn47.Dyna_back_conditions = 
Intelicolumn47.Dyna_backcolors = 
Intelicolumn47.Name = "Intelicolumn47"
Intelicolumn48.ColumnOrder = 72
Intelicolumn48.ControlSource = "qtd_vendas_m1"
Intelicolumn48.Width = 130
Intelicolumn48.ReadOnly = .T.
Intelicolumn48.Visible = .F.
Intelicolumn48.ForeColor = 70,70,70
Intelicolumn48.Name = "Intelicolumn48"
Intelicolumn49.ColumnOrder = 73
Intelicolumn49.ControlSource = "qtd_vendas_m2"
Intelicolumn49.Width = 130
Intelicolumn49.ReadOnly = .T.
Intelicolumn49.Visible = .F.
Intelicolumn49.ForeColor = 70,70,70
Intelicolumn49.Name = "Intelicolumn49"
Intelicolumn50.ColumnOrder = 74
Intelicolumn50.ControlSource = "qtd_vendas_m3"
Intelicolumn50.Width = 130
Intelicolumn50.ReadOnly = .T.
Intelicolumn50.Visible = .F.
Intelicolumn50.ForeColor = 70,70,70
Intelicolumn50.Name = "Intelicolumn50"
Intelicolumn51.ColumnOrder = 75
Intelicolumn51.ControlSource = "qtd_vendas_m4"
Intelicolumn51.Width = 130
Intelicolumn51.ReadOnly = .T.
Intelicolumn51.Visible = .F.
Intelicolumn51.ForeColor = 70,70,70
Intelicolumn51.Name = "Intelicolumn51"
Intelicolumn52.ColumnOrder = 80
Intelicolumn52.ControlSource = "venda_media3"
Intelicolumn52.ReadOnly = .T.
Intelicolumn52.ForeColor = 70,70,70
Intelicolumn52.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn52.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn52.Dyna_back_conditions = 
Intelicolumn52.Dyna_backcolors = 
Intelicolumn52.Name = "Intelicolumn52"
Intelicolumn53.ColumnOrder = 76
Intelicolumn53.ControlSource = "curListaProd.pedido3"
Intelicolumn53.ReadOnly = .F.
Intelicolumn53.ForeColor = 70,70,70
Intelicolumn53.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(Flags,5,1)='1' OR Substr(Flags,6,1)='1'
Intelicolumn53.Dyna_forecolors = rgb(255,255,255);rgb(200,10,10);rgb(255,255,255)
Intelicolumn53.Dyna_back_conditions = 
Intelicolumn53.Dyna_backcolors = 
Intelicolumn53.LEXIBIR_ATRIBUIRVALORPADRAO = .T.
Intelicolumn53.Name = "Intelicolumn53"
Intelicolumn54.ColumnOrder = 89
Intelicolumn54.ControlSource = "round((curListaProd.pedido*curListaProd.volume)+(curListaProd.pedido2*curListaProd.volume)+(curListaProd.pedido3*curListaProd.volume),2)"
Intelicolumn54.ReadOnly = .T.
Intelicolumn54.ForeColor = 70,70,70
Intelicolumn54.Dyna_back_conditions = 
Intelicolumn54.Dyna_backcolors = 
Intelicolumn54.Name = "Intelicolumn54"
Intelicolumn55.Tag = "OCULTAR DISPONIVEL"
Intelicolumn55.ColumnOrder = 60
Intelicolumn55.ControlSource = "est_ven_6"
Intelicolumn55.ReadOnly = .T.
Intelicolumn55.ForeColor = 70,70,70
Intelicolumn55.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn55.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn55.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn55.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn55.Lhabilitarpesquisa = .F.
Intelicolumn55.Name = "ColFisi06"
Intelicolumn56.Tag = "OCULTAR DISPONIVEL"
Intelicolumn56.ColumnOrder = 44
Intelicolumn56.ControlSource = "est_dis_6"
Intelicolumn56.ReadOnly = .T.
Intelicolumn56.ForeColor = 70,70,70
Intelicolumn56.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn56.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn56.Lhabilitarpesquisa = .F.
Intelicolumn56.Name = "coldisp06"
Intelicolumn57.Tag = "OCULTAR MINIMO"
Intelicolumn57.ColumnOrder = 11
Intelicolumn57.ControlSource = "est_min_6"
Intelicolumn57.ReadOnly = .F.
Intelicolumn57.ForeColor = 70,70,70
Intelicolumn57.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn57.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn57.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn57.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn57.LSUBSTITUIRTEXT = .F.
Intelicolumn57.Lhabilitarpesquisa = .F.
Intelicolumn57.Name = "ColMin06"
Intelicolumn58.Tag = "OCULTAR DISPONIVEL"
Intelicolumn58.ColumnOrder = 61
Intelicolumn58.ControlSource = "est_ven_7"
Intelicolumn58.CurrentControl = "Text1"
Intelicolumn58.ReadOnly = .T.
Intelicolumn58.ForeColor = 70,70,70
Intelicolumn58.Lhabilitarpesquisa = .F.
Intelicolumn58.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn58.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn58.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn58.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn58.Name = "ColFisi07"
Intelicolumn59.Tag = "OCULTAR DISPONIVEL"
Intelicolumn59.ColumnOrder = 45
Intelicolumn59.ControlSource = "est_dis_7"
Intelicolumn59.ReadOnly = .T.
Intelicolumn59.ForeColor = 70,70,70
Intelicolumn59.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn59.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn59.Lhabilitarpesquisa = .F.
Intelicolumn59.Name = "coldisp07"
Intelicolumn60.Tag = "OCULTAR MINIMO"
Intelicolumn60.ColumnOrder = 12
Intelicolumn60.ControlSource = "est_min_7"
Intelicolumn60.ReadOnly = .F.
Intelicolumn60.ForeColor = 70,70,70
Intelicolumn60.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn60.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn60.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn60.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn60.Lhabilitarpesquisa = .F.
Intelicolumn60.LSUBSTITUIRTEXT = .F.
Intelicolumn60.Name = "ColMin07"
Intelicolumn61.Tag = "OCULTAR"
Intelicolumn61.ColumnOrder = 27
Intelicolumn61.ControlSource = "Est_Ideal_6"
Intelicolumn61.ReadOnly = .F.
Intelicolumn61.Visible = .T.
Intelicolumn61.ForeColor = 70,70,70
Intelicolumn61.BackColor = 212,208,200
Intelicolumn61.Dyna_back_conditions = 1=1
Intelicolumn61.Dyna_backcolors = rgb(168,218,255)
Intelicolumn61.LSUBSTITUIRTEXT = .F.
Intelicolumn61.Lhabilitarpesquisa = .T.
Intelicolumn61.Name = "Col_Ideal6"
Intelicolumn62.Tag = "OCULTAR"
Intelicolumn62.HeaderClassLibrary = ..\classes\inteligrid.prg
Intelicolumn62.ColumnOrder = 28
Intelicolumn62.ControlSource = "Est_Ideal_7"
Intelicolumn62.ReadOnly = .F.
Intelicolumn62.Visible = .T.
Intelicolumn62.ForeColor = 70,70,70
Intelicolumn62.BackColor = 212,208,202
Intelicolumn62.Dyna_back_conditions = 1=1
Intelicolumn62.Dyna_backcolors = rgb(150,194,150)
Intelicolumn62.LSUBSTITUIRTEXT = .F.
Intelicolumn62.Name = "Col_Ideal7"
Intelicolumn63.Tag = "OCULTAR MINIMO"
Intelicolumn63.ColumnOrder = 13
Intelicolumn63.ControlSource = "est_min_8"
Intelicolumn63.ReadOnly = .F.
Intelicolumn63.ForeColor = 70,70,70
Intelicolumn63.Lhabilitarpesquisa = .F.
Intelicolumn63.LSUBSTITUIRTEXT = .F.
Intelicolumn63.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn63.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn63.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn63.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn63.Name = "ColMin08"
Intelicolumn64.Tag = "OCULTAR MINIMO"
Intelicolumn64.ColumnOrder = 14
Intelicolumn64.ControlSource = "est_min_9"
Intelicolumn64.ReadOnly = .F.
Intelicolumn64.ForeColor = 70,70,70
Intelicolumn64.LSUBSTITUIRTEXT = .F.
Intelicolumn64.Lhabilitarpesquisa = .F.
Intelicolumn64.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn64.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn64.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn64.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn64.Name = "ColMin09"
Intelicolumn65.Tag = "OCULTAR MINIMO"
Intelicolumn65.ColumnOrder = 15
Intelicolumn65.ControlSource = "est_min_10"
Intelicolumn65.ReadOnly = .F.
Intelicolumn65.ForeColor = 70,70,70
Intelicolumn65.Lhabilitarpesquisa = .F.
Intelicolumn65.LSUBSTITUIRTEXT = .F.
Intelicolumn65.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn65.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn65.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn65.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn65.Name = "ColMin10"
Intelicolumn66.Tag = "OCULTAR MINIMO"
Intelicolumn66.ColumnOrder = 16
Intelicolumn66.ControlSource = "est_min_11"
Intelicolumn66.ReadOnly = .F.
Intelicolumn66.ForeColor = 70,70,70
Intelicolumn66.Lhabilitarpesquisa = .F.
Intelicolumn66.LSUBSTITUIRTEXT = .F.
Intelicolumn66.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn66.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn66.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn66.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn66.Name = "ColMin11"
Intelicolumn67.Tag = "OCULTAR MINIMO"
Intelicolumn67.ColumnOrder = 17
Intelicolumn67.ControlSource = "est_min_12"
Intelicolumn67.ReadOnly = .F.
Intelicolumn67.ForeColor = 70,70,70
Intelicolumn67.LSUBSTITUIRTEXT = .F.
Intelicolumn67.Lhabilitarpesquisa = .F.
Intelicolumn67.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn67.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn67.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn67.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn67.Name = "ColMin12"
Intelicolumn68.Tag = "OCULTAR MINIMO"
Intelicolumn68.ColumnOrder = 18
Intelicolumn68.ControlSource = "est_min_13"
Intelicolumn68.ReadOnly = .F.
Intelicolumn68.ForeColor = 70,70,70
Intelicolumn68.Lhabilitarpesquisa = .F.
Intelicolumn68.LSUBSTITUIRTEXT = .F.
Intelicolumn68.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn68.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn68.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn68.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn68.Name = "ColMin13"
Intelicolumn69.Tag = "OCULTAR MINIMO"
Intelicolumn69.ColumnOrder = 19
Intelicolumn69.ControlSource = "est_min_14"
Intelicolumn69.ReadOnly = .F.
Intelicolumn69.ForeColor = 70,70,70
Intelicolumn69.LSUBSTITUIRTEXT = .F.
Intelicolumn69.Lhabilitarpesquisa = .F.
Intelicolumn69.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';;curListaProd.pedido&gt;0
Intelicolumn69.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn69.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn69.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn69.Name = "ColMin14"
Intelicolumn70.Tag = "OCULTAR MINIMO"
Intelicolumn70.ColumnOrder = 20
Intelicolumn70.ControlSource = "est_min_15"
Intelicolumn70.ReadOnly = .F.
Intelicolumn70.ForeColor = 70,70,70
Intelicolumn70.Lhabilitarpesquisa = .F.
Intelicolumn70.LSUBSTITUIRTEXT = .F.
Intelicolumn70.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0;
Intelicolumn70.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn70.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn70.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn70.Name = "ColMin15"
Intelicolumn71.Tag = "OCULTAR"
Intelicolumn71.ColumnOrder = 29
Intelicolumn71.ControlSource = "Est_Ideal_8"
Intelicolumn71.ReadOnly = .F.
Intelicolumn71.Visible = .T.
Intelicolumn71.ForeColor = 70,70,70
Intelicolumn71.BackColor = 212,208,200
Intelicolumn71.Dyna_back_conditions = 1=1
Intelicolumn71.Dyna_backcolors = rgb(168,218,255)
Intelicolumn71.LSUBSTITUIRTEXT = .F.
Intelicolumn71.Name = "Col_Ideal8"
Intelicolumn72.Tag = "OCULTAR"
Intelicolumn72.ColumnOrder = 30
Intelicolumn72.ControlSource = "Est_Ideal_9"
Intelicolumn72.ReadOnly = .F.
Intelicolumn72.Visible = .T.
Intelicolumn72.ForeColor = 70,70,70
Intelicolumn72.BackColor = 212,208,200
Intelicolumn72.Dyna_back_conditions = 1=1
Intelicolumn72.Dyna_backcolors = rgb(150,194,150)
Intelicolumn72.LSUBSTITUIRTEXT = .F.
Intelicolumn72.Name = "Col_Ideal9"
Intelicolumn73.Tag = "OCULTAR"
Intelicolumn73.ColumnOrder = 31
Intelicolumn73.ControlSource = "Est_Ideal_10"
Intelicolumn73.ReadOnly = .F.
Intelicolumn73.Visible = .T.
Intelicolumn73.ForeColor = 70,70,70
Intelicolumn73.BackColor = 212,208,200
Intelicolumn73.Dyna_back_conditions = 1=1
Intelicolumn73.Dyna_backcolors = rgb(168,218,255)
Intelicolumn73.LSUBSTITUIRTEXT = .F.
Intelicolumn73.Name = "Col_Ideal10"
Intelicolumn74.Tag = "OCULTAR"
Intelicolumn74.ColumnOrder = 32
Intelicolumn74.ControlSource = "Est_Ideal_11"
Intelicolumn74.ReadOnly = .F.
Intelicolumn74.Visible = .T.
Intelicolumn74.ForeColor = 70,70,70
Intelicolumn74.BackColor = 212,208,200
Intelicolumn74.Dyna_back_conditions = 1=1
Intelicolumn74.Dyna_backcolors = rgb(150,194,150)
Intelicolumn74.LSUBSTITUIRTEXT = .F.
Intelicolumn74.Name = "Col_Ideal11"
Intelicolumn75.Tag = "OCULTAR"
Intelicolumn75.ColumnOrder = 33
Intelicolumn75.ControlSource = "Est_Ideal_12"
Intelicolumn75.ReadOnly = .F.
Intelicolumn75.Visible = .T.
Intelicolumn75.ForeColor = 70,70,70
Intelicolumn75.BackColor = 212,208,200
Intelicolumn75.Dyna_back_conditions = 1=1
Intelicolumn75.Dyna_backcolors = rgb(168,218,255)
Intelicolumn75.LSUBSTITUIRTEXT = .F.
Intelicolumn75.Name = "Col_Ideal12"
Intelicolumn76.Tag = "OCULTAR"
Intelicolumn76.ColumnOrder = 34
Intelicolumn76.ControlSource = "Est_Ideal_13"
Intelicolumn76.ReadOnly = .F.
Intelicolumn76.Visible = .T.
Intelicolumn76.ForeColor = 70,70,70
Intelicolumn76.BackColor = 212,208,200
Intelicolumn76.Dyna_back_conditions = 1=1
Intelicolumn76.Dyna_backcolors = rgb(150,194,150)
Intelicolumn76.LSUBSTITUIRTEXT = .F.
Intelicolumn76.Name = "Col_Ideal13"
Intelicolumn77.Tag = "OCULTAR"
Intelicolumn77.ColumnOrder = 35
Intelicolumn77.ControlSource = "Est_Ideal_14"
Intelicolumn77.ReadOnly = .F.
Intelicolumn77.Visible = .T.
Intelicolumn77.ForeColor = 70,70,70
Intelicolumn77.BackColor = 212,208,200
Intelicolumn77.Dyna_back_conditions = 1=1
Intelicolumn77.Dyna_backcolors = rgb(168,218,255)
Intelicolumn77.LSUBSTITUIRTEXT = .F.
Intelicolumn77.Name = "Col_Ideal14"
Intelicolumn78.Tag = "OCULTAR"
Intelicolumn78.ColumnOrder = 36
Intelicolumn78.ControlSource = "Est_Ideal_15"
Intelicolumn78.ReadOnly = .F.
Intelicolumn78.Visible = .T.
Intelicolumn78.ForeColor = 70,70,70
Intelicolumn78.BackColor = 212,208,200
Intelicolumn78.Dyna_back_conditions = 1=1
Intelicolumn78.Dyna_backcolors = rgb(150,194,150)
Intelicolumn78.LSUBSTITUIRTEXT = .F.
Intelicolumn78.Name = "Col_Ideal15"
Intelicolumn79.Tag = "OCULTAR DISPONIVEL"
Intelicolumn79.ColumnOrder = 46
Intelicolumn79.ControlSource = "est_dis_8"
Intelicolumn79.ReadOnly = .T.
Intelicolumn79.ForeColor = 70,70,70
Intelicolumn79.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn79.Dyna_backcolors = rgb(168,218,255);rgb(200,240,255)
Intelicolumn79.Name = "coldisp08"
Intelicolumn80.Tag = "OCULTAR DISPONIVEL"
Intelicolumn80.ColumnOrder = 47
Intelicolumn80.ControlSource = "est_dis_9"
Intelicolumn80.ReadOnly = .T.
Intelicolumn80.ForeColor = 70,70,70
Intelicolumn80.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn80.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn80.Name = "coldisp09"
Intelicolumn81.Tag = "OCULTAR DISPONIVEL"
Intelicolumn81.ColumnOrder = 48
Intelicolumn81.ControlSource = "est_dis_10"
Intelicolumn81.ReadOnly = .T.
Intelicolumn81.ForeColor = 70,70,70
Intelicolumn81.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn81.Dyna_backcolors = rgb(168,218,255);rgb(200,240,255)
Intelicolumn81.Name = "coldisp10"
Intelicolumn82.Tag = "OCULTAR DISPONIVEL"
Intelicolumn82.ColumnOrder = 49
Intelicolumn82.ControlSource = "est_dis_11"
Intelicolumn82.ReadOnly = .T.
Intelicolumn82.ForeColor = 70,70,70
Intelicolumn82.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn82.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn82.Name = "coldisp11"
Intelicolumn83.Tag = "OCULTAR DISPONIVEL"
Intelicolumn83.ColumnOrder = 50
Intelicolumn83.ControlSource = "est_dis_12"
Intelicolumn83.ReadOnly = .T.
Intelicolumn83.ForeColor = 70,70,70
Intelicolumn83.Dyna_backcolors = rgb(168,218,255);rgb(200,240,255)
Intelicolumn83.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn83.Name = "coldisp12"
Intelicolumn84.Tag = "OCULTAR DISPONIVEL"
Intelicolumn84.ColumnOrder = 51
Intelicolumn84.ControlSource = "est_dis_13"
Intelicolumn84.ReadOnly = .T.
Intelicolumn84.ForeColor = 70,70,70
Intelicolumn84.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn84.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn84.Name = "coldisp13"
Intelicolumn85.Tag = "OCULTAR DISPONIVEL"
Intelicolumn85.ColumnOrder = 52
Intelicolumn85.ControlSource = "est_dis_14"
Intelicolumn85.ReadOnly = .T.
Intelicolumn85.ForeColor = 70,70,70
Intelicolumn85.Dyna_backcolors = rgb(168,218,255);rgb(200,240,255)
Intelicolumn85.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn85.Name = "coldisp14"
Intelicolumn86.Tag = "OCULTAR DISPONIVEL"
Intelicolumn86.ColumnOrder = 53
Intelicolumn86.ControlSource = "est_dis_15"
Intelicolumn86.ReadOnly = .T.
Intelicolumn86.ForeColor = 70,70,70
Intelicolumn86.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn86.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn86.Name = "coldisp15"
Intelicolumn87.Tag = "OCULTAR DISPONIVEL"
Intelicolumn87.ColumnOrder = 62
Intelicolumn87.ControlSource = "est_ven_8"
Intelicolumn87.ReadOnly = .T.
Intelicolumn87.ForeColor = 70,70,70
Intelicolumn87.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn87.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn87.LSUBSTITUIRTEXT = .F.
Intelicolumn87.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn87.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn87.Name = "colFisi08"
Intelicolumn88.Tag = "OCULTAR DISPONIVEL"
Intelicolumn88.ColumnOrder = 63
Intelicolumn88.ControlSource = "est_ven_9"
Intelicolumn88.ReadOnly = .T.
Intelicolumn88.ForeColor = 70,70,70
Intelicolumn88.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn88.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn88.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn88.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn88.LSUBSTITUIRTEXT = .F.
Intelicolumn88.Name = "colFisi09"
Intelicolumn89.Tag = "OCULTAR DISPONIVEL"
Intelicolumn89.ColumnOrder = 64
Intelicolumn89.ControlSource = "est_ven_10"
Intelicolumn89.ReadOnly = .T.
Intelicolumn89.ForeColor = 70,70,70
Intelicolumn89.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn89.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn89.LSUBSTITUIRTEXT = .F.
Intelicolumn89.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn89.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn89.Name = "colFisi10"
Intelicolumn90.Tag = "OCULTAR DISPONIVEL"
Intelicolumn90.ColumnOrder = 65
Intelicolumn90.ControlSource = "est_ven_11"
Intelicolumn90.ReadOnly = .T.
Intelicolumn90.ForeColor = 70,70,70
Intelicolumn90.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn90.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn90.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn90.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn90.LSUBSTITUIRTEXT = .F.
Intelicolumn90.Name = "colFisi11"
Intelicolumn91.Tag = "OCULTAR DISPONIVEL"
Intelicolumn91.ColumnOrder = 66
Intelicolumn91.ControlSource = "est_ven_12"
Intelicolumn91.ReadOnly = .T.
Intelicolumn91.ForeColor = 70,70,70
Intelicolumn91.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn91.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn91.LSUBSTITUIRTEXT = .F.
Intelicolumn91.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn91.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn91.Name = "colFisi12"
Intelicolumn92.Tag = "OCULTAR DISPONIVEL"
Intelicolumn92.ColumnOrder = 67
Intelicolumn92.ControlSource = "est_ven_13"
Intelicolumn92.ReadOnly = .T.
Intelicolumn92.ForeColor = 70,70,70
Intelicolumn92.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn92.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn92.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn92.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn92.LSUBSTITUIRTEXT = .F.
Intelicolumn92.Name = "colFisi13"
Intelicolumn93.Tag = "OCULTAR DISPONIVEL"
Intelicolumn93.ColumnOrder = 68
Intelicolumn93.ControlSource = "est_ven_14"
Intelicolumn93.ReadOnly = .T.
Intelicolumn93.ForeColor = 70,70,70
Intelicolumn93.Dyna_backcolors = rgb(168,218,255);RGB(255,63,63);rgb(200,240,255)
Intelicolumn93.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn93.LSUBSTITUIRTEXT = .F.
Intelicolumn93.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn93.Dyna_forecolors = rgb(168,218,255);rgb(200,10,10);RGB(255,255,255)
Intelicolumn93.Name = "colFisi14"
Intelicolumn94.Tag = "OCULTAR DISPONIVEL"
Intelicolumn94.ColumnOrder = 69
Intelicolumn94.ControlSource = "est_ven_15"
Intelicolumn94.ReadOnly = .T.
Intelicolumn94.ForeColor = 70,70,70
Intelicolumn94.Dyna_backcolors = rgb(150,194,150);RGB(255,63,63);rgb(200,240,255)
Intelicolumn94.Dyna_back_conditions = 1=1;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1';curListaProd.pedido&gt;0
Intelicolumn94.Dyna_fore_conditions = @=0 and curListaProd.totalPedido=0;curListaProd.est_minimo&gt;0 and curListaProd.est_venda &lt; curListaProd.est_minimo;Substr(curListaProd.Flags,5,1)='1' OR Substr(curListaProd.Flags,6,1)='1'
Intelicolumn94.Dyna_forecolors = rgb(150,194,150);rgb(200,10,10);RGB(255,255,255)
Intelicolumn94.LSUBSTITUIRTEXT = .F.
Intelicolumn94.Name = "colFisi15"
Intelicolumn95.ColumnOrder = 96
Intelicolumn95.ControlSource = "curListaProd.saldo_emprestimo"
Intelicolumn95.ReadOnly = .T.
Intelicolumn95.ForeColor = 70,70,70
Intelicolumn95.Name = "Intelicolumn95"
Intelicolumn96.ColumnOrder = 93
Intelicolumn96.ControlSource = "grupo_produto"
Intelicolumn96.Width = 223
Intelicolumn96.ReadOnly = .T.
Intelicolumn96.ForeColor = 70,70,70
Intelicolumn96.Name = "Intelicolumn96"
Intelicolumn97.ControlSource = "curListaProd.teste"
Intelicolumn97.Name = "Intelicolumn97"
</properties>
		<protected/>
		<methods>PROCEDURE AfterRowColChange
Lparameters nColIndex

DoDefault(nColIndex)

*!* Raul    #19426  03/04/14: Atualiza as informações complementares ou o histórico de compra e venda

Thisform.InformacoesComplementares_HistoricoCompraVenda()

This.Parent.txtCompraFor.GotFocus()
lcconfig40072 = buscarconfig([40072])
*!* Lucas   #18025  27/01/14: Verifica se o produto usa lote. Se não usar, desabilita o botão Estoque por Lote, caso contrário, habilita o botão.
Select produtos
Locate For Id = curListaProd.Id And usa_lote &gt; 0
If !Found()
	Thisform.PageFrame.page2.cmdestoquelote.Enabled = .F.
Else
	Thisform.PageFrame.page2.cmdestoquelote.Enabled = .T.
Endif

If Type('curListaProd.flags') &lt;&gt; 'U'
	*!* Charles #65380  30/01/19: Alterado para deixar editar coluna "Mínimo" do grid somente se o flag "Fora de linha (Fornec)" não estiver marcado no cadastro de produto.
	*If Substr(curListaProd.Flags,6,1)='1'
	*!* Charles #66365  26/04/19: Alterado para deixar editar coluna "Mínimo" do grid se o flag "Fora de linha (Fornec)" ou ou "Fora de linha (Loja)" não estiver marcado no cadastro de produto.
	*!* Jade    #92658  16/02/22: Ocorria que a loja, tinha estoque de alguns destes produtos "Fora de linha (Fornec)" ou ou "Fora de linha (Loja)" , e usava a tela para [Gerar transferência] por isso precisava poder 'digitar' qtd na coluna Pedido nestes casos.
	*A config 40072 determina se é permitido digitar a qtd na coluna Pedidos, e foi adicionada ao if de manipulação do readonly da coluna em questão.
	*Adicionei também manipulação no readonly das colunas pedido2 e pedido3, pois, não havia, e acabava dando para digitar valor quando não deveria.
	If (Substr(curListaProd.Flags,5,1)='1' Or Substr(curListaProd.Flags,6,1)='1') and lcconfig40072 = 'Não'
		Thisform.PageFrame.page2.gridorder1.Intelicolumn8.Txtinteligrid1.ReadOnly = .T.
		Thisform.PageFrame.page2.gridorder1.Intelicolumn39.Txtinteligrid1.ReadOnly = .T.
		Thisform.PageFrame.page2.gridorder1.Intelicolumn53.Txtinteligrid1.ReadOnly = .T.
	Else
		Thisform.PageFrame.page2.gridorder1.Intelicolumn8.Txtinteligrid1.ReadOnly = .F.
		Thisform.PageFrame.page2.gridorder1.Intelicolumn39.Txtinteligrid1.ReadOnly = .F.
		Thisform.PageFrame.page2.gridorder1.Intelicolumn53.Txtinteligrid1.ReadOnly = .F.

	Endif
EndIf
*!* Matheus #60039  17/08/18: Acrescentado refresh do txtQtdEmbalagem02 para atualizar o campo conforme o produto selecionado.
thisform.pageFrame.page2.txtQtdEmbalagem02.Refresh()
This.Refresh()

ENDPROC
PROCEDURE atribuirvalorpadrao
Lparameters toHead
Private All Like l*

Local lcTabela, lcCampo, lnInput, lnRecno, lcCampo, lcLoja

lcTabela = toHead.Parent.Parent.RecordSource
lcCampo = toHead.Parent.ControlSource

lnInput = Val(Inputbox('Valor:','Valor padrão'))
If lnInput = 0
	If 7 = Messagebox([Deseja atualizar a coluna com o valor zero?],32+4,'Pergunta')
		Return
	Endif
Endif

Select (lcTabela)
lcKeys =  ''
For lnCount = 1 To Tagcount()
	lcKeys = lcKeys + ',' + Key(lnCount)
Endfor

If Lower(lcCampo) $ Lower(lcKeys)
	Set Order To
Endif
lcconfig40072 = buscarconfig([40072])
Select (lcTabela)
lnRecno = Recno()
Scan
	lnAnterior = &amp;lcCampo
	*!* Jade    #92658  08/03/22: Para não atribuir valor padrão em produtos fora de linha e config 40072 com NÃO.
	If !((Substr(curListaProd.Flags,5,1)='1' Or Substr(curListaProd.Flags,6,1)='1') And lcconfig40072 = 'Não')
		Replace &amp;lcCampo With lnInput
	Endif
	*!* Cristof #80704  14/09/20: Alterado para localizar a loja correspondente a coluna do grid, e gravar a informação de estoque (minimo e ideal)
	*!* Cristof #75414  18/02/20: Quando usar a opção de atribuir valor padrão em mais de um produto, então foi preparado para gravar informação no estoque tambem.
	Do Case
		Case '.est_ideal' $ Lower(lcCampo)
			lcIdColuna = Getwordnum(Lower(lcCampo),1,'curlistaprod.est_ideal_')
			lnIdColuna = Int(Val(lcIdColuna))

			If lnIdColuna &gt; 0 And Seek(lnIdColuna,"curLojasAtivas","id_coluna")
				If Thisform.config41007 == 'Sim'
					oEstoque = Createobject([estoque])
				Else
					oEstoque = Createobject([db_est_estoque])
				Endif

				oEstoque.setarestoquereposicao(curListaProd.Id,curLojasAtivas.Id,&amp;lcCampo)

				If lnAnterior &lt;&gt; lnInput
					oSistema.RegistraAuditoria('PRODUTOS', 'ALTERACAO', 'ALTERADO O ESTOQUE IDEAL DA LOJA ' + Transform(curLojasAtivas.Id) + ' DE ' + Alltr(Str(lnAnterior,12,2)) + ' PARA ' + Alltr(Str(lnInput,12,2)), oUsuario.Id, curListaProd.Id)
				Endif
			Endif

		Case '.est_min' $ Lower(lcCampo)
			lcIdColuna = Getwordnum(Lower(lcCampo),1,'curlistaprod.est_min_')
			lnIdColuna = Int(Val(lcIdColuna))

			If lnIdColuna &gt; 0 And Seek(lnIdColuna,"curLojasAtivas","id_coluna")
				If Thisform.config41007 == 'Sim'
					oEstoque = Createobject([estoque])
				Else
					oEstoque = Createobject([db_est_estoque])
				Endif

				oEstoque.setarestoqueminimo(curListaProd.Id,curLojasAtivas.Id,&amp;lcCampo)

				If lnAnterior &lt;&gt; lnInput
					oSistema.RegistraAuditoria('PRODUTOS', 'ALTERACAO', 'ALTERADO O ESTOQUE MÍNIMO DA LOJA ' + Transform(curLojasAtivas.Id) + ' DE ' + Alltr(Str(lnAnterior,12,2)) + ' PARA ' + Alltr(Str(lnInput,12,2)), oUsuario.Id, curListaProd.Id)
				Endif
			Endif


		Otherwise
			This.atribuiuvalorpadrao()
	Endcase

	Select (lcTabela)
Endscan

*!* Charles #76818  18/05/20: Atualiza o campo totalPedido somando o valor dos campos pedido + pedido2 + pedido3 em todos os registros.
If 'pedido' $ Lower(lcCampo)
	Select curListaProd
	Replace totalPedido With pedido + pedido2 + pedido3 All
	Go Top
Endif

Try
	Go lnRecno
Catch To loErro
	Go Top
Endtry

toHead.Parent.Parent.Refresh

ENDPROC
PROCEDURE configurarmenu
DoDefault()

this.vetmenu(1,1) = 'Abrir cadastro do produto'
this.vetmenu(1,2) = 'poFormMenu.AbrirCadastro()'
this.vetmenu(1,3) = 'curListaProd.id &lt;= 0'
this.vetmenu(2,1) = '\-'

this.vetmenu(3,1) = 'Pesquisar pedidos de compra'
this.vetmenu(3,2) = 'poFormMenu.pesq_compras()'
this.vetmenu(3,3) = 'curListaProd.est_pedido &lt;= 0'

this.vetmenu(4,1) = 'Pesquisar vendas para entrega fututra'
this.vetmenu(4,2) = 'poFormMenu.pesq_entregafutura()'
this.vetmenu(4,3) = 'curListaProd.est_vendido &lt;= 0'


this.vetmenu(5,1) = 'Pesquisar remessa para terceiros'
this.vetmenu(5,2) = 'poFormMenu.pesq_terceiros()'
this.vetmenu(5,3) = 'curListaProd.est_terceiros &lt;= 0'

this.vetmenu(6,1) = 'Pesquisar reservas para venda'
this.vetmenu(6,2) = 'poFormMenu.pesq_reservas()'
this.vetmenu(6,3) = 'curListaProd.est_reservado &lt;= 0'


*!*   this.vetmenu(5,1) = 'Pesquisar '
*!*   this.vetmenu(5,2) = 'poFormMenu.AbrirCadastro()'
*!*   this.vetmenu(5,3) = 'curListaProd.est_terceiros &lt;= 0'

this.vetmenu(10,1) = '\-'


ENDPROC
PROCEDURE headerrightclick
Lparameters toHeader As Header

Private All Like l*

Local nOpcao As Byte
nOpcao = 0
Define Popup MenuShortCut ShortCut Relative From Mrow(),Mcol()
Define Bar 4 Of MenuShortCut Prompt "\&lt;Auto-ajustar colunas" Picture "imagens\imgautofit.bmp"
On Selection Bar 4 Of MenuShortCut nOpcao = 4

Define Bar 1 Of MenuShortCut Prompt "\&lt;Configurar colunas" Picture "imagens\imgcoluna.bmp"
On Selection Bar 1 Of MenuShortCut nOpcao = 1

llReadOnly = toHeader.Parent.ReadOnly Or !toHeader.Parent.Enabled Or !toHeader.Parent.Parent.AllowCellSelection

If toHeader.Parent.lMostrarOpcoesBotaoDireito
Do Case
Case "est_min_" $ Lower(toHeader.Parent.ControlSource) or "est_ideal_" $ Lower(toHeader.Parent.ControlSource)
Define Bar 125 Of MenuShortCut Prompt "\-"

This.cExpressaosoma = toHeader.Parent.ControlSource

Define Bar 155 Of MenuShortCut Prompt "\&lt;Somar valores da coluna"
On Selection Bar 155 Of MenuShortCut nOpcao = 155

Define Bar 157 Of MenuShortCut Prompt "Atribuir um valor padrão a esta coluna"
On Selection Bar 157 Of MenuShortCut nOpcao = 157


Case Type(toHeader.Parent.ControlSource)='N'

Define Bar 125 Of MenuShortCut Prompt "\-"

This.cExpressaosoma = toHeader.Parent.ControlSource

Define Bar 155 Of MenuShortCut Prompt "\&lt;Somar valores da coluna"
On Selection Bar 155 Of MenuShortCut nOpcao = 155

If !llReadOnly
If toHeader.Parent.lExibir_AplicarIndiceNosValores
Define Bar 156 Of MenuShortCut Prompt "Aplicar índice nos valores"
On Selection Bar 156 Of MenuShortCut nOpcao = 156
Endif

If toHeader.Parent.lExibir_AplicarIndiceArredondarParaCima
Define Bar 1561 Of MenuShortCut Prompt "Aplicar índice nos valores e arredondar para cima" Message "Aplica um índice nos valores e arredonda para o próximo número inteiro superior."
On Selection Bar 1561 Of MenuShortCut nOpcao = 1561
Endif

If toHeader.Parent.lExibir_AplicarIndiceArredondarParaBaixo
Define Bar 1562 Of MenuShortCut Prompt "Aplicar índice nos valores e arredondar para baixo" Message "Aplica um índice nos valores e arredonda para o número inteiro inferior."
On Selection Bar 1562 Of MenuShortCut nOpcao = 1562
Endif

If toHeader.Parent.lExibir_AtribuirValorPadrao
Define Bar 157 Of MenuShortCut Prompt "Atribuir um valor padrão a esta coluna"
On Selection Bar 157 Of MenuShortCut nOpcao = 157
Endif
Endif

Case Type(toHeader.Parent.ControlSource)='C'
If !llReadOnly

Define Bar 125 Of MenuShortCut Prompt "\-"

If toHeader.Parent.lExibir_SubstituirTodosPorTextoPadrao
Define Bar 158 Of MenuShortCut Prompt "Substituir todos por um texto padrão"
On Selection Bar 158 Of MenuShortCut nOpcao = 158
EndIf

If toHeader.Parent.lExibir_InserirTextoPadraoInicio
Define Bar 159 Of MenuShortCut Prompt "Inserir um texto padrão no início"
On Selection Bar 159 Of MenuShortCut nOpcao = 159
EndIf

If toHeader.Parent.lExibir_InserirTextoPadraoFinal
Define Bar 160 Of MenuShortCut Prompt "Inserir um texto padrão no final"
On Selection Bar 160 Of MenuShortCut nOpcao = 160
EndIf

Endif

Case Type(toHeader.Parent.ControlSource)='L'
*!* Lucas   #01682  14/01/14: Tratamento criado para alterar todos os valores da coluna e esses valores sejam lógico.
If !llReadOnly

Define Bar 125 Of MenuShortCut Prompt "\-"

If toHeader.Parent.lExibir_SubstituirTodosPorFalse
Define Bar 161 Of MenuShortCut Prompt "Substituir todos por .F."
On Selection Bar 161 Of MenuShortCut nOpcao = 161
EndIf

If toHeader.Parent.lExibir_SubstituirTodosPorTrue
Define Bar 125 Of MenuShortCut Prompt "\-"
Define Bar 162 Of MenuShortCut Prompt "Substituir todos por .T."
On Selection Bar 162 Of MenuShortCut nOpcao = 162
EndIf

Endif
Endcase
Endif

Define Bar 1 Of MenuShortCut Prompt "\&lt;Configurar colunas" Picture "imagens\imgcoluna.bmp"
On Selection Bar 1 Of MenuShortCut nOpcao = 1


Define Bar 100 Of MenuShortCut Prompt "\-"

If This.lExportarexcel
Define Bar 2 Of MenuShortCut Prompt "\&lt;Exportar para planilha Excel"
On Selection Bar 2 Of MenuShortCut nOpcao = 2
Define Bar 101 Of MenuShortCut Prompt "\-"
Endif

Define Bar 3 Of MenuShortCut Prompt "\&lt;Gerar gráfico" Picture "imagens\imgchart.bmp"
On Selection Bar 3 Of MenuShortCut nOpcao = 3

Define Bar 102 Of MenuShortCut Prompt "\-"

Define Bar 170 Of MenuShortCut Prompt "\&lt;Filtros"
On Bar 170 Of MenuShortCut Activate Popup POP_FILTROS

*!* POPUP FILTROS
* Define Popup POP_FILTROS Margin Relative Color Scheme 4
Define Popup POP_FILTROS ShortCut Relative
Define Bar 17001 Of POP_FILTROS Prompt "Mostrar somente linhas sem valores (em branco ou zero)"
On Select Bar 17001 Of POP_FILTROS  nOpcao = 17001

Define Bar 17002 Of POP_FILTROS Prompt "Mostrar somente linhas com valores"
On Select Bar 17002 Of POP_FILTROS nOpcao = 17002

Define Bar 17003 Of POP_FILTROS Prompt "\-"

Define Bar 17004 Of POP_FILTROS Prompt "Desfazer todos filtros aplicados"
On Select Bar 17004 Of POP_FILTROS nOpcao = 17004

*!* FIM POPUP FILTROS


Define Bar 103 Of MenuShortCut Prompt "\-"

*!*	lnBar = 10
*!*	logrid = This
*!*	For Each loCol In This.Columns
*!*	   lcCap = Strtran(loCol.Objects(1).Caption,Chr(13)+Chr(10),' ')
*!*	   lcCap = Strtran(loCol.Objects(1).Caption,Chr(13),' ')
*!*	   lcCap = Strtran(loCol.Objects(1).Caption,Chr(10),' ')


*!*	   Define Bar lnBar Of MenuShortCut Prompt lcCap &amp;&amp;Picture "imagens\imgchart.bmp"
*!*	   lcOn = [On Selection Bar lnBar Of MenuShortCut poGrid.MostrarColuna(']+loCol.Name+[')]
*!*	   &amp;lcOn
*!*	   Set Mark Of Bar lnBar Of MenuShortCut To loCol.Visible
*!*	   lnBar = lnBar + 1
*!*	Endfor

Public poGrid
poGrid = This
Activate Popup MenuShortCut
Release poGrid

Do Case
Case nOpcao = 1
executarform('mfrmconfigcolunas',3,This)
Case nOpcao = 2
This.gerarxls()
Case nOpcao = 3
This.gerargrafico()
Case nOpcao = 4
This.ajustarcolunas()
Case nOpcao = 155
This.somarcoluna()
Case nOpcao = 156
This.AplicarIndice(toHeader,'')
Case nOpcao = 1561
This.AplicarIndice(toHeader,'CIMA')
Case nOpcao = 1562
This.AplicarIndice(toHeader,'BAIXO')
Case nOpcao = 157
This.AtribuirValorPadrao(toHeader)
Case nOpcao = 158
This.AtribuirTextoPadrao(toHeader,0)
Case nOpcao = 159
This.AtribuirTextoPadrao(toHeader,1)
Case nOpcao = 160
This.AtribuirTextoPadrao(toHeader,2)
Case nOpcao = 161
This.atribuirvalorlogicopadrao(toHeader,.F.)
Case nOpcao = 162
This.atribuirvalorlogicopadrao(toHeader,.T.)
Case nOpcao = 17001
This.filtrarlinhassemvalores(toHeader)
Case nOpcao = 17002
This.filtrarlinhascomvalores(toHeader)
Case nOpcao = 17004
This.limparfiltros(toHeader)
Endcase




ENDPROC
PROCEDURE Init
DoDefault()

For i = 1 To This.ColumnCount
If 'OCULTAR' $ Upper(This.Columns(i).Tag )
This.Columns(i).Visible = .F.
Endif
If Type('This.Columns(i).textbox_1')='O'
This.Columns(i).textbox_1.lOcultarValorZeroQuandoReceberFoco = .T.
Endif

If Type('This.Columns(i).txtinteligrid1')='O'
This.Columns(i).txtinteligrid1.lOcultarValorZeroQuandoReceberFoco = .T.
Endif

If Type('This.Columns(i).text1b')='O'
This.Columns(i).text1b.lOcultarValorZeroQuandoReceberFoco = .T.
Endif

EndFor

*!* Gabriel #58012  29/06/18: Ajuste na propriedade ControlSource da coluna 13 (InteliColumn13) para colocar o valor de pedido 3 no calculo.

ENDPROC
PROCEDURE Scrolled
LPARAMETERS nDirection

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn1</parent>
		<properties>Caption = "Descrição"
ToolTipText = "Descrição do produto"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80OFBRX</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn1</parent>
		<properties>Format = "!"
Left = 99
ReadOnly = .T.
Top = 34
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
executarform('frmcadprodutos',.t.,curlistaprod.id )
ENDPROC
PROCEDURE LostFocus
If !Alltrim(Upper(This.Value)) == Alltrim(Upper(This.Tag))
oProd = Createobject([db_produtos])
oProd.Atualizarcampo(curListaProd.Id,'nome',Upper(This.Value))
Release oProd
Endif
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YL15A</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn2</parent>
		<properties>Caption = "Código"
ToolTipText = "Código do produto"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn2</parent>
		<properties>Alignment = 2
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd

*!* Raul    #19426  30/04/14: Comentado o código que atribuia novo valor ao caption do controle lbSelecao
Do Case
Case Empty(Thisform.cSelcodigoinicial) Or (!Empty(Thisform.cSelcodigoinicial) And !Empty(Thisform.cSelcodigofinal))
Thisform.cSelcodigoinicial = curListaProd.codigo
Thisform.cSelcodigofinal = ''
*thisform.pageFrame.page2.lblselecao.Caption = Thisform.cSelcodigoinicial +' até ?????? '
Case Empty(Thisform.cSelcodigofinal)
Thisform.cSelcodigofinal = curListaProd.codigo
*thisform.pageFrame.page2.lblselecao.Caption = Thisform.cSelcodigoinicial +' até '+Thisform.cSelcodigofinal
Otherwise
*thisform.pageFrame.page2.lblselecao.Caption = ''
Endcase

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YYPHY</uniqueid>
		<timestamp>988259485</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn3</parent>
		<properties>Caption = "Preço Compra"
ToolTipText = "Preço de compra"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YYPHZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn3</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
this.Parent.Tag = Str(this.Parent.gettextvalue(),12,2)

ENDPROC
PROCEDURE LostFocus
If ! this.Parent.Tag == Str(this.Parent.gettextvalue(),12,2) And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
oProd = Createobject([db_produtos])
oProd.Atualizarcampo(curListaProd.Id,'preco_compra',this.Parent.gettextvalue())
Release oProd
Endif


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q1</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn4</parent>
		<properties>Caption = "Mínimo"
ToolTipText = "Estoque mínimo"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1Y40XZRWE</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn4</parent>
		<properties>Left = 34
ReadOnly = .T.
Top = 44
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl
If nKeyCode &gt; 0 and Chr(nKeyCode) $ '0987654321.'
NoDefault
endIf
ENDPROC
PROCEDURE LostFocus
*!*	If ! this.Parent.Tag == Str(this.value,12,2) &amp;&amp;And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
*!*	   oProd = Createobject([db_produtos])
*!*	   oProd.Atualizarcampo(curListaProd.Id,'est_minimo',this.value)
*!*	   Release oProd
*!*	Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YYPI1</uniqueid>
		<timestamp>1046561463</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn5</parent>
		<properties>Caption = "Físico"
ToolTipText = "Estoque disponível para venda"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YYPI2</uniqueid>
		<timestamp>894523613</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn5</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0YYPI3</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn6</parent>
		<properties>Caption = "A receber"
ToolTipText = "Estoque a receber (comprado)"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80T2XFP</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn6</parent>
		<properties>Left = 35
Top = 29
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
thisform.pesq_compras()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0ZDL5C</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn7</parent>
		<properties>Caption = "Defeito"
ToolTipText = "Estoque com defeito"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q5</uniqueid>
		<timestamp>894523613</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn7</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q6</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn8</parent>
		<properties>Caption = "Pedido"
ToolTipText = "Quantidade neste pedido de compra"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
this.ToolTipText = [Sugestão de quantidade a fazer um pedido baseado na opção marcada na pagina anterior]

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q7</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn8</parent>
		<properties>ControlSource = "curListaProd.pedido"
Left = 52
Top = 29
ForeColor = 70,70,70
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
this.Tag = Str(this.Value,10,2)
ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl
If nKeyCode = 13
Nodefault
Keyboard '{DNARROW}'
Endif


ENDPROC
PROCEDURE LostFocus
IF VAL(THIS.TAG) &lt;&gt; THIS.VALUE
*!* 07/06/2011 JULIANO-VAIO: Adicionada mensagem para avisar o ususario de
*!* de que a qtd informada nao se enquadra na multiplicacao pela qtd dentro da embalagem.
IF curListaProd.qtd_embalagem &gt; 0
lnResto = MOD(THIS.VALUE,curListaProd.qtd_embalagem)
IF lnResto &gt; 0
MESSAGEBOX([AVISO: Este produto é comprado por embalagem.]+CHR(13)+CHR(13)+;
[Você deve somar mais ]+ALLTRIM(STR(curListaProd.qtd_embalagem-lnResto))+[ unidade(s) no pedido para completar a embalagem.],64,'Informação')

IF THISFORM.PAGEFRAME.page2.checkbox_2.VALUE
REPLACE curListaProd.pedido WITH VAL(THIS.TAG)
ENDIF

*!* Caroline #54602  23/02/18: DEVE INFORMAR QUE A qtd não atinge a daq embalagem, mas continuar o processo
*Return
ENDIF
lnQntdDistr = curListaProd.pedido / curListaProd.qtd_embalagem
ELSE
lnQntdDistr = curListaProd.pedido
ENDIF

*!* 08/06/12 - Juliano: DEU PAU NA ZONA NOVA QDO NAO EXISTE registro carregado em loFornecedor
*!* acho que esta validacao pode ser feita ao encerrar o pedido.
*!*	   If lnQntdDistr &gt; curListaProd.est_distribuidor And Thisform.loFornecedor.distribuidor = 1
*!*	      Messagebox([A quantidade informada para pedido ultrapassa o disponivel na distribuidora.],64,'Informação')
*!*	   Endif


*!*	neste bloco ajustar as quantidades do kit
SELECT curListaProd
REPLACE curListaProd.pedido WITH THIS.VALUE
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
lcdistribuidor = curListaProd.cod_distri

SCAN FOR cod_distri = lcdistribuidor AND !EMPTY(cod_distri)
IF curListaProd.qtd_embalagem &gt; 0
REPLACE curListaProd.pedido WITH (curListaProd.qtd_embalagem * lnQntdDistr)
ELSE
REPLACE curListaProd.pedido WITH lnQntdDistr
ENDIF
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
ENDSCAN

THISFORM.calcularTotal()
*!*	thisform.pageFrame.page2.gridorder1.Refresh()

ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn9</parent>
		<properties>Caption = "Mostruário"
ToolTipText = "Estoque em mostruário"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q8</uniqueid>
		<timestamp>894523613</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn9</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q3</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn10</parent>
		<properties>Caption = "Em Terceiros"
ToolTipText = "Estoque enviados para assistência ou troca com retorno"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q4</uniqueid>
		<timestamp>894523613</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn10</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y8QJG</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colReservado</parent>
		<properties>Caption = "Reservado"
ToolTipText = "Estoque reservado para venda"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80T2XFU</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colReservado</parent>
		<properties>Left = 14
Top = 24
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
thisform.pesq_reservas()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VH11BUUG</uniqueid>
		<timestamp>999326583</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colEF</parent>
		<properties>Caption = "Ent. Fut."
ToolTipText = "Estoque para entrega futura"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80T2XFV</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colEF</parent>
		<properties>Left = 20
Top = 34
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
thisform.pesq_entregafutura()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0ZKK00</uniqueid>
		<timestamp>894524151</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn13</parent>
		<properties>Caption = "Valor Total"
ToolTipText = "Valor total pedido"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RH0ZKK01</uniqueid>
		<timestamp>894523613</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn13</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80TVMT6</uniqueid>
		<timestamp>921392133</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn14</parent>
		<properties>Caption = "V.Média"
ToolTipText = "Venda média durante o período informado (Qtd)"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80TVMT7</uniqueid>
		<timestamp>894529293</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn14</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 0,0,160
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26H0XRYM3</uniqueid>
		<timestamp>925728176</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn15</parent>
		<properties>Caption = "Peso"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26H0XRYM4</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn15</parent>
		<properties>Left = 15
ReadOnly = .F.
Top = 31
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE LostFocus
If ! This.Parent.Tag == Str(This.Value,12,2) &amp;&amp;And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
oProd = Createobject([db_produtos])
oProd.Atualizarcampo(curListaProd.Id,'peso',This.Value)
Release oProd

Replace curListaProd.peso With This.Value in curListaProd
Thisform.calcularTotal()
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2OZ186PPD</uniqueid>
		<timestamp>1361987015</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin01</parent>
		<properties>Caption = "Mín 01"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PJ0T1DKE</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin01</parent>
		<properties>Left = 46
ReadOnly = .F.
Top = 56
locultarvalorzeroquandoreceberfoco = .T.
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

*!*	qtd_embalagem = Thisform.PageFrame.page2.txtindice.Value

*!*	If qtd_embalagem &gt; 0
*!*	*!* Tiago   #13047  11/06/13: Se o resto da divisão entre est_min e qtd_embalagem for maior que zero entra.
*!*		If   Mod(est_min_1,qtd_embalagem) &gt; 0
*!*	*!* Tiago   #13047  11/06/13: Calculando o valor múltiplo da embalagem e o estoque minimo.
*!*			This.Value = Int((est_min_1/qtd_embalagem)+1) * qtd_embalagem
*!*	*Replace est_min_1 With multiplo
*!*		Endif
*!*	Else
*!*	*!* Tiago   #13047  11/06/13: Caso o qtd_embalagem do produto estiver zerado faz o calculo normalmanete sem precisar do valor múltiplo.
*!*		Replace est_min_1 With Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)
*!*	Endif

ENDPROC
PROCEDURE GotFocus
DoDefault()

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 1

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna   = 1
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2OZ18QL8Q</uniqueid>
		<timestamp>1361987015</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin02</parent>
		<properties>Caption = "Mín 02"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PJ0TAG6F</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin02</parent>
		<properties>Left = 25
Top = 41
locultarvalorzeroquandoreceberfoco = .T.
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
DoDefault()

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 2

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 2
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2OZ18V229</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin03</parent>
		<properties>Caption = "Mín 03"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2YD0P71HU</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin03</parent>
		<properties>Left = 24
Top = 46
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
DoDefault()

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 3

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 3
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2OZ18V22B</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin04</parent>
		<properties>Caption = "Mín 04"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2YD0P71HV</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin04</parent>
		<properties>Left = 53
Top = 66
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
DoDefault()

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 4

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 4
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2OZ18V22D</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin05</parent>
		<properties>Caption = "Mín 05"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_42A0MSOOU</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colMin05</parent>
		<properties>Left = 33
Top = 29
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
DoDefault()

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 5

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 5
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PK0TY7QE</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi01</parent>
		<properties>Caption = "Físico 01"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PM0N93RL</uniqueid>
		<timestamp>989746780</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi01</parent>
		<properties>Left = 38
Top = 55
Name = "Textbox_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PK0TY7QG</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi02</parent>
		<properties>Caption = "Físico 02"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PM0N93RM</uniqueid>
		<timestamp>989746780</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi02</parent>
		<properties>Left = 34
Top = 43
Name = "Textbox_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2W90ISX1B</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi03</parent>
		<properties>Caption = "Físico 03"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2W90ISX1C</uniqueid>
		<timestamp>1014515148</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi03</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2Y711YAEL</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi04</parent>
		<properties>Caption = "Físico 04"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2Y711YAEM</uniqueid>
		<timestamp>1019383117</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi04</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_30I10M584</uniqueid>
		<timestamp>1025018016</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn25</parent>
		<properties>Caption = "A transferir"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_30I10M585</uniqueid>
		<timestamp>1317176704</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn25</parent>
		<properties>BorderStyle = 0
ControlSource = "est_transferir"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FU0JYMID</uniqueid>
		<timestamp>1079464961</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn26</parent>
		<properties>Caption = "Distribuidor"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FU0JYMIE</uniqueid>
		<timestamp>1079532578</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn26</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FU0JYMIF</uniqueid>
		<timestamp>1079464961</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn27</parent>
		<properties>Caption = "Vl. Atual"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FU0JYMIG</uniqueid>
		<timestamp>1079733766</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn27</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FV0OB0WH</uniqueid>
		<timestamp>1079532217</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn28</parent>
		<properties>Caption = "Uni. Med."
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FV0OB0WI</uniqueid>
		<timestamp>1079532217</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn28</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JU0OGJFE</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn29</parent>
		<properties>Caption = "Disponível"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
This.ToolTipText = [Estoque atualmente disponivel para venda.] + Chr(13) + [Cálculo: Estoque Venda - Estoque Reservado - Estoque Futura]

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JU0OGJFF</uniqueid>
		<timestamp>1089493799</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn29</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZA</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp01</parent>
		<properties>Caption = "Disponível 01"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZB</uniqueid>
		<timestamp>1089636501</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp01</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZC</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp02</parent>
		<properties>Caption = "Disponível 02"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZD</uniqueid>
		<timestamp>1089636501</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp02</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZE</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp03</parent>
		<properties>Caption = "Disponível 03"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZF</uniqueid>
		<timestamp>1089636501</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp03</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZG</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp04</parent>
		<properties>Caption = "Disponível 04"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JW10IKZH</uniqueid>
		<timestamp>1089636501</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp04</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3LS0LCZSV</uniqueid>
		<timestamp>1094209344</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn34</parent>
		<properties>Caption = "Uni. Med."
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3LS0LCZSW</uniqueid>
		<timestamp>1094209344</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn34</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3UV107JKB</uniqueid>
		<timestamp>1125157933</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn35</parent>
		<properties>Caption = "Ref. Produto"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3UV107JKC</uniqueid>
		<timestamp>1125156912</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn35</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0LK517</uniqueid>
		<timestamp>1149456513</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn36</parent>
		<properties>Caption = "Ord. Estoque"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41B0LK518</uniqueid>
		<timestamp>1149456513</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn36</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4200W22G5</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp05</parent>
		<properties>Caption = "Disponível 05"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4200W22G6</uniqueid>
		<timestamp>1151104854</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp05</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4200W22G7</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi05</parent>
		<properties>Caption = "Físico 05"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4200W22G8</uniqueid>
		<timestamp>1151104854</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi05</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4C20NF77V</uniqueid>
		<timestamp>1184323598</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn39</parent>
		<properties>Caption = "Pedido 02"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0QGVD9</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn39</parent>
		<properties>Left = 20
Top = 24
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
this.Tag = Str(this.Value,10,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl
If nKeyCode = 13
Nodefault
Keyboard '{DNARROW}'
Endif

ENDPROC
PROCEDURE LostFocus
IF VAL(THIS.TAG) &lt;&gt; THIS.VALUE
*!* 07/06/2011 JULIANO-VAIO: Adicionada mensagem para avisar o ususario de
*!* de que a qtd informada nao se enquadra na multiplicacao pela qtd dentro da embalagem.
IF curListaProd.qtd_embalagem &gt; 0
lnResto = MOD(THIS.VALUE,curListaProd.qtd_embalagem)
IF lnResto &gt; 0
MESSAGEBOX([AVISO: Este produto é comprado por embalagem.]+CHR(13)+CHR(13)+;
[Você deve somar mais ]+ALLTRIM(STR(curListaProd.qtd_embalagem-lnResto))+[ unidade(s) no pedido para completar a embalagem.],64,'Informação')

IF THISFORM.PAGEFRAME.page2.checkbox_2.VALUE
REPLACE curListaProd.pedido2 WITH VAL(THIS.TAG)
ENDIF

RETURN
ENDIF
lnQntdDistr = curListaProd.pedido2 / curListaProd.qtd_embalagem
ELSE
lnQntdDistr = curListaProd.pedido2
ENDIF

*!* 08/06/12 - Juliano: DEU PAU NA ZONA NOVA QDO NAO EXISTE registro carregado em loFornecedor
*!* acho que esta validacao pode ser feita ao encerrar o pedido.
*!*	   If lnQntdDistr &gt; curListaProd.est_distribuidor And Thisform.loFornecedor.distribuidor = 1
*!*	      Messagebox([A quantidade informada para pedido ultrapassa o disponivel na distribuidora.],64,'Informação')
*!*	   Endif


*!*	neste bloco ajustar as quantidades do kit
SELECT curListaProd
REPLACE curListaProd.pedido2 WITH THIS.VALUE
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
lcdistribuidor = curListaProd.cod_distri

SCAN FOR cod_distri = lcdistribuidor AND !EMPTY(cod_distri)
IF curListaProd.qtd_embalagem &gt; 0
REPLACE curListaProd.pedido2 WITH (curListaProd.qtd_embalagem * lnQntdDistr)
ELSE
REPLACE curListaProd.pedido2 WITH lnQntdDistr
ENDIF
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
ENDSCAN

THISFORM.calcularTotal()

*!*	thisform.pageFrame.page2.gridorder1.Refresh()

ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4C20NF77X</uniqueid>
		<timestamp>1184323598</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn40</parent>
		<properties>Caption = "V. Média 02"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4C20NF77Y</uniqueid>
		<timestamp>1184323598</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn40</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT04</uniqueid>
		<timestamp>1187740678</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal</parent>
		<properties>Caption = "Est. Ideal"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT05</uniqueid>
		<timestamp>1361752452</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal</parent>
		<properties>BorderStyle = 0
Margin = 0
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT06</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal1</parent>
		<properties>Caption = "Est. Ideal 01"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4F00UCHHS</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal1</parent>
		<properties>Height = 5
Left = 16
Margin = 0
Top = 24
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedBackColor = 58,110,165
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 1

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 1
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT08</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal2</parent>
		<properties>Caption = "Est. Ideal 02"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4F00V1ZEM</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal2</parent>
		<properties>Left = 14
Margin = 0
Top = 29
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedBackColor = 58,110,165
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 2

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 2
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT0A</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal3</parent>
		<properties>Caption = "Est. Ideal 03"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4F00V1ZEN</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal3</parent>
		<properties>Left = 19
Margin = 0
Top = 24
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedBackColor = 58,110,165
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 3

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 3
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, this.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT0C</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal4</parent>
		<properties>Caption = "Est. Ideal 04"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4F00VU1IG</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal4</parent>
		<properties>Left = 21
Margin = 0
Top = 29
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedBackColor = 58,110,165
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 4

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 4
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XAT0E</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal5</parent>
		<properties>Caption = "Est. Ideal 05"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4F00VU1IH</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.col_Ideal5</parent>
		<properties>Left = 6
Margin = 0
Top = 29
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedBackColor = 58,110,0
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 5

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 5
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4R911KVVZ</uniqueid>
		<timestamp>1230212154</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn47</parent>
		<properties>Caption = "Estoque RD"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4R911KVW0</uniqueid>
		<timestamp>1230212154</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn47</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK102</uniqueid>
		<timestamp>1230999415</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn48</parent>
		<properties>Caption = "Total Vendas Mês 1"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK103</uniqueid>
		<timestamp>1334991075</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn48</parent>
		<properties>BorderStyle = 0
Margin = 0
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK104</uniqueid>
		<timestamp>1230999415</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn49</parent>
		<properties>Caption = "Total Vendas Mês 2"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK105</uniqueid>
		<timestamp>1334991075</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn49</parent>
		<properties>BorderStyle = 0
Margin = 0
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK106</uniqueid>
		<timestamp>1230999415</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn50</parent>
		<properties>Caption = "Total Vendas Mês 3"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK107</uniqueid>
		<timestamp>1334991075</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn50</parent>
		<properties>BorderStyle = 0
Margin = 0
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK108</uniqueid>
		<timestamp>1230999415</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn51</parent>
		<properties>Caption = "Total Vendas Mês 4"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RL0VK109</uniqueid>
		<timestamp>1334991075</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn51</parent>
		<properties>BorderStyle = 0
Margin = 0
Visible = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_55V0MJVYV</uniqueid>
		<timestamp>1283086381</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn52</parent>
		<properties>Caption = "V. Média 03"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_55V0MJVYW</uniqueid>
		<timestamp>1283086381</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn52</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_55V0MJVYX</uniqueid>
		<timestamp>1283086381</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn53</parent>
		<properties>Caption = "Pedido 03"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_55V0MJVYY</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>txtinteligrid</class>
		<classloc>..\classes\inteligrid.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtinteligrid1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn53</parent>
		<properties>Left = 23
ReadOnly = .F.
Top = 24
Name = "Txtinteligrid1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
this.Tag = Str(this.Value,10,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl
If nKeyCode = 13
Nodefault
Keyboard '{DNARROW}'
Endif

ENDPROC
PROCEDURE LostFocus
IF VAL(THIS.TAG) &lt;&gt; THIS.VALUE
*!* 07/06/2011 JULIANO-VAIO: Adicionada mensagem para avisar o ususario de
*!* de que a qtd informada nao se enquadra na multiplicacao pela qtd dentro da embalagem.
IF curListaProd.qtd_embalagem &gt; 0
lnResto = MOD(THIS.VALUE,curListaProd.qtd_embalagem)
IF lnResto &gt; 0
MESSAGEBOX([AVISO: Este produto é comprado por embalagem.]+CHR(13)+CHR(13)+;
[Você deve somar mais ]+ALLTRIM(STR(curListaProd.qtd_embalagem-lnResto))+[ unidade(s) no pedido para completar a embalagem.],64,'Informação')

IF THISFORM.PAGEFRAME.page2.checkbox_2.VALUE
REPLACE curListaProd.pedido3 WITH VAL(THIS.TAG)
ENDIF

RETURN
ENDIF
lnQntdDistr = curListaProd.pedido3 / curListaProd.qtd_embalagem
ELSE
lnQntdDistr = curListaProd.pedido3
ENDIF

*!* 08/06/12 - Juliano: DEU PAU NA ZONA NOVA QDO NAO EXISTE registro carregado em loFornecedor
*!* acho que esta validacao pode ser feita ao encerrar o pedido.
*!*	   If lnQntdDistr &gt; curListaProd.est_distribuidor And Thisform.loFornecedor.distribuidor = 1
*!*	      Messagebox([A quantidade informada para pedido ultrapassa o disponivel na distribuidora.],64,'Informação')
*!*	   Endif


*!*	neste bloco ajustar as quantidades do kit
SELECT curListaProd
REPLACE curListaProd.pedido3 WITH THIS.VALUE
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
lcdistribuidor = curListaProd.cod_distri

SCAN FOR cod_distri = lcdistribuidor AND !EMPTY(cod_distri)
IF curListaProd.qtd_embalagem &gt; 0
REPLACE curListaProd.pedido3 WITH (curListaProd.qtd_embalagem * lnQntdDistr)
ELSE
REPLACE curListaProd.pedido3 WITH lnQntdDistr
ENDIF
REPLACE curListaProd.totalPedido WITH curListaProd.pedido + curListaProd.pedido2 + curListaProd.pedido3
ENDSCAN

THISFORM.calcularTotal()
*!*	thisform.pageFrame.page2.gridorder1.Refresh()

ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I011JEX6</uniqueid>
		<timestamp>1321503741</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn54</parent>
		<properties>Caption = "Litragem"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I011JEX7</uniqueid>
		<timestamp>1321503741</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn54</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW4</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColFisi06</parent>
		<properties>Caption = "Físico 06"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW5</uniqueid>
		<timestamp>1334544580</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColFisi06</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW6</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp06</parent>
		<properties>Caption = "Disponível 06"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW7</uniqueid>
		<timestamp>1334544580</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp06</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW8</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin06</parent>
		<properties>Caption = "Mín 06"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNW9</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin06</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 6

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 6
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWA</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColFisi07</parent>
		<properties>Caption = "Físico 07"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWB</uniqueid>
		<timestamp>1334544580</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColFisi07</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWC</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp07</parent>
		<properties>Caption = "Disponível 07"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWD</uniqueid>
		<timestamp>1334544580</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp07</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWE</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin07</parent>
		<properties>Caption = "Mín 07"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NA10VNWF</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin07</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 7

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 7
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NG0L6Q7C</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal6</parent>
		<properties>Caption = "Est. Ideal 06"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NG0L6Q7D</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal6</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,200
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 6

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 6
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NG0L6Q7E</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal7</parent>
		<properties>Caption = "Est. Ideal 07"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NG0L6Q7F</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal7</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
Visible = .T.
ForeColor = 0,0,0
BackColor = 212,208,202
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 7

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 7
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9K</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin08</parent>
		<properties>Caption = "Mín 08"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9L</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin08</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 8

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna = 8
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9M</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin09</parent>
		<properties>Caption = "Mín 09"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9N</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin09</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 9

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 9
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9O</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin10</parent>
		<properties>Caption = "Mín 10"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9P</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin10</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 10

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 10
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9Q</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin11</parent>
		<properties>Caption = "Mín 11"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9R</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin11</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 11

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 11
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9S</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin12</parent>
		<properties>Caption = "Mín 12"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9T</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin12</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 12

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 12
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9U</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin13</parent>
		<properties>Caption = "Mín 13"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9V</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin13</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus

This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 13

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 13
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9W</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin14</parent>
		<properties>Caption = "Mín 14"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9X</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin14</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 14

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna  = 14
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9Y</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin15</parent>
		<properties>Caption = "Mín 15"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY100M9Z</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.ColMin15</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .F.
ForeColor = 70,70,70
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
Select curListaProd
This.Value = Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)

ENDPROC
PROCEDURE GotFocus
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE KeyPress
Lparameters nKeyCode, nShiftAltCtrl

Do Case
Case nKeyCode &gt; 0 And Chr(nKeyCode)='M'
	Nodefault
	This.DblClick()

Otherwise
	*DoDefault(nKeyCode, nShiftAltCtrl)
Endcase

ENDPROC
PROCEDURE LostFocus
Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de MINIMO da Coluna 15

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "MINIMO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna = 15
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0H</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal8</parent>
		<properties>Caption = "Est. Ideal 08"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0I</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal8</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 8

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 8
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0J</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal9</parent>
		<properties>Caption = "Est. Ideal 09"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0K</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal9</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 9

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 9
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0L</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal10</parent>
		<properties>Caption = "Est. Ideal 10"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0M</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal10</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 10

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 10
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0N</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal11</parent>
		<properties>Caption = "Est. Ideal 11"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0O</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal11</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 11

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 11
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0P</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal12</parent>
		<properties>Caption = "Est. Ideal 12"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0Q</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal12</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 12

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 12
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0R</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal13</parent>
		<properties>Caption = "Est. Ideal 13"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0S</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal13</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 13

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 13
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0T</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal14</parent>
		<properties>Caption = "Est. Ideal 14"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0U</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal14</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 14

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 14
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0V</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal15</parent>
		<properties>Caption = "Est. Ideal 15"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5UY157G0W</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Col_Ideal15</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
DoDefault()
This.Tag = Str(This.Value,12,2)

ENDPROC
PROCEDURE LostFocus
DoDefault()

Private All Like l*

*!* Cristof #80704  11/09/20: Chamada ao método "SetarEstoqueProduto()" para gravar o estoque de REPOSICAO da Coluna 15

If ! This.Tag == Str(This.Value,12,2)

	lcTipoEstoque = "REPOSICAO"
	lnIdProduto   = curlistaProd.Id
	lnIdColuna      = 15
	lnValor       = This.Value

thisform.SetarEstoqueProduto(lcTipoEstoque, lnIdProduto, lnIdColuna, lnValor, This.Tag)

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHF</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp08</parent>
		<properties>Caption = "Disponível 08"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHG</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp08</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHH</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp09</parent>
		<properties>Caption = "Disponível 09"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHI</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp09</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHJ</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp10</parent>
		<properties>Caption = "Disponível 10"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHK</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp10</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHL</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp11</parent>
		<properties>Caption = "Disponível 11"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHM</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp11</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHN</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp12</parent>
		<properties>Caption = "Disponível 12"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHO</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp12</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHP</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp13</parent>
		<properties>Caption = "Disponível 13"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHQ</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp13</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHR</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp14</parent>
		<properties>Caption = "Disponível 14"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHS</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp14</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHT</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp15</parent>
		<properties>Caption = "Disponível 15"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHU</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.coldisp15</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHV</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi08</parent>
		<properties>Caption = "Físico 08"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHW</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi08</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHX</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi09</parent>
		<properties>Caption = "Físico 09"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHY</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi09</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRHZ</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi10</parent>
		<properties>Caption = "Físico 10"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI0</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi10</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI1</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi11</parent>
		<properties>Caption = "Físico 11"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI2</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi11</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI3</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi12</parent>
		<properties>Caption = "Físico 12"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI4</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi12</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI5</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi13</parent>
		<properties>Caption = "Físico 13"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI6</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi13</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI7</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi14</parent>
		<properties>Caption = "Físico 14"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI8</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi14</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRI9</uniqueid>
		<timestamp>1361987367</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi15</parent>
		<properties>Caption = "Físico 15"
WordWrap = .T.
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5V003PRIA</uniqueid>
		<timestamp>1361841212</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.colFisi15</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_60L0O9MJL</uniqueid>
		<timestamp>1384077931</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn95</parent>
		<properties>Caption = "Saldos /nEmpréstimos"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_60L0O9MJM</uniqueid>
		<timestamp>1384077931</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn95</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_6AQ0W37R2</uniqueid>
		<timestamp>1417509097</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn96</parent>
		<properties>Caption = "Grupo"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_6AQ0W37R3</uniqueid>
		<timestamp>1417509097</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn96</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_6MI0IAZAI</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>inteliheader</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Inteliheader1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn97</parent>
		<properties>Caption = "Teste"
Name = "Inteliheader1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_6MI0IAZAJ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2.gridorder1.Intelicolumn97</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
SelectedForeColor = 255,255,255
SelectedBackColor = 58,110,165
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 315
Left = 167
Height = 115
Width = 179
ZOrderSet = 8
resizelock = WHL
Name = "Shape_3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Estoque médio:"
Left = 195
Top = 380
TabIndex = 19
ZOrderSet = 9
resizelock = WHL
Name = "Label_4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtEstMedio</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = "curListaProd.Estoque_medio"
Enabled = .F.
Height = 21
Left = 272
TabIndex = 20
ToolTipText = "Estoque médio do produto"
Top = 375
Width = 65
ZOrderSet = 10
resizelock = WHL
Name = "txtEstMedio"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_7</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Última compra:"
Left = 198
Top = 330
TabIndex = 15
ZOrderSet = 11
resizelock = WHL
Name = "Label_7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0XPOZO</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtUltcompra</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Alignment = 1
ControlSource = "curListaProd.ultima_compra"
Enabled = .F.
Height = 21
Left = 272
TabIndex = 16
ToolTipText = "Última compra realizada deste produto"
Top = 325
Width = 65
ZOrderSet = 12
resizelock = WHL
Name = "txtUltcompra"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24O0X8IK1</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_8</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Última venda:"
Left = 203
Top = 355
TabIndex = 17
ZOrderSet = 13
resizelock = WHL
Name = "Label_8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10TAQU</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtUltVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Alignment = 1
ControlSource = "curListaProd.ultima_venda"
Enabled = .F.
Height = 21
Left = 272
TabIndex = 18
ToolTipText = "Última venda realizada deste produto"
Top = 350
Width = 65
ZOrderSet = 14
resizelock = WHL
Name = "txtUltVenda"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3JU10JN0E</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Checkbox_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 291
Left = 255
Height = 15
Width = 185
Alignment = 0
Caption = "\&lt;Criticar quantidade de embalagem."
ControlSource = ""
TabIndex = 3
TabStop = .F.
ZOrderSet = 15
resizelock = LWH
Name = "Checkbox_2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAD</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblResumo</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>AutoSize = .F.
Alignment = 1
Height = 15
Left = 574
Top = 291
Width = 204
TabIndex = 4
ZOrderSet = 16
resizelock = WH
Name = "lblResumo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Checkbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 291
Left = 4
Height = 15
Width = 212
Alignment = 0
Caption = "\&lt;Mostrar apenas itens incluídos no pedido"
ControlSource = ""
TabIndex = 2
TabStop = .F.
ZOrderSet = 17
resizelock = LWH
Name = "Checkbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If This.Value
Select curlistaprod
This.Tag = Str(Recno())
If Thisform.utilizapedidoduaslojas
Set Filter To pedido &gt; 0 or pedido2 &gt; 0 or pedido3 &gt; 0
Else
Set Filter To pedido &gt; 0
Endif
Go Top
Else
Select curlistaprod
Set Filter To

If Val(This.Tag) &gt; 0
Try
Go Val(This.Tag)
Catch
Endtry
Endif
Endif
This.Parent.gridorder1.Refresh
This.Parent.gridorder1.SetFocus


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>spinner_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>spinner</baseclass>
		<objname>spnindice</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Height = 21
Left = 598
TabIndex = 32
ToolTipText = "Informe um índice para aplicar nas quantidades do pedido"
Top = 321
Width = 66
ZOrderSet = 18
resizelock = WHL
Name = "spnindice"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 1.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAG</uniqueid>
		<timestamp>1323061709</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_11</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Ap\&lt;licar:"
Left = 554
Top = 326
TabIndex = 31
ZOrderSet = 19
resizelock = WHL
Name = "Label_11"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAH</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdbase</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdAplicar</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 320
Left = 673
Height = 23
Width = 32
Picture = ..\imagens\imgvisto.bmp
Caption = ""
TabIndex = 33
ToolTipText = "Aplicar índice"
ZOrderSet = 20
resizelock = WHL
Name = "cmdAplicar"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If This.Parent.spnindice.Value = 0
	Messagebox([Informe o índice.],64,'Informação')
	Return
Endif

*!* Tiago   #27723  27/04/15: Se utiliza, guarda a quantidade do pedido2 também.
If Thisform.utilizapedidoduaslojas
	*!* Carlos  #56344  26/03/18: Adicionado campo para quantidade do pedido para loja 3
	Select Id, pedido, pedido2, pedido3 From curListaProd Into Cursor tmpIndice READWRITE
Else
	Select Id, pedido From curListaProd Into Cursor tmpIndice READWRITE
Endif

Select curListaProd
lnId = curListaProd.Id
Replace pedido With pedido * This.Parent.spnindice.Value All

*!* Tiago   #27723  27/04/15: Aplica indice sobre o pedido2 também.
If Thisform.utilizapedidoduaslojas
	Replace pedido2 With pedido2 * This.Parent.spnindice.Value All
	*!* Carlos  #56344  26/03/18: Adicionado campo para quantidade do pedido para loja 3
	Replace pedido3 With pedido3 * This.Parent.spnindice.Value All
Endif

If Thisform.PageFrame.Page1.chkembalagem.Value
	Replace pedido With Ceiling(pedido / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0

*!* Tiago   #27723  27/04/15:
	If Thisform.utilizapedidoduaslojas
		Replace pedido2 With Ceiling(pedido2 / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
		*!* Carlos  #56344  26/03/18: Adicionado campo para quantidade do pedido para loja 3
		Replace pedido3 With Ceiling(pedido3 / qtd_embalagem) * qtd_embalagem For qtd_embalagem &gt; 0
	Endif

Endif
Go Top

Locate For curListaProd.Id = lnId
This.Parent.gridorder1.Refresh
Thisform.calculartotal()
This.Parent.cmddesfaz.Enabled = .T.

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9V</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Preço compra:"
Left = 370
Top = 330
TabIndex = 24
ZOrderSet = 21
resizelock = WHL
Name = "Label_2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9W</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtEstCompra</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = ""
Enabled = .F.
Height = 21
InputMask = "9999,999,999.99"
Left = 443
TabIndex = 25
ToolTipText = "Estoque atual em preço compra"
Top = 325
Width = 92
ZOrderSet = 22
resizelock = WHL
Name = "txtEstCompra"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 0
DoDefault()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAI</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdbase</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDesfaz</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 320
Left = 707
Height = 23
Width = 32
Picture = ..\imagens\imgdesfazer.bmp
Caption = ""
Enabled = .F.
TabIndex = 34
ToolTipText = "Desfazer aplicação de índice"
ZOrderSet = 23
resizelock = WHL
Name = "cmdDesfaz"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Select tmpIndice
Index On Id To idid

Select curListaProd
Set Relation To Id Into tmpIndice
Replace pedido With tmpIndice.pedido All

*!* Tiago   #27723  27/04/15: Voltando as quantidades do pedido2
If Thisform.utilizapedidoduaslojas
	Replace pedido2 With tmpIndice.pedido2 All
	*!* Carlos  #56344  26/03/18: Adicionado campo para quantidade do pedido para loja 3
	Replace pedido3 With tmpIndice.pedido3 All
Endif

Set Relation To
Go Top
Use In tmpIndice
This.Enabled = .F.

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Produto"
Height = 15
Left = 172
Top = 311
Width = 40
TabIndex = 14
ZOrderSet = 24
resizelock = WHL
Name = "Label_shape2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FE9Z</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Total em estoque (em R$):"
Left = 354
Top = 310
TabIndex = 23
ZOrderSet = 25
resizelock = WHL
Name = "Label_shape3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEA0</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Preço venda:"
Left = 375
Top = 355
TabIndex = 26
ZOrderSet = 26
resizelock = WHL
Name = "Label_3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_6</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Mín. preço custo:"
Left = 356
Top = 380
TabIndex = 28
ZOrderSet = 27
resizelock = WHL
Name = "Label_6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061709</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_10</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Preço compra:"
Left = 551
Top = 366
TabIndex = 36
ZOrderSet = 28
resizelock = WHL
Name = "Label_10"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Índice"
Height = 15
Left = 549
Top = 310
Width = 31
TabIndex = 30
ZOrderSet = 29
resizelock = WHL
Name = "Label_shape4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEA4</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtEstMinCusto</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = ""
Enabled = .F.
Height = 21
InputMask = "99,999,999.99"
Left = 443
TabIndex = 29
ToolTipText = "Estoque mínimo em preço de custo"
Top = 375
Width = 92
ZOrderSet = 30
resizelock = WHL
Name = "txtEstMinCusto"
</properties>
		<protected/>
		<methods>PROCEDURE Init
this.Value = 0
DoDefault()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24Q0KKE5G</uniqueid>
		<timestamp>1149866588</timestamp>
		<class>shape_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shape_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 315
Left = 4
Height = 115
Width = 160
ZOrderSet = 31
resizelock = WHL
Name = "Shape_2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1257459137</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_18</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Estoque Pedido"
Left = 214
Top = 441
TabIndex = 46
ZOrderSet = 32
resizelock = WHL
Name = "Label_18"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Pedido \&lt;mínimo:"
Left = 14
Top = 380
TabIndex = 10
ZOrderSet = 33
resizelock = WHL
Name = "Label_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPedMinimo</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = ""
Height = 21
InputMask = "999,999.99"
Left = 89
TabIndex = 11
ToolTipText = "Valor mínimo de pedido para este fornecedor"
Top = 375
Width = 65
ZOrderSet = 34
resizelock = WHL
Name = "txtPedMinimo"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
this.Parent.Tag = Str(this.value,12,2)
ENDPROC
PROCEDURE Init
DoDefault()

this.Value = 0
ENDPROC
PROCEDURE LostFocus
If ! this.Parent.Tag == Str(this.value,12,2) &amp;&amp;And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
oProd = Createobject([db_fornecedores])
oProd.Atualizarcampo(curListaProd.Id_forn1,'ped_minimo',this.value)
Release oProd
Endif
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24Q0KKE5J</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_5</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Última compra:"
Left = 14
Top = 330
TabIndex = 6
ZOrderSet = 35
resizelock = WHL
Name = "Label_5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24Q0KKE5K</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCompraFor</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Alignment = 1
ControlSource = ""
Enabled = .F.
Height = 21
Left = 89
TabIndex = 7
ToolTipText = "Última compra realizada deste fornecedor"
Top = 325
Width = 65
ZOrderSet = 36
resizelock = WHL
Name = "txtCompraFor"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
*!* Charles #65380  30/01/19: Alterado para zerar o campo de Pedido Mínimo somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.

*If Substr(curListaProd.Flags,5,1)='1' Or Substr(curListaProd.Flags,6,1)='1'
*!* Charles #66365  26/04/19: Não zera mais campo Pedido Mínimo se opção "Fora de linha (Fornec)" ou "Fora de linha (Loja)" estiverem marcados.
*!*	If Substr(curListaProd.Flags,6,1)='1'
*!*	   This.Parent.txtPedMinimo.Value = 0
*!*	Endif

If !This.Tag == Str(curListaProd.id_Forn1)
loForn = seekregobj('fornecedores','id',curListaProd.id_Forn1)
This.Parent.txtCompraFor.Value = loForn.dt_ult_compra
This.Parent.txtVendaFor.Value  = loForn.dt_ult_venda

*!* Charles #65380  30/01/19: Alterado para zerar o campo de Pedido Mínimo somente se o flag "Fora de linha (Fornec)" estiver marcado no cadastro de produto.
*If Type('loForn.ped_minimo')&lt;&gt;"U" And ((Substr(curListaProd.Flags,5,1)='0' And Substr(curListaProd.Flags,6,1)='0'))
	*!* Charles #66365  26/04/19: Não zera mais campo Pedido Mínimo se opção "Fora de linha (Fornec)" ou "Fora de linha (Loja)" estiverem marcados.
If Type('loForn.ped_minimo')&lt;&gt;"U"
This.Parent.txtPedMinimo.Value = loForn.ped_minimo
Else
This.Parent.txtPedMinimo.Value = 0
Endif
This.Tag = Str(curListaProd.id_Forn1)
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2520MM8E7</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_14</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Perc. frete:"
Left = 29
Top = 405
TabIndex = 12
ZOrderSet = 37
resizelock = WHL
Name = "Label_14"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2520MM8E8</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtFretes</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Alignment = 1
Enabled = .F.
Height = 21
Left = 89
TabIndex = 13
ToolTipText = "Percentual pago em frete nas últimas 3 compras"
Top = 400
Width = 65
ZOrderSet = 38
resizelock = WHL
Name = "txtFretes"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_9</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Última venda:"
Left = 19
Top = 355
TabIndex = 8
ZOrderSet = 39
resizelock = WHL
Name = "Label_9"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtVendaFor</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Alignment = 1
ControlSource = ""
Enabled = .F.
Height = 21
Left = 89
TabIndex = 9
ToolTipText = "Última venda realizada deste fornecedor"
Top = 350
Width = 65
ZOrderSet = 40
resizelock = WHL
Name = "txtVendaFor"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061709</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_12</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Preço custo:"
Left = 551
Top = 386
TabIndex = 38
ZOrderSet = 41
resizelock = WHL
Name = "Label_12"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_59V0LVUFL</uniqueid>
		<timestamp>1292980627</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_20</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Q\&lt;td na embalagem:"
Left = 569
Top = 441
Visible = .F.
TabIndex = 21
ZOrderSet = 42
resizelock = WHL
Name = "Label_20"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_59V0LVUFM</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtQtdEmbalagem02</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = "curListaProd.qtd_embalagem"
Height = 21
Left = 666
TabIndex = 22
ToolTipText = "Quantidade contida na embalagem do produto"
Top = 436
Visible = .F.
Width = 65
ZOrderSet = 43
resizelock = WHL
Name = "txtQtdEmbalagem02"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
this.Parent.Tag = Str(this.value,12,2)
ENDPROC
PROCEDURE LostFocus
If ! this.Parent.Tag == Str(this.value,12,2) &amp;&amp;And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
oProd = Createobject([db_produtos])
oProd.Atualizarcampo(curListaProd.Id,'qtd_embalagem',this.value)
Release oProd
Endif
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_13</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Q\&lt;td na embalagem:"
Left = 175
Top = 405
TabIndex = 21
ZOrderSet = 42
resizelock = WHL
Name = "Label_13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtQtdEmbalagem</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = "curListaProd.qtd_embalagem"
Height = 21
Left = 272
TabIndex = 22
ToolTipText = "Quantidade contida na embalagem do produto"
Top = 400
Width = 65
ZOrderSet = 43
resizelock = WHL
Name = "txtQtdEmbalagem"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
this.Parent.Tag = Str(this.value,12,2)
ENDPROC
PROCEDURE LostFocus
If ! this.Parent.Tag == Str(this.value,12,2) &amp;&amp;And 6 = Messagebox("Deseja alterar o valor de compra também no cadastro do produto?",32+4,"Informação")
oProd = Createobject([db_produtos])
oProd.Atualizarcampo(curListaProd.Id,'qtd_embalagem',this.value)
Release oProd
Endif
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24Q0KKE5R</uniqueid>
		<timestamp>1323062428</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape5</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Totais:"
Height = 15
Left = 549
Top = 349
Width = 35
TabIndex = 35
ZOrderSet = 44
resizelock = WHL
Name = "Label_shape5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061568</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_15</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Peso (Kg):"
Left = 675
Top = 406
TabIndex = 40
ZOrderSet = 45
resizelock = WHL
Name = "Label_15"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_17</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Nome na Distrib."
Left = 9
Top = 468
Visible = .F.
Width = 81
TabIndex = 50
ZOrderSet = 46
resizelock = WHL
Name = "Label_17"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FV0XZ3T3</uniqueid>
		<timestamp>1257459137</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_19</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Ult. Atualização"
Left = 379
Top = 441
TabIndex = 48
ZOrderSet = 47
resizelock = WHL
Name = "Label_19"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>txtlabel</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtTotal</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>FontBold = .T.
Alignment = 1
Format = "$"
Height = 16
InputMask = "9,999,999.99"
Left = 686
TabIndex = 37
ToolTipText = "Valor total do pedido"
Top = 366
Width = 125
ZOrderSet = 48
resizelock = WHL
Name = "txtTotal"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1323061432</timestamp>
		<class>txtlabel</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtTotalPreCusto</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>FontBold = .T.
Alignment = 1
Format = "$"
Height = 16
InputMask = "9,999,999.99"
Left = 686
TabIndex = 39
ToolTipText = ""
Top = 386
Width = 125
ZOrderSet = 49
resizelock = WHL
Name = "txtTotalPreCusto"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1323061568</timestamp>
		<class>txtlabel</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPesoTotal</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>FontBold = .T.
Alignment = 1
Height = 16
InputMask = "9999999.99"
Left = 711
TabIndex = 41
ToolTipText = ""
Top = 406
Width = 100
ZOrderSet = 50
resizelock = WHL
Name = "txtPesoTotal"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1257459137</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_16</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Índice para o estoque minímo:"
Left = 9
Top = 441
TabIndex = 44
ZOrderSet = 51
resizelock = WHL
Name = "Label_16"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtIndice</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Height = 21
Left = 159
TabIndex = 45
Top = 436
Width = 45
ZOrderSet = 52
resizelock = WHL
Name = "txtIndice"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
this.Value = 2.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = "curListaProd.nome_distri"
Enabled = .F.
Height = 21
Left = 90
TabIndex = 51
Top = 465
Visible = .F.
Width = 316
ZOrderSet = 53
resizelock = WHL
Name = "Textbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
this.Value = 2.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51Q0</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>ControlSource = "curListaProd.est_pedi_distr"
Enabled = .F.
Height = 21
Left = 289
TabIndex = 47
Top = 436
Width = 84
ZOrderSet = 54
resizelock = WHL
Name = "Textbox_2"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
this.Value = 2.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3FV0XZ3T4</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>textbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Textbox_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Value = 
ControlSource = ""
Enabled = .F.
Height = 21
Left = 459
TabIndex = 49
Top = 436
Width = 101
ZOrderSet = 55
resizelock = WHL
Name = "Textbox_3"
</properties>
		<protected/>
		<methods>PROCEDURE Init
DoDefault()
this.Value = 2.00
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2U6106TJ9</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_9</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 9
Height = 25
Width = 116
Caption = "Atualizar"
TabIndex = 64
ToolTipText = "Atualizar estoque mínimo"
ZOrderSet = 56
resizelock = WHL
Name = "Commandbutton_9"
</properties>
		<protected/>
		<methods>PROCEDURE Click
lnEstoque = Val(Inputbox("Informe qual estoque mínimo deve ser atualizado (digite o número da loja)","Atualização de Estoque Mínimo"))
If !Between((lnEstoque),1,2)
	Messagebox([Estoque inválido.],64,'Informação')
	Return
Endif


Select curListaProd
lAtualizar = .F.
lnUltimo = 0
Scan
*!* Tiago   #13047  11/06/13: Comentado o codigo abaixo para passar por todos os registros.

*!*	   If codigo = Thisform.cselcodigoinicial Or codigo = Thisform.cselcodigofinal
*!*	      lAtualizar = !lAtualizar
*!*	      lnUltimo = lnUltimo + 1
*!*	*      Set Step On
*!*	   Endif
*!*	   If lAtualizar Or lnUltimo = 2
*!*	      If lnUltimo = 2
*!*	         lnUltimo = lnUltimo + 1
*!*	      Endif
*!*	If venda_media &gt; 0
	Do Case
	Case lnEstoque = 1
		Replace est_min_1 With Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)
	Case lnEstoque = 2
		Replace est_min_2 With Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)
	Case lnEstoque = 3
		Replace est_min_3 With Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)
	Case lnEstoque = 4
		Replace est_min_4 With Int(venda_media * Thisform.PageFrame.page2.txtindice.Value)
	Endcase
*!*	endif
*!*	   Endif
Endscan
Go Top
Locate For codigo = Thisform.cselcodigoinicial

This.Parent.Refresh

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_11</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 242
Height = 25
Width = 126
Picture = ..\
Caption = "\&lt;Últimas Compras"
TabIndex = 66
ToolTipText = "Visualizar movimento de compra/venda do fornecedor"
ZOrderSet = 57
resizelock = WHL
Name = "Commandbutton_11"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If CurListaProd.id &gt; 0
executarForm('frmdadosultimascompras',.T.,CurListaProd.id)
Else
Messagebox("Nenhum produto foi selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41E0LAP75</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_12</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 494
Height = 25
Width = 155
Picture = ..\
Caption = "Alterar \&lt;Ordem dos Produtos"
TabIndex = 68
ToolTipText = ""
ZOrderSet = 58
resizelock = WHL
Name = "Commandbutton_12"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If Reccount('curListaProd') = 0
Messagebox('Nenhum produto foi selecionado.', 64, 'Informação')
Return
EndIf

ThisForm.AlterarOrdemProdutos()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdHistoricoCompraVenda</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 368
Height = 25
Width = 126
Picture = ..\
Caption = "\&lt;Histórico Compra/Venda"
TabIndex = 67
ToolTipText = "Visualizar histórico de compra/venda"
ZOrderSet = 59
resizelock = WHL
Name = "cmdHistoricoCompraVenda"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If curListaProd.Id = 0
	Messagebox('Nenhum produto foi selecionado.', 64, 'Informação')
	Return
Endif
Thisform.lVisualizarHistoricosCompraVenda = ( !Thisform.lVisualizarHistoricosCompraVenda)
Thisform.DiplayDadosComplementares_HistoricCompraVenda()
Thisform.InformacoesComplementares_HistoricoCompraVenda()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3WK0M67EM</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdestoquelote</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 649
Height = 25
Width = 157
Picture = ..\
Caption = "Estoque \&lt;Lote"
TabIndex = 57
ToolTipText = "Visualizar estoque por lote do produto selecionado"
ZOrderSet = 60
resizelock = WHL
Name = "cmdestoquelote"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
	lnIdLoja = Thisform.PageFrame.page1.cboLojasMultiSelecao.Value
Else
	lnIdLoja = Thisform.PageFrame.page1.cbolojas1.Value
Endif

If curListaProd.Id &gt; 0
	executarform('frmestoque_lote',.T.,curListaProd.Id, lnIdLoja)
Else
	Messagebox([Selecione um produto],64,'Informação')
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2P80WBJW6</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdsalvar</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmdsalvar2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 494
Height = 25
Width = 155
Picture = ..\
Caption = " Gerar \&lt;transferência"
Enabled = .F.
TabIndex = 62
ToolTipText = "Salvar as alterações nos itens do pedido"
ZOrderSet = 61
resizelock = WHL
Name = "Cmdsalvar2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If Used('Cur_itens_transf')
Use In Cur_itens_transf
Endif

Select * From com_transf_itens Where Id = 0 Into Cursor Cur_itens_transf Readwrite

Select Cur_itens_transf
Go Top
If Eof()
Append Blank
Endif

Select curListaProd
Index On Nome Tag Nome
Scan For Pedido &gt; 0
Select Cur_itens_transf
Replace Id With -1, ;
id_produto With curListaProd.Id, ;
codigo With curListaProd.codigo, ;
descricao With curListaProd.Nome, ;
quantidade With curListaProd.Pedido, ;
vl_total With quantidade * curListaProd.preco_custo , ;
pr_custo With curListaProd.preco_custo
Skip
If Eof()
Append Blank
Endif
Endscan
Select Cur_itens_transf
Do While!Eof()
Scatter Blank To vetReg
Gather From vetReg
Skip
Enddo
Go Top
lcXML = ''
Cursortoxml('Cur_itens_transf','lcXml',1,0,0,"1")
*Thisform.cRetorno = lcXML

If 6 = Messagebox([Deseja criar uma nova transferência para estes produtos?]+Chr(13)+Chr(13)+;
'Você pode clicar em Não para pesquisar uma transferência pendente.',32+4,'Pergunta')

executarForm('frmcadtransferencias',.T.,0,lcXML)

Else
lnIdTransf = executarForm('frmpesqtransferencias',3,'situacao=[Pendente]',.T.)
If lnIdTransf &gt; 0
executarForm('frmcadtransferencias',.T.,lnIdTransf,lcXML)
Endif
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24V0XLYJC</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_8</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 649
Height = 25
Width = 157
Picture = ..\
Caption = "\&lt;Formulação de preços"
TabIndex = 63
ToolTipText = "Abre a formulação de preços com os produtos do fornecedor"
ZOrderSet = 62
resizelock = WHL
Name = "Commandbutton_8"
</properties>
		<protected/>
		<methods>PROCEDURE Click

If Thisform.PageFrame.Page1.selfornec.getvalue() &gt; 0
executarform('frmformularpreco',.T.,[ p.inativo = .f. and p.id_forn1 = ]+vfpval(Thisform.PageFrame.Page1.selfornec.getvalue()))
Endif


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdsair</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmdsair1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 649
Height = 25
Width = 157
TabIndex = 69
ToolTipText = "Sair desta tela (sem salvar alterações)"
ZOrderSet = 63
resizelock = WHL
lconfirmarfechamento = .T.
Name = "Cmdsair1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.cRetorno = ''
DoDefault()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAC</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_7</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 368
Height = 25
Width = 126
Caption = "\&lt;Avisos deste fornecedor"
TabIndex = 61
ZOrderSet = 64
resizelock = WHL
Name = "Commandbutton_7"
</properties>
		<protected/>
		<methods>PROCEDURE Click
executarform('frmcom_avisos',.T.,Thisform.pageFrame.page1.selfornec.getvalue())

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdsalvar</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmdsalvar1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 494
Height = 25
Width = 155
Picture = ..\
Caption = " \&lt;Salvar e voltar ao pedido"
TabIndex = 56
ToolTipText = "Salvar as alterações nos itens do pedido"
ZOrderSet = 65
resizelock = WHL
Name = "Cmdsalvar1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*!*	If !Used('Cur_itens')
*!*	   Select * From pedidos_itens Where Id = 0 Into Cursor cur_itens Readwrite
*!*	Endif
*!*	Select cur_itens
*!*	Go Top
*!*	If Eof()
*!*	   Append Blank
*!*	Endif

*!*	Select curListaProd
*!*	Index On Nome Tag Nome
*!*	Scan For Pedido &gt; 0
*!*	   Select cur_itens
*!*	   Replace Id With curListaProd.id_itempedido, ;
*!*	      id_produto With curListaProd.Id, ;
*!*	      codigo With curListaProd.codigo, ;
*!*	      descricao With curListaProd.Nome, ;
*!*	      qtd_pedido With curListaProd.Pedido, ;
*!*	      qtd_recebida With 0, ;
*!*	      pr_custo With curListaProd.preco_compra, ;
*!*	      pr_negociado With curListaProd.preco_compra
*!*	   Skip
*!*	   If Eof()
*!*	      Append Blank
*!*	   Endif
*!*	Endscan
*!*	Select cur_itens
*!*	Do While!Eof()
*!*	   Scatter Blank To vetReg
*!*	   Gather From vetReg
*!*	   Skip
*!*	Enddo
*!*	Go Top
*!*	lcXML = ''
*!*	Cursortoxml('cur_itens','lcXml',1,0,0,"1")
lcXML = ''
lcXML2 = ''

lcXML = Thisform.criarxmlcompra('pedido')

If Thisform.utilizapedidoduaslojas
	lcXML2 = Thisform.criarxmlcompra('pedido2')
	*!* Carlos  #56344  26/03/18: Adicionado código para realizar pedido pelo campo pedido3
	lcXML3 = Thisform.criarxmlcompra('pedido3')
Endif

Thisform.cRetorno = lcXML


*! Raul    #30307  11/06/15: O controle de geração dos pedidos
If Thisform.lGerarpedido

	If Thisform.PageFrame.Page1.selfornec.getvalue() &lt; 1
		Messagebox("Nenhum fornecedor selecionado.",64,"Informação")
		Return
	Endif

	*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
	If Thisform.PageFrame.Page1.cboLojasMultiSelecao.Visible
		lcValorMulti = Thisform.PageFrame.Page1.cboLojasMultiSelecao.Value
		lnIdLojaPedido = Iif(Thisform.utilizapedidoduaslojas, 1, Iif("," $ lcValorMulti or Empty(lcValorMulti),oempresa.Id,Val(lcValorMulti)))
	Else
		lnIdLojaPedido = Iif(Thisform.utilizapedidoduaslojas, 1, Iif(Thisform.PageFrame.Page1.cboLojas1.Value = 0,oempresa.Id,Thisform.PageFrame.Page1.cboLojas1.Value))
	Endif

	If ! Empty(lcXML)
		executarForm('frmcompras_pedido',.T.,Thisform.PageFrame.Page1.selfornec.getvalue(),lcXML,lnIdLojaPedido)
	Endif

	*!* Tiago   #27596  30/04/15: Chamando a tela Para o segundo pedido
	If Thisform.utilizapedidoduaslojas And ! Empty(lcXML2)
		executarForm('frmcompras_pedido',.T.,Thisform.PageFrame.Page1.selfornec.getvalue(),lcXML2, 2)
	Endif

	If Thisform.utilizapedidoduaslojas And ! Empty(lcXML3)
		executarForm('frmcompras_pedido',.T.,Thisform.PageFrame.Page1.selfornec.getvalue(),lcXML3, 3)
	Endif

Endif

Release Thisform

ENDPROC
PROCEDURE RightClick
PRIVATE ALL LIKE l*

*!* Gabriel #86557  12/05/21: Chama telinha de cotação com os dados do cursor em tela
LOCAL nOpcao AS Byte
nOpcao = 0
DEFINE POPUP MenuShortCut ShortCut RELATIVE FROM MROW(),MCOL()
DEFINE BAR 1 OF MenuShortCut PROMPT "\&lt;Gerar cotação"
ON SELECTION BAR 1 OF MenuShortCut nOpcao = 1

PUBLIC poGrid
poGrid = THIS
ACTIVATE POPUP MenuShortCut
RELEASE poGrid

DO CASE
CASE nOpcao = 1
	lcXml = ''
	SELECT * FROM curListaProd WHERE pedido &gt; 0 INTO CURSOR curCotacao READWRITE
	
	CURSORTOXML('curCotacao','lcXml')

	IF IsObj(THISFORM.PAGEFRAME.page1.selfornec.oregistro)
		lnIdFOrn = THISFORM.PAGEFRAME.page1.selfornec.oregistro.ID
	ELSE
		lnIdFOrn = .F.
	ENDIF

	executarform('frmcadcotacao', .T., .F., lnIdFOrn, lcXml)
ENDCASE




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24N10FEAA</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_4</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 9
Height = 25
Width = 116
Picture = ..\
Caption = "Compra &amp; \&lt;Venda"
TabIndex = 52
ToolTipText = "Visualizar movimento de compra/venda do produto"
ZOrderSet = 66
resizelock = WHL
Name = "Commandbutton_4"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If !Empty(curlistaprod.Id)
	lnIdProduto = curlistaprod.Id
	This.Parent.gridorder1.SetFocus
	*!* PARAMETROS DA TELA: Parameters tnIdProduto, tcTipo, tdData1, tdData2, tnIdLoja
	*!* Gabriel #95419  10/05/22: CboLojas1 vs CboLojasMultiSelecao
	If Thisform.PageFrame.page1.cboLojasMultiSelecao.Visible
		lcValorMulti = Thisform.PageFrame.page1.cboLojasMultiSelecao.Value
		lxIdLoja = Iif("," $ lcValorMulti Or Empty(lcValorMulti),oempresa.Id,Val(lcValorMulti))
	Else
		lxIdLoja = Thisform.PageFrame.page1.cbolojas1.Value
	Endif

	executarForm('mfrmmovcompravenda',.T.,curlistaprod.Id,.F.,.F.,.F.,lxIdLoja)
	*!*	   Select curlistaprod
	*!*	   Locate For curlistaprod.Id = lnIdProduto
	*!*	   This.Parent.gridorder1.SetFocus
Else
	Messagebox("Nenhum registro selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3UG0IQ6SS</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdsalvar</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdHistoricoPrecos</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 515
Left = 125
Height = 25
Width = 118
Picture = ..\imagens\imgcalendario.bmp
Caption = "Histórico de \&lt;preços"
TabIndex = 65
ToolTipText = "Histórico das alterações dos preços de custo e venda"
ZOrderSet = 67
resizelock = WHL
Name = "cmdHistoricoPrecos"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*!* Tiago   #14476  01/08/13: Adicionado função para visualizar o histórico de preço de compra.
ExecutarForm('frmCom_Historico_Preco', .T.,curListaProd.Id)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_5</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 9
Height = 25
Width = 116
Picture = ..\
Caption = "Mov. D\&lt;etalhada"
TabIndex = 58
ToolTipText = "Visualizar movimento de compra/venda do produto"
ZOrderSet = 68
resizelock = WHL
Name = "Commandbutton_5"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If !Empty(curlistaprod.Id)
lnIdProduto = curlistaprod.Id
this.Parent.gridorder1.SetFocus()
executarForm('mfrmmovestdet',.t.,curlistaprod.Id)
*!*	   Select curlistaprod
*!*	   Locate For curlistaprod.Id = lnIdProduto
*!*	   Thisform.gridorder1.SetFocus
Else
Messagebox("Nenhum registro selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 242
Height = 25
Width = 126
Picture = ..\
Caption = "Pro\&lt;dutos do fornecedor"
TabIndex = 54
ToolTipText = "Visualizar movimento de estoque detalhado do produto"
ZOrderSet = 69
resizelock = WHL
Name = "Commandbutton_2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If Thisform.PageFrame.Page1.selfornec.getvalue() &gt; 0
This.Parent.gridorder1.SetFocus()
executarform('mfrmMovCompraVenda2',.T.,Thisform.PageFrame.Page1.selfornec.getvalue() , "FORNECEDOR")
Endif

*!*   If !Empty(curlistaprod.Id)
*!*      executarform('mfrmmovestdet',.t.,curlistaprod.Id)
*!*   Else
*!*      Messagebox("Nenhum registro selecionado.",64,"Informação")
*!*   Endif



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 368
Height = 25
Width = 126
Picture = ..\
Caption = "Totalizar \&lt;custos"
TabIndex = 55
ToolTipText = "Visualizar movimento de estoque detalhado do produto"
ZOrderSet = 70
resizelock = WHL
Name = "Commandbutton_1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*pedido &gt; 0

Select produtos
Set Order To Id   &amp;&amp; ID


Dimension vetCustos(7,2)
vetCustos(1,1) = "IPI:"
vetCustos(2,1) = "FRETE:"
vetCustos(3,1) = "SUBST TRIB:"
vetCustos(4,1) = "ICMS DIF:"
vetCustos(5,1) = "ENCARGOS FINANC:"
vetCustos(6,1) = "CUSTO ENTR:"
vetCustos(7,1) = "EMBALAGEM:"
vetCustos(1,2) = 0.00
vetCustos(2,2) = 0.00
vetCustos(3,2) = 0.00
vetCustos(4,2) = 0.00
vetCustos(5,2) = 0.00
vetCustos(6,2) = 0.00
vetCustos(7,2) = 0.00
Select curListaProd
Set Relation To Id Into produtos
Scan For pedido &gt; 0
Select produtos
lnTabela_Forn = Tabela_forn
lnDesc_Forn1 = Desc_forn1
lnDesc_Forn2 = Desc_forn2
lnDesc_Forn3 = Desc_forn3
lnDesc_Forn4 = Desc_forn4
lnDesc_Forn5 = Desc_forn5
lnIpi = compra_ipi
lnCusto_Frete = Custo_Frete
lnICM_Subst = ICM_Subst
lnICM_dif = ICM_dif
lnPro_cf = Pro_cf
lnCusto_Financ = Custo_Financ
lnPreco_Custo = Preco_custo
lnLucro_Bruto = lucro_bruto
lcEmbalagem = embalagem
lnPreco_Compra = preco_compra * curListaProd.pedido

vetCustos(1,2) = vetCustos(1,2) + (lnPreco_Compra * (lnIpi/100))
lnPreco_Custo = lnPreco_Compra  + (lnPreco_Compra * (lnIpi/100))

vetCustos(2,2) = vetCustos(2,2) + (lnPreco_Custo * (lnCusto_Frete/100))
lnPreco_Custo = lnPreco_Custo + (lnPreco_Custo * (lnCusto_Frete/100))

vetCustos(3,2) = vetCustos(3,2) + (lnPreco_Custo * (lnICM_Subst/100))
lnPreco_Custo = lnPreco_Custo + (lnPreco_Custo * (lnICM_Subst/100))

vetCustos(4,2) = vetCustos(4,2) + (lnPreco_Custo * (lnICM_dif/100))
lnPreco_Custo = lnPreco_Custo + (lnPreco_Custo * (lnICM_dif/100))

vetCustos(5,2) = vetCustos(5,2) + (lnPreco_Custo * (lnPro_cf/100))
lnPreco_Custo = lnPreco_Custo + (lnPreco_Custo * (lnPro_cf/100))


If lnCusto_Financ &gt; 0
vetCustos(6,2) = vetCustos(6,2) + (lnPreco_Custo * .005)
lnPreco_Custo = lnPreco_Custo * 1.005
Endif

If !Empty(lcEmbalagem)
lcValor = Seekreg('tabauxiliar','alltrim(categoria)+Alltrim(nome)','EMBALAGEM'+lcEmbalagem,'valor')
If Vartype(lcValor) = 'C'
vetCustos(7,2) = vetCustos(7,2) + (Val(lcValor) * curListaProd.pedido )
lnPreco_Custo = lnPreco_Custo + (Val(lcValor) * curListaProd.pedido )
Else
Messagebox('Identificação de embalagem não encontrada no cadastro auxiliar.',64,'Informação')
Endif
Endif

EndScan
DO FORM forms\mfrmvisualizarvetor.scx with vetcustos,'Total dos custos'


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_6</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 242
Height = 25
Width = 126
Picture = ..\
Caption = "\&lt;Pedidos do fornecedor"
TabIndex = 60
ToolTipText = "Visualizar movimento de compra/venda do fornecedor"
ZOrderSet = 71
resizelock = WHL
Name = "Commandbutton_6"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If Thisform.PageFrame.Page1.selfornec.getvalue() &gt; 0
executarform('frmpesqpedidoscompra',.T.,'p.id_fornecedor = '+Alltrim(Str(Thisform.PageFrame.Page1.selfornec.getvalue() )))
Else
Messagebox("Nenhum fornecedor selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3VM0Q7ZK7</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_10</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 490
Left = 125
Height = 25
Width = 118
Picture = ..\
Caption = "Mov. do \&lt;Grupo"
TabIndex = 59
ToolTipText = "Visualizar movimento de compra/venda do grupo"
ZOrderSet = 72
resizelock = WHL
Name = "Commandbutton_10"
</properties>
		<protected/>
		<methods>PROCEDURE Click
lnIdGrupo = Thisform.pageFrame.page1.cntseekgrupos1.getvalue()
If lnIdGrupo &gt; 0
This.Parent.gridorder1.SetFocus
executarForm('mfrmmovcompravenda',.T.,lnIdGrupo ,'GRUPO')
Else
Messagebox("Nenhum grupo foi selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>commandbutton_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Commandbutton_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Top = 465
Left = 125
Height = 25
Width = 118
Picture = ..\
Caption = "Mov. do \&lt;Fornecedor"
TabIndex = 53
ToolTipText = "Visualizar movimento de compra/venda do fornecedor"
ZOrderSet = 73
resizelock = WHL
Name = "Commandbutton_3"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If Thisform.PageFrame.Page1.selfornec.getvalue() &gt; 0
lnIdProduto = curlistaprod.Id
This.Parent.gridorder1.SetFocus
executarForm('mfrmmovcompravenda',.T.,Thisform.PageFrame.Page1.selfornec.getvalue() ,'FORNECEDOR')
*!*	   If lnIdProduto &gt; 0
*!*	      Select curlistaprod
*!*	      Locate For curlistaprod.Id = lnIdProduto
*!*	      This.Parent.gridorder1.SetFocus
*!*	   Endif
Else
Messagebox("Nenhum fornecedor selecionado.",64,"Informação")
Endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_41H133GU8</uniqueid>
		<timestamp>1156731981</timestamp>
		<class>label_shape</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_shape1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Fornecedor"
Left = 9
Top = 310
TabIndex = 5
ZOrderSet = 74
resizelock = WHL
Name = "Label_shape1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IO0KFGC1</uniqueid>
		<timestamp>1323061709</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_21</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>Caption = "Litragem:"
Left = 551
Top = 406
TabIndex = 40
ZOrderSet = 45
resizelock = WHL
Name = "Label_21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IO0KFGC2</uniqueid>
		<timestamp>1323061568</timestamp>
		<class>txtlabel</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtLitragem</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE.pageframe.Page2</parent>
		<properties>FontBold = .T.
Alignment = 1
Height = 16
InputMask = "9999999.99"
Left = 586
TabIndex = 41
Top = 406
Width = 80
ZOrderSet = 50
resizelock = WHL
Name = "txtLitragem"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Checkbox_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 10
Left = 314
Alignment = 0
Caption = "Mínimo"
TabIndex = 3
Name = "Checkbox_1"
</properties>
		<protected/>
		<methods>PROCEDURE InteractiveChange
Private All Like l*

* Config 90002: Quantidade de estoques a gerenciar (lojas).
lnQtdEstoque = BuscarConfig('90002') &amp;&amp;Qtd lojas

*!* Cristof #80704  10/09/20: Habilitar as colunas de estoque minimo do grid de acordo com a config 90002 e o cursor "curLojasAtivas"
For lnI = 1 to 15
If lnQtdEstoque &gt;= lnI and Seek(lnI,"curLojasAtivas","id_coluna")
lcComando = "Thisform.PageFrame.page2.gridorder1.colMin"+Padl(lnI,2,"0")+".Visible = This.Value"
&amp;lcComando
EndIf
EndFor
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2PH00RDAE</uniqueid>
		<timestamp>1384207481</timestamp>
		<class>label_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Label_1</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Caption = "Expandir estoque:"
Left = 218
Top = 10
TabIndex = 2
Name = "Label_1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Chk_disponivel</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 10
Left = 417
Alignment = 0
Caption = "Disponível"
TabIndex = 5
Name = "Chk_disponivel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Private All Like l*

* Config 90002: Quantidade de estoques a gerenciar (lojas).
lnQtdEstoque = BuscarConfig('90002') &amp;&amp;Qtd lojas

*!* Cristof #80704  10/09/20: Habilitar as colunas de estoque disponivel do grid de acordo com a config 90002 e o cursor "curLojasAtivas"
For lnI = 1 to 15
If lnQtdEstoque &gt;= lnI and Seek(lnI,"curLojasAtivas","id_coluna")
lcComando = "Thisform.PageFrame.page2.gridorder1.coldisp"+Padl(lnI,2,"0")+".Visible = This.Value"
&amp;lcComando
EndIf
EndFor

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RG0Y51PZ</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Checkbox_2</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 10
Left = 492
Alignment = 0
Caption = "Físico"
TabIndex = 6
Name = "Checkbox_2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Private All Like l*

* Config 90002: Quantidade de estoques a gerenciar (lojas).
lnQtdEstoque = BuscarConfig('90002') &amp;&amp;Qtd lojas

*!* Cristof #80704  10/09/20: Habilitar as colunas de estoque fisico do grid de acordo com a config 90002 e o cursor "curLojasAtivas"
For lnI = 1 to 15
If lnQtdEstoque &gt;= lnI and Seek(lnI,"curLojasAtivas","id_coluna")
lcComando = "Thisform.PageFrame.page2.gridorder1.colFisi"+Padl(lnI,2,"0")+".Visible = This.Value"
&amp;lcComando
EndIf
EndFor

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4DF0XT63A</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Checkbox_3</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 10
Left = 369
Alignment = 0
Caption = "Ideal"
TabIndex = 4
Name = "Checkbox_3"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Private All Like l*

* Config 90002: Quantidade de estoques a gerenciar (lojas).
lnQtdEstoque = BuscarConfig('90002') &amp;&amp;Qtd lojas

*!* Cristof #80704  10/09/20: Habilitar as colunas de estoque ideal do grid de acordo com a config 90002 e o cursor "curLojasAtivas"
For lnI = 1 to 15
If lnQtdEstoque &gt;= lnI and Seek(lnI,"curLojasAtivas","id_coluna")
lcComando = "Thisform.PageFrame.page2.gridorder1.col_ideal"+Transform(lnI)+".Visible = This.Value"
&amp;lcComando
EndIf
EndFor

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4RM0ZN3GI</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>checkbox_</class>
		<classloc>..\classes\objetos.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkVendas_ultimos_4_meses</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 10
Left = 544
Alignment = 0
Caption = "Qtd Vendas últimos 4 meses"
TabIndex = 7
Visible = .F.
Name = "chkVendas_ultimos_4_meses"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*!* Carlos #32205 01/11/2016: VISUALIZAR VENDA POR MÊS NA ANÁLISE DE COMPRAS

Thisform.PageFrame.page2.gridorder1.intelicolumn48.Visible = this.Value
Thisform.PageFrame.page2.gridorder1.intelicolumn49.Visible = this.Value
Thisform.PageFrame.page2.gridorder1.intelicolumn50.Visible = this.Value
Thisform.PageFrame.page2.gridorder1.intelicolumn51.Visible = this.Value

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5NP12D2EF</uniqueid>
		<timestamp>1454982159</timestamp>
		<class>cmdbase</class>
		<classloc>..\classes\botoes.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdFoto</objname>
		<parent>FRMCOMPRAS_PEDIDO_ANALISE</parent>
		<properties>Top = 1
Left = 730
Height = 25
Width = 98
Picture = ..\imagens\imgabrir.bmp
Caption = "Exibir Imagem"
TabIndex = 8
Visible = .F.
Name = "cmdFoto"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*!* Matheus #73699  27/12/19: Abertura da foto principal do produto.

*Confirma se foi selecionado algum produto na grid.
Select curListaProd
If Eof()
	MessageBox([Nenhum produto selecionado.],64,'Informação')
	Return
EndIf

*Caminho da pasta de fotos do produto selecionado.
lcAuxCaminho = osistema.HOME + 'Fotos\produtos\' + curListaProd.codigo

*Verifica se existe a pasta do produto.
IF !DIRECTORY(lcAuxCaminho)
MESSAGEBOX([Não há pasta de fotos para este produto.],64,'Informação')
RETURN
ENDIF

*Verifica se possui fotos dentro da pasta.
lnCont = ADIR(vet,lcAuxCaminho+'\*.jpg')
IF lnCont = 0
MESSAGEBOX([Produto não possui fotos.],64,'Informação')
RETURN
ENDIF

*Abertura do form que apresentará a foto.
Executarform('frmZoom', .T., lcAuxCaminho+'\'+vet(1,1))

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Tahoma, 0, 8, 5, 13, 11, 27, 2, 0
Tahoma, 0, 7, 4, 11, 9, 22, 2, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
